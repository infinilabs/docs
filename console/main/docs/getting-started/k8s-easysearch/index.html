<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.79.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Deploying Console and Easysearch in a Kubernetes Cluster #  This guide describes how to deploy INFINI Console and INFINI Easysearch as containers and enable Agent metric collection mode within the containers.
Prerequisites #   Ensure that a Kubernetes cluster is installed and running correctly. Ensure that kubectl is configured and can access the Kubernetes cluster. Ensure that Helm is installed and configured.  Helm Configuration Adjustments #  When deploying Console and Easysearch using Helm, the default configuration needs to be adjusted to enable Agent metric collection mode."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Deploying Console and Easysearch in a Kubernetes Cluster"><meta property="og:description" content="Deploying Console and Easysearch in a Kubernetes Cluster #  This guide describes how to deploy INFINI Console and INFINI Easysearch as containers and enable Agent metric collection mode within the containers.
Prerequisites #   Ensure that a Kubernetes cluster is installed and running correctly. Ensure that kubectl is configured and can access the Kubernetes cluster. Ensure that Helm is installed and configured.  Helm Configuration Adjustments #  When deploying Console and Easysearch using Helm, the default configuration needs to be adjusted to enable Agent metric collection mode."><meta property="og:type" content="article"><meta property="og:url" content="/console/main/docs/getting-started/k8s-easysearch/"><title>Deploying Console and Easysearch in a Kubernetes Cluster | INFINI Console</title><link rel=manifest href=/console/main/manifest.json><link rel=icon href=/console/main/favicon.png type=image/x-icon><link rel=alternate hreflang=zh href=/console/main/zh/docs/getting-started/k8s-easysearch/ title="在 Kubernetes 集群中部署 Console 和 Easysearch"><link rel=stylesheet href=/console/main/book.min.d80e87b12a4b49d9913d0bdd98bd83b7a44988be784760ba15522b377313dcf9.css integrity="sha256-2A6HsSpLSdmRPQvdmL2Dt6RJiL54R2C6FVIrN3MT3Pk="><link rel=stylesheet type=text/css href=/console/main/css/asciinema-player.css><script defer src=/console/main/js/jquery-2.x.min.js></script><script defer src=/console/main/js/doc.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/console/main><img src=/console/main/img/logo-en.svg alt=Logo></a></h2><div id=searchbox style=margin-bottom:10px;outline:none></div><div class=heading><select class=version-selector>
<option value>main (latest)</option>
<option value=v1.29.6>v1.29.6</option>
<option value=v1.29.4>v1.29.4</option>
<option value=v1.29.3>v1.29.3</option>
<option value=v1.29.2>v1.29.2</option>
<option value=v1.29.1>v1.29.1</option>
<option value=v1.29.0>v1.29.0</option>
<option value=v1.28.2>v1.28.2</option>
<option value=v1.28.0>v1.28.0</option>
<option value=v1.27.0>v1.27.0</option>
<option value=v1.26.1>v1.26.1</option></select></div><ul><li><input type=checkbox id=section-f1b7c1b2e5dd43526e77637c475d35b8 class=toggle checked>
<label for=section-f1b7c1b2e5dd43526e77637c475d35b8 class="flex justify-between"><a>Getting Started</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/getting-started/install/>Installation</a></li><li><a href=/console/main/docs/getting-started/docker/>Docker</a></li><li><a href=/console/main/docs/getting-started/dcoker-easysearch/>Deploying Console and Easysearch with Docker Compose</a></li><li><a href=/console/main/docs/getting-started/k8s-easysearch/ class=active>Deploying Console and Easysearch in a Kubernetes Cluster</a></li><li><a href=/console/main/docs/getting-started/helm/>Kubernetes</a></li></ul></li><li><input type=checkbox id=section-084ba1dbb512652712ad881ff8045610 class=toggle>
<label for=section-084ba1dbb512652712ad881ff8045610 class="flex justify-between"><a>References</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/setup/>Setup wizard</a><ul></ul></li><li><a href=/console/main/docs/reference/overview/>Overview</a><ul></ul></li><li><input type=checkbox id=section-dc19493497a0afff7833e4e9dc3568aa class=toggle>
<label for=section-dc19493497a0afff7833e4e9dc3568aa class="flex justify-between"><a>Platform</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/platform/overview/>Platform Overview</a></li><li><a href=/console/main/docs/reference/platform/monitoring/>Cluster Monitoring</a></li><li><a href=/console/main/docs/reference/platform/activities/>Cluster Activities</a></li></ul></li><li><input type=checkbox id=section-77e7dc04d6c2293e5fe55f48c5b1a96d class=toggle>
<label for=section-77e7dc04d6c2293e5fe55f48c5b1a96d class="flex justify-between"><a href=/console/main/docs/reference/data/>Data Management</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/data/indices/>Index</a></li><li><a href=/console/main/docs/reference/data/alias/>Alias</a></li><li><a href=/console/main/docs/reference/data/view/>Data View</a></li></ul></li><li><input type=checkbox id=section-1f2a999bd81c4d3893f4d18a1b6bee8a class=toggle>
<label for=section-1f2a999bd81c4d3893f4d18a1b6bee8a class="flex justify-between"><a>Data Insight</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/data-insight/discover/>Discover</a></li></ul></li><li><input type=checkbox id=section-5e5111152017c79ed39a34209990dab7 class=toggle>
<label for=section-5e5111152017c79ed39a34209990dab7 class="flex justify-between"><a>Alerting</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/alerting/message/>Messages</a></li><li><a href=/console/main/docs/reference/alerting/rule/>Rules</a></li><li><a href=/console/main/docs/reference/alerting/channel/>Channels</a></li><li><a href=/console/main/docs/reference/alerting/variables/>Template variables</a></li></ul></li><li><input type=checkbox id=section-9d29fb1eabf25b6edd736a2b92f0b4fe class=toggle>
<label for=section-9d29fb1eabf25b6edd736a2b92f0b4fe class="flex justify-between"><a>Dev Tools</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/dev-tools/dev-tools/>Dev Tools</a></li><li><a href=/console/main/docs/reference/dev-tools/command/>Common Commands</a></li></ul></li><li><input type=checkbox id=section-9a37092c3581f4c91275ae58f0fb21f2 class=toggle>
<label for=section-9a37092c3581f4c91275ae58f0fb21f2 class="flex justify-between"><a>Inventory</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/resource/runtime/>Runtime</a></li><li><a href=/console/main/docs/reference/resource/cluster/>Cluster</a></li><li><a href=/console/main/docs/reference/resource/cluster-agent/>Agent Metric Collect Mode Configuration</a></li></ul></li><li><input type=checkbox id=section-4d372e275e589511fb7282b1f9f3f20f class=toggle>
<label for=section-4d372e275e589511fb7282b1f9f3f20f class="flex justify-between"><a>System</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/system/credential/>Credential</a><ul></ul></li><li><input type=checkbox id=section-89e2a3b5192ba2e5bd11dc7aab78be3d class=toggle>
<label for=section-89e2a3b5192ba2e5bd11dc7aab78be3d class="flex justify-between"><a href=/console/main/docs/reference/system/security/>Security</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/system/security/role/>Role</a></li><li><a href=/console/main/docs/reference/system/security/user/>User</a></li></ul></li><li><a href=/console/main/docs/reference/system/audit/>Audit Logs</a></li></ul></li><li><input type=checkbox id=section-5860fb455fea11f0ed079673fd767cda class=toggle>
<label for=section-5860fb455fea11f0ed079673fd767cda class="flex justify-between"><a>Agent</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/reference/agent/manage/manage/>Overview</a></li><li><a href=/console/main/docs/reference/agent/install/>Installing Agent</a></li><li><a href=/console/main/docs/reference/agent/docker/>Container Deployment</a></li></ul></li></ul></li><li><input type=checkbox id=section-7dd85575c84e6825eb9419e748eb5977 class=toggle>
<label for=section-7dd85575c84e6825eb9419e748eb5977 class="flex justify-between"><a>Tutorials</a>
<span>▾</span></label><ul><li><a href=/console/main/docs/tutorials/create_readonly_account/>How to easily create an Elasticsearch "guest" user</a></li><li><a href=/console/main/docs/tutorials/role_with_different_rights/>How to assign different Elasticsearch cluster access permissions to different INFINI Console accounts</a></li><li><a href=/console/main/docs/tutorials/role_with_index_limit/>How to assign Elasticsearch index-level permissions to INFINI Console accounts</a></li><li><a href=/console/main/docs/tutorials/cluster_health_change/>How to Monitor Elasticsearch Cluster Health</a></li><li><a href=/console/main/docs/tutorials/cluster_node_disk_usage/>How to monitor Elasticsearch cluster node disk usage</a></li><li><a href=/console/main/docs/tutorials/cluster_slow_request/>How to monitor slow query requests in Elasticsearch</a></li><li><a href=/console/main/docs/tutorials/cluster_node_cpu_usage/>How to monitor the CPU usage of Elasticsearch cluster nodes</a></li><li><a href=/console/main/docs/tutorials/cluster_node_jvm_usage/>How to monitor JVM usage of Elasticsearch cluster nodes</a></li><li><a href=/console/main/docs/tutorials/getting_started_with_the_TopN_metrics_feature/>Getting Started with the TopN Metrics Feature in INFINI Console</a></li></ul></li><li><a href=/console/main/docs/user-cases/>User Cases</a><ul></ul></li><li><a href=/console/main/docs/screenshot/>Screenshots</a><ul></ul></li><li><a href=/console/main/docs/troubleshooting/>FAQs</a><ul></ul></li><li><a href=/console/main/docs/release-notes/>Release Notes</a><ul></ul></li></ul><ul><li><a href=https://github.com/infinilabs/console target=_blank rel=noopener>Github</a></li></ul><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/console/main/svg/translate.svg class=book-icon alt=Languages>
English</li></ul><ul class=book-languages-list><li class=active><a href=/console/main/ class="flex align-center"><img src=/console/main/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li><a href=/console/main/zh/docs/getting-started/k8s-easysearch/ class="flex align-center"><img src=/console/main/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/console/main/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Deploying Console and Easysearch in a Kubernetes Cluster</strong>
<label for=toc-control><img src=/console/main/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#deploying-console-and-easysearch-in-a-kubernetes-cluster>Deploying Console and Easysearch in a Kubernetes Cluster</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#helm-configuration-adjustments>Helm Configuration Adjustments</a></li><li><a href=#installing-the-cert-manager-dependency>Installing the cert-manager Dependency</a></li><li><a href=#configuring-the-easysearch-root-certificate>Configuring the Easysearch Root Certificate</a></li><li><a href=#deploying-console-and-easysearch>Deploying Console and Easysearch</a></li><li><a href=#verifying-the-deployment>Verifying the Deployment</a></li><li><a href=#deleting-console-and-easysearch>Deleting Console and Easysearch</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=deploying-console-and-easysearch-in-a-kubernetes-cluster>Deploying Console and Easysearch in a Kubernetes Cluster
<a class=anchor href=#deploying-console-and-easysearch-in-a-kubernetes-cluster>#</a></h1><p>This guide describes how to deploy INFINI Console and INFINI Easysearch as containers and enable Agent metric collection mode within the containers.</p><h2 id=prerequisites>Prerequisites
<a class=anchor href=#prerequisites>#</a></h2><ul><li>Ensure that a Kubernetes cluster is installed and running correctly.</li><li>Ensure that <code>kubectl</code> is configured and can access the Kubernetes cluster.</li><li>Ensure that Helm is installed and configured.</li></ul><h2 id=helm-configuration-adjustments>Helm Configuration Adjustments
<a class=anchor href=#helm-configuration-adjustments>#</a></h2><p>When deploying Console and Easysearch using Helm, the default configuration needs to be adjusted to enable Agent metric collection mode.</p><p>In your <code>values.yaml</code> file, add the following configuration:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>metricsWithAgent</span>: <span style=color:#66d9ef>true</span>
<span style=color:#f92672>metricsConfigServer</span>: <span style=color:#e6db74>&#34;http://console:9000&#34;</span>
</code></pre></div><h2 id=installing-the-cert-manager-dependency>Installing the cert-manager Dependency
<a class=anchor href=#installing-the-cert-manager-dependency>#</a></h2><p>Use the following commands to install the cert-manager dependency:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm repo add jetstack https://charts.jetstack.io --force-update
helm install cert-manager jetstack/cert-manager <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--namespace cert-manager <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--create-namespace <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--version v1.17.2 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--set crds.enabled<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--set prometheus.enabled<span style=color:#f92672>=</span>false <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--set webhook.timeoutSeconds<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</code></pre></div><h2 id=configuring-the-easysearch-root-certificate>Configuring the Easysearch Root Certificate
<a class=anchor href=#configuring-the-easysearch-root-certificate>#</a></h2><p>Use the following commands to configure the Easysearch root certificate and access password.</p><blockquote><p>Note: Please ensure you change the initial password to maintain security.</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#e6db74>&lt;&lt; EOF | kubectl -n infinilabs apply -f -
</span><span style=color:#e6db74>apiVersion: cert-manager.io/v1
</span><span style=color:#e6db74>kind: Issuer
</span><span style=color:#e6db74>metadata:
</span><span style=color:#e6db74>name: easysearch-ca-issuer
</span><span style=color:#e6db74>spec:
</span><span style=color:#e6db74>selfSigned: {}
</span><span style=color:#e6db74>---
</span><span style=color:#e6db74>apiVersion: cert-manager.io/v1
</span><span style=color:#e6db74>kind: Certificate
</span><span style=color:#e6db74>metadata:
</span><span style=color:#e6db74>name: easysearch-ca-certificate
</span><span style=color:#e6db74>spec:
</span><span style=color:#e6db74>commonName: easysearch-ca-certificate
</span><span style=color:#e6db74>duration: 87600h0m0s
</span><span style=color:#e6db74>isCA: true
</span><span style=color:#e6db74>issuerRef:
</span><span style=color:#e6db74>kind: Issuer
</span><span style=color:#e6db74>name: easysearch-ca-issuer
</span><span style=color:#e6db74>privateKey:
</span><span style=color:#e6db74>algorithm: ECDSA
</span><span style=color:#e6db74>size: 256
</span><span style=color:#e6db74>renewBefore: 2160h0m0s
</span><span style=color:#e6db74>secretName: easysearch-ca-secret
</span><span style=color:#e6db74>EOF</span>

<span style=color:#75715e># Create Easysearch access password, please change the initial password yourself</span>
kubectl create secret generic easysearch-secrets <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--namespace infinilabs <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--from-literal<span style=color:#f92672>=</span>ezs_password<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ezs_infini_console&#39;</span>
</code></pre></div><h2 id=deploying-console-and-easysearch>Deploying Console and Easysearch
<a class=anchor href=#deploying-console-and-easysearch>#</a></h2><p>Use the following commands to deploy Console and Easysearch. Image downloads may take some time, please be patient.</p><blockquote><p>During installation, you can use <code>--set</code> to adjust parameters, for example, to change the Easysearch image version: <code>--set image.repository=infinilabs/easysearch --set image.tag=1.13.0</code></p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm repo add infinilabs https://helm.infinilabs.com --force-update
helm install console infinilabs/console -n infinilabs --create-namespace
helm install easysearch infinilabs/easysearch -n infinilabs --create-namespace <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--set metricsWithAgent<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--set metricsConfigServer<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://console:9000&#34;</span>
</code></pre></div><h2 id=verifying-the-deployment>Verifying the Deployment
<a class=anchor href=#verifying-the-deployment>#</a></h2><p>After the deployment is complete, access the
<a href=http://localhost:30900/>Console</a> to initialize it and adjust the cluster configuration to enable Agent metric collection mode. Also, associate the Agent with the cluster nodes.
Once these operations are done, you can view the Agent collection status, data latency for various metrics, log information, and shard monitoring on the Monitoring page.</p><p><img src=/console/main/img/screenshot/v1.29/monitor/agent-index.png alt></p><p><img src=/console/main/img/screenshot/v1.29/monitor/agent-shard.png alt></p><h2 id=deleting-console-and-easysearch>Deleting Console and Easysearch
<a class=anchor href=#deleting-console-and-easysearch>#</a></h2><p>Use the following commands to delete Console and Easysearch:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm uninstall console -n infinilabs
helm uninstall easysearch -n infinilabs
kubectl delete pvc console-data-console-0 console-config-console-0 -n infinilabs
kubectl delete pvc easysearch-data-easysearch-0 easysearch-config-easysearch-0 -n infinilabs
kubectl delete namespace infinilabs
</code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/console/main/svg/translate.svg class=book-icon alt=Languages>
English</li></ul><ul class=book-languages-list><li class=active><a href=/console/main/ class="flex align-center"><img src=/console/main/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li><a href=/console/main/zh/docs/getting-started/k8s-easysearch/ class="flex align-center"><img src=/console/main/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div><div><a class="flex align-center" href=https://github.com/infinilabs/console/edit/main/docs/content.en/docs/getting-started/k8s-easysearch.md target=_blank rel=noopener><img src=/console/main/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div><div class="flex align-center footer">©INFINI.LTD, All Rights Reserved.</div><script async src="https://www.googletagmanager.com/gtag/js?id=G-RJPTVP614C"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-RJPTVP614C');</script><script type=text/javascript>var _smartsupp=_smartsupp||{};_smartsupp.key='691ff544d18a237005a011a7290b839d8fe811a4';window.smartsupp||(function(d){var s,c,o=smartsupp=function(){o._.push(arguments)};o._=[];s=d.getElementsByTagName('script')[0];c=d.createElement('script');c.type='text/javascript';c.charset='utf-8';c.async=true;c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);})(document);</script></div><script type=module>
    import { searchbox } from "https://coco.infini.cloud/integration/cvn0g9ehpcehvsthrakg/widget";
    searchbox({container: "#searchbox"});
</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#deploying-console-and-easysearch-in-a-kubernetes-cluster>Deploying Console and Easysearch in a Kubernetes Cluster</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#helm-configuration-adjustments>Helm Configuration Adjustments</a></li><li><a href=#installing-the-cert-manager-dependency>Installing the cert-manager Dependency</a></li><li><a href=#configuring-the-easysearch-root-certificate>Configuring the Easysearch Root Certificate</a></li><li><a href=#deploying-console-and-easysearch>Deploying Console and Easysearch</a></li><li><a href=#verifying-the-deployment>Verifying the Deployment</a></li><li><a href=#deleting-console-and-easysearch>Deleting Console and Easysearch</a></li></ul></li></ul></nav></aside></main><script src=/console/main/js/asciinema-player.js></script></body></html>