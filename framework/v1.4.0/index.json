[{"category":null,"content":"Aggregation via URL Parameters #  The INFINI Framework allows for the dynamic construction of complex aggregations directly through URL query parameters. This provides a powerful and flexible way to perform data analysis without needing to construct a full JSON request body.\nBasic Structure #  The basic syntax for defining an aggregation is as follows:\nagg[\u0026lt;aggregation_name\u0026gt;][\u0026lt;aggregation_type\u0026gt;][\u0026lt;parameter\u0026gt;]=\u0026lt;value\u0026gt;  \u0026lt;aggregation_name\u0026gt;: A user-defined name for the aggregation (e.g., products_by_brand). This name will be the key for the aggregation results. \u0026lt;aggregation_type\u0026gt;: The type of aggregation to perform (e.g., terms, avg, sum, date_histogram). \u0026lt;parameter\u0026gt;: A parameter for the given aggregation type (e.g., field, size, interval). \u0026lt;value\u0026gt;: The value for the parameter.  All parts of the name and value should be URL-encoded, especially if they contain special characters.\n Aggregation Types #  1. Terms Aggregation #  Groups documents by the unique values in a field.\n type: terms Parameters:  field: The field to group by. size: (Optional) The number of buckets to return.    Example: Get the top 5 product brands.\nGET /my_index/_search?agg[by_brand][terms][field]=brand.keyword\u0026amp;agg[by_brand][terms][size]=5 2. Metric Aggregations #  Perform calculations on the values of a specific field.\n avg: Calculates the average. sum: Calculates the sum. min: Finds the minimum value. max: Finds the maximum value. cardinality: Calculates the number of unique values (approximate count).  Example: Calculate the average price of all products.\nGET /my_index/_search?agg[avg_price][avg][field]=price Example: Count the number of unique users.\nGET /my_index/_search?agg[unique_users][cardinality][field]=user.id 3. Percentiles Aggregation #  Calculates one or more percentiles over a numeric field.\n type: percentiles Parameters:  field: The numeric field. percents: (Optional) A comma-separated list of percentile values. Defaults to a standard set if not provided.    Example: Calculate the 50th, 95th, and 99th percentiles for API latency.\nGET /my_index/_search?agg[latency_percentiles][percentiles][field]=latency_ms\u0026amp;agg[latency_percentiles][percentiles][percents]=50,95,99 4. Date Histogram Aggregation #  Groups documents into buckets based on a date/time field.\n type: date_histogram Parameters:  field: The date field. interval: The time interval for the buckets (e.g., 1h, 1d, 1M). format: (Optional) A custom format for the date keys in the response. time_zone: (Optional) A time zone to apply.    Example: Group sales data by month.\nGET /my_index/_search?agg[sales_by_month][date_histogram][field]=order_date\u0026amp;agg[sales_by_month][date_histogram][interval]=1M 5. Derivative Aggregation #  A pipeline aggregation that calculates the derivative of a metric in a parent histogram aggregation.\n type: derivative Parameters:  buckets_path: The path to the metric to be differentiated.    Example: Calculate the rate of change of document counts per month.\nGET /my_index/_search?agg[sales_per_month][date_histogram][field]=timestamp\u0026amp;agg[sales_per_month][date_histogram][interval]=month\u0026amp;agg[sales_per_month][aggs][sales_deriv][derivative][buckets_path]=_count  Nested Aggregations #  You can nest aggregations to perform more complex, multi-level analysis. The syntax for nesting is to add an aggs key.\nagg[\u0026lt;parent_name\u0026gt;][aggs][\u0026lt;child_name\u0026gt;][\u0026lt;child_type\u0026gt;][\u0026lt;parameter\u0026gt;]=\u0026lt;value\u0026gt; Example: Group products by brand, and then for each brand, calculate the average price.\nGET /my_index/_search?agg[by_brand][terms][field]=brand.keyword\u0026amp;agg[by_brand][aggs][avg_price][avg][field]=price This creates a terms aggregation named by_brand and, within each brand bucket, an avg aggregation named avg_price.\nHandling Special Characters #  If your aggregation name contains special characters (including non-ASCII characters), ensure it is properly URL-encoded.\nExample: An aggregation named \u0026ldquo;ä¾›åº”å•†\u0026rdquo; (Supplier).\nThe name \u0026ldquo;ä¾›åº”å•†\u0026rdquo; is URL-encoded to %E4%BE%9B%E5%BA%94%E5%95%86.\nGET /my_index/_search?agg[%E4%BE%9B%E5%BA%94%E5%95%86][terms][field]=supplier.keyword The framework will automatically decode the name, and the key in the response will be \u0026ldquo;ä¾›åº”å•†\u0026rdquo;.\nDirect Build Example #  q := orm.NewQuery() q.Must(orm.TermQuery(\u0026#34;product_id\u0026#34;, \u0026#34;12345\u0026#34;)) aggs := map[string]orm.Aggregation{ \u0026#34;sales_over_time\u0026#34;: (\u0026amp;orm.DateHistogramAggregation{ Field: \u0026#34;sale_date\u0026#34;, Interval: \u0026#34;1M\u0026#34;, }).AddNested(\u0026#34;sales_by_region\u0026#34;, (\u0026amp;orm.TermsAggregation{ Field: \u0026#34;region.keyword\u0026#34;, }).AddNested(\u0026#34;avg_sale\u0026#34;, \u0026amp;orm.MetricAggregation{ Field: \u0026#34;sale_amount\u0026#34;, Type: \u0026#34;avg\u0026#34;, })), } q.Aggs = aggs // build final dsl  dsl := BuildQueryDSL(q) ","subcategory":null,"summary":"","tags":null,"title":"Aggregation via URL Parameters","url":"/framework/v1.4.0/docs/references/aggs_query/"},{"category":null,"content":"Query URL Parameters #  The query URL parameters can be used in many places (e.g., HTTP API endpoints, internal service calls, debug consoles). We use them to unify how queries are received and processed across different components of the system. This provides a powerful, composable, and human-readable way to construct both full-text search and structured filters, while also supporting advanced features like fuzziness, field selection, and pagination.\nðŸ”§ Query URL Parameters #  These URL parameters are used to construct a rich and dynamic search query.\n   Name Type Description Example     query string The main query string. Supports field boosting (field^boost:value). query=title^2:search engine   filter string[] One or more filter clauses. Can be negated with - or !. Supports: filter=status:active, filter=-exists(deleted_at)     - field=value, field!=value, field\u0026gt;=x, field\u0026lt;y filter=age\u0026gt;=18, filter=tag!=archived     - exists(field) filter=exists(status)   sort string Sort rules separated by comma. Each rule is field[:asc|desc]. sort=published_at:desc,_score   from int Pagination offset. from=20   size int Number of results to return. size=10   fuzziness int Fuzziness level for the query (0â€“5). fuzziness=3   default_operator string Operator between terms if not specified (AND or OR). default_operator=AND   default_fields string Comma-separated list of fields used as fallback for both query and filter. default_fields=title,description   default_query_fields string Comma-separated list of fields used only for full-text search. default_query_fields=title,body   default_filter_fields string Comma-separated list of fields used only for filters. default_filter_fields=status,tag   _source_includes string Comma-separated fields to include in _source. _source_includes=title,author   _source_excludes string Comma-separated fields to exclude from _source. _source_excludes=internal_notes,raw_data     ðŸ§  Filter Syntax Summary #     Syntax Meaning Example     field=value Term query status=active   field!=value Negated term status!=deleted   field\u0026gt;=value Range query (greater than or equal) views\u0026gt;=1000   field\u0026lt;value Range query (less than) age\u0026lt;30   any(value1,value2) Terms filter (any term can be match) any(tag1,tag2,tag3)   exists(field) Field existence check exists(tags)   -filterExpr / !filterExpr Negate any filter expression !exists(deleted_at)    ðŸš€ Example #  Simple Search #  GET /search?query=go+language\u0026amp;default_fields=title,description Filtered and Sorted #  GET /search?query=distributed+search\u0026amp;filter=status=active\u0026amp;sort=_score:desc,created_at:desc Advanced with Fuzziness and Range #  GET /search?query=search\u0026amp;fuzziness=3\u0026amp;filter=age\u0026gt;=18\u0026amp;filter=!exists(deleted_at)\u0026amp;size=20  ðŸ§© Notes #   Filters are ANDed together by default. Negated filters use either - or ! prefix. If query is not provided, only filters will be applied. Supports combining query string logic and JSON body input (BuildQueryDSLOnTopOfDSL handles merging). Values in filters are auto-casted to int, bool, or string.  Example usage:\nq := orm.NewQuery().Must( orm.ShouldQuery( orm.MatchQuery(\u0026#34;lang\u0026#34;, \u0026#34;en\u0026#34;), orm.MatchQuery(\u0026#34;lang\u0026#34;, \u0026#34;zh\u0026#34;), ), orm.MustNotQuery( orm.TermQuery(\u0026#34;deleted\u0026#34;, true), ), ).Size(10).SortBy( orm.Sort{Field: \u0026#34;score\u0026#34;, SortType: orm.DESC}, ) ","subcategory":null,"summary":"","tags":null,"title":"Query URL Parameters","url":"/framework/v1.4.0/docs/references/query_url/"},{"category":null,"content":"HTTP Client Configuration #  The http_client section defines configurations for HTTP clients, where each key represents a unique client profile. The default key is a special profile that serves as the fallback configuration when no specific profile is specified. Additional profiles can be added and accessed dynamically.\nSample Configuration #  http_client: default: proxy: enabled: true default_config: http_proxy: http://127.0.0.1:7890 socket5_proxy: socks5://127.0.0.1:7890 override_system_proxy_env: true # Override system proxy environment settings permitted: - \u0026#34;google.com\u0026#34; denied: - \u0026#34;localhost\u0026#34; - \u0026#34;infinilabs.com\u0026#34; - \u0026#34;api.coco.rs\u0026#34; domains: \u0026#34;github.com\u0026#34;: http_proxy: http://127.0.0.1:7890 socket5_proxy: socks5://127.0.0.1:7890 custom_profile: proxy: enabled: false gitlab_p12: tls: enabled: true cert_file: /fullpath/test-client.p12 cert_password: \u0026#34;12345\u0026#34; Parameters #  HTTP Client Configuration: http_client #     Name Type Description     key map[string]HTTPClientConfig Each key represents a named HTTP client configuration. For example, default or custom.   default HTTPClientConfig The default configuration used as a fallback when no specific configuration is specified.     HTTP Client Config: HTTPClientConfig #     Name Type Description     proxy ProxyConfig Configuration for proxy usage, including domain rules and proxy settings.   timeout string The overall timeout for HTTP requests.   dial_timeout string The timeout for establishing connections.   read_timeout string The timeout for reading data from the connection.   write_timeout string The timeout for writing data to the connection.   read_buffer_size int The size of the read buffer.   write_buffer_size int The size of the write buffer.   tls TLSConfig Configuration for TLS settings.   max_connection_per_host int The maximum number of connections per host.     Proxy Configuration: ProxyConfig #     Name Type Description     enabled boolean Enables or disables the use of a proxy.   default_config ProxyDetails Default proxy settings, including HTTP and SOCKS5 proxies.   override_system_proxy_env boolean Whether to override system-wide proxy environment variables.   permitted list List of domains allowed to use the proxy.   denied list List of domains denied from using the proxy.   domains map Proxy settings per domain.     Proxy Details: ProxyDetails #     Name Type Description     http_proxy string URL of the HTTP proxy.   socket5_proxy string URL of the SOCKS5 proxy.   using_proxy_env boolean Whether to use system environment proxy settings (e.g., HTTP_PROXY).     TLS Configuration: TLSConfig #     Name Type Description     enabled boolean Enables or disables TLS/SSL for the connection.   cert_file string Path to the TLS certificate file. Support PKCS#12 and PEM file.   cert_password string Password for the TLS certificate file (if encrypted).   key_file string Path to the TLS private key file.   ca_file string Path to the Certificate Authority (CA) certificate file.   skip_insecure_verify boolean Skip TLS certificate verification (insecure - use with caution).   default_domain string Default domain for TLS certificate generation.   skip_domain_verify boolean Skip domain verification for AutoIssue certificates.   client_session_cache_size int Size of the client TLS session cache.    ","subcategory":null,"summary":"","tags":null,"title":"Http Client Configuration","url":"/framework/v1.4.0/docs/references/http_client/"},{"category":null,"content":"Object-Relational Mapping #  The INFINI Framework provides a powerful ORM system built on top of Elasticsearch(Including OpenSearch,Easysearch support), enabling developers to define, store, and query structured data objects with ease. The ORM handles object mapping, indexing, and provides a comprehensive set of CRUD operations.\nObject Definition #  Objects in the ORM are defined by embedding orm.ORMObjectBase in your struct, which automatically provides all required ORM functionality including system fields for metadata management. Objects must also implement the Object interface with GetID() and SetID(string) methods.\nKey Principle: ORMObjectBase Inheritance #  To make any struct ORM-capable, you must embed orm.ORMObjectBase as the first field. This provides:\n System fields for metadata management Required interface implementations Automatic timestamp handling Built-in ID management  Basic Object Structure #  // Basic ORM object with ORMObjectBase inheritance type User struct { // EMBED ORMObjectBase as the first field - REQUIRED  orm.ORMObjectBase // Embedding ORM base for persistence-related fields  // Custom fields  Name string `json:\u0026#34;name\u0026#34;` Email string `json:\u0026#34;email\u0026#34;` Age int `json:\u0026#34;age\u0026#34;` } // Implement required Object interface methods (ORMObjectBase already handles GetID/SetID) Nested Inheritance: Building on Base Objects #\n The ORM supports nested inheritance, allowing you to create reusable base objects and extend them:\n// Define a base object with shared functionality type CombinedFullText struct { orm.ORMObjectBase // Embedding ORM base for persistence-related fields  CombinedFullText string `json:\u0026#34;-\u0026#34; elastic_mapping:\u0026#34;combined_fulltext:{type:text,index_prefixes:{},index_phrases:true,analyzer:combined_text_analyzer }\u0026#34;` \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Metadata\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;[\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;]\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;interface\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;metadata,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;metadata:{type:object}\u0026amp;#34;`\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Additional accessible metadata   Payload map[string]interface{} json:\u0026amp;#34;payload,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;payload:{enabled:false}\u0026amp;#34; // Store-only metadata }\n// Extend the base object with specific fields type DataSource struct { CombinedFullText // Inherit all fields from base object  Type string json:\u0026amp;#34;type,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;type:{type:keyword,copy_to:combined_fulltext}\u0026amp;#34; Name string json:\u0026amp;#34;name\u0026amp;#34; elastic_mapping:\u0026amp;#34;name:{type:keyword,copy_to:combined_fulltext,fields:{text: {type: text}, pinyin: {type: text, analyzer: pinyin_analyzer}}}\u0026amp;#34; Description string json:\u0026amp;#34;description,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;description:{type:text,copy_to:combined_fulltext}\u0026amp;#34; Icon string json:\u0026amp;#34;icon,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;icon:{enabled:false}\u0026amp;#34; Category string json:\u0026amp;#34;category,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;category:{type:keyword}\u0026amp;#34; Tags []string json:\u0026amp;#34;tags,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;tags:{type:keyword}\u0026amp;#34; Connector ConnectorConfig json:\u0026amp;#34;connector,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;connector:{type:object}\u0026amp;#34; Enabled bool json:\u0026amp;#34;enabled\u0026amp;#34; elastic_mapping:\u0026amp;#34;enabled:{type:keyword}\u0026amp;#34; } Advanced Object Definition with Elasticsearch Mapping #\n type Document struct { orm.ORMObjectBase // Embedding ORM base for persistence-related fields  Title string `json:\u0026#34;title\u0026#34; elastic_mapping:\u0026#34;title: { type: text, analyzer: standard }\u0026#34;` Content string `json:\u0026#34;content\u0026#34; elastic_mapping:\u0026#34;content: { type: text, analyzer: standard }\u0026#34;` Tags []string `json:\u0026#34;tags\u0026#34; elastic_mapping:\u0026#34;tags: { type: keyword }\u0026#34;` Status string `json:\u0026#34;status\u0026#34; elastic_mapping:\u0026#34;status: { type: keyword }\u0026#34;` \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Source\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;DataSourceReference\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;source\u0026amp;#34;`\u0026lt;/span\u0026gt;  } Object Registration #\n Objects must be registered with the ORM before use. Registration typically happens during application initialization. Note: Schema initialization is handled automatically - you only need to register your objects.\nSimple Registration #  // Register object with custom index name orm.MustRegisterSchemaWithIndexName(\u0026amp;User{}, \u0026#34;users\u0026#34;) // Register with default naming (struct name lowercase + 's') orm.MustRegisterSchemaWithIndexName(\u0026amp;Document{}, \u0026quot;documents\u0026quot;)\n// Registration is complete - no additional initialization needed! Registration with Context #\n // For advanced scenarios with sharing/multitenancy ctx := orm.NewContext() orm.WithModel(ctx, \u0026amp;User{}) orm.WithModel(ctx, \u0026amp;Document{}) Elasticsearch Mapping with elastic_mapping #  The elastic_mapping tag allows you to define Elasticsearch field mappings directly in your Go struct. This provides fine-grained control over how your data is indexed and queried.\nCommon Mapping Parameters #     Parameter Description Example     type Field data type type:text, type:keyword, type:date   analyzer Text analyzer for indexing and searching analyzer:standard, analyzer:ik_max_word   index Whether field should be indexed index:false, index:true   enabled Enable/disable field processing enabled:false, enabled:true   store Store field values separately store:true   copy_to Copy field value to another field copy_to:combined_fulltext   fields Define multi-fields for different analysis fields:{keyword: {type: keyword}}   format Date format for date fields format:yyyy-MM-dd HH:mm:ss    Advanced Mapping Options #  Multi-field Mapping #  type Product struct { orm.ORMObjectBase \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Name\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;name\u0026amp;#34; elastic_mapping:\u0026amp;#34;name:{type:text,analyzer:standard,fields:{keyword:{type:keyword},raw:{type:keyword,index:false}}}\u0026amp;#34;`\u0026lt;/span\u0026gt;  } Object Mapping #\n type User struct { orm.ORMObjectBase \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Address\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Address\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;address\u0026amp;#34; elastic_mapping:\u0026amp;#34;address:{type:object,properties:{city:{type:keyword},country:{type:keyword}}}\u0026amp;#34;`\u0026lt;/span\u0026gt;  }\n// OR dynamic object mapping type Config struct { orm.ORMObjectBase\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Settings\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;[\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;]\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;interface\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;settings\u0026amp;#34; elastic_mapping:\u0026amp;#34;settings:{type:object}\u0026amp;#34;`\u0026lt;/span\u0026gt;  } Store-only Mapping #\n type Attachment struct { orm.ORMObjectBase \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;FileName\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;filename\u0026amp;#34;`\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;FileData\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;file_data\u0026amp;#34; elastic_mapping:\u0026amp;#34;file_data:{enabled:false}\u0026amp;#34;`\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Not indexed, just stored  } Text Analysis with Multiple Analyzers #\n type Content struct { orm.ORMObjectBase \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Title\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;title\u0026amp;#34; elastic_mapping:\u0026amp;#34;title:{type:text,analyzer:standard,fields:{pinyin:{type:text,analyzer:pinyin_analyzer},keyword:{type:keyword}}}\u0026amp;#34;`\u0026lt;/span\u0026gt;  } Real-World DataSource Example #\n From the actual codebase showing advanced mapping patterns:\ntype CombinedFullText struct { orm.ORMObjectBase CombinedFullText string `json:\u0026#34;-\u0026#34; elastic_mapping:\u0026#34;combined_fulltext:{type:text,index_prefixes:{},index_phrases:true,analyzer:combined_text_analyzer}\u0026#34;` \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Metadata\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;[\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;]\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;interface\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;`json:\u0026amp;#34;metadata,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;metadata:{type:object}\u0026amp;#34;`\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Searchable metadata   Payload map[string]interface{} json:\u0026amp;#34;payload,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;payload:{enabled:false}\u0026amp;#34; // Store-only metadata }\ntype DataSource struct { CombinedFullText // Inherits all base fields  Type string json:\u0026amp;#34;type,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;type:{type:keyword,copy_to:combined_fulltext}\u0026amp;#34; Name string json:\u0026amp;#34;name\u0026amp;#34; elastic_mapping:\u0026amp;#34;name:{type:keyword,copy_to:combined_fulltext,fields:{text:{type:text},pinyin:{type:text,analyzer:pinyin_analyzer}}}\u0026amp;#34; Description string json:\u0026amp;#34;description,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;description:{type:text,copy_to:combined_fulltext}\u0026amp;#34; Icon string json:\u0026amp;#34;icon,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;icon:{enabled:false}\u0026amp;#34; Category string json:\u0026amp;#34;category,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;category:{type:keyword}\u0026amp;#34; Tags []string json:\u0026amp;#34;tags,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;tags:{type:keyword}\u0026amp;#34; Connector ConnectorConfig json:\u0026amp;#34;connector,omitempty\u0026amp;#34; elastic_mapping:\u0026amp;#34;connector:{type:object}\u0026amp;#34; Enabled bool json:\u0026amp;#34;enabled\u0026amp;#34; elastic_mapping:\u0026amp;#34;enabled:{type:keyword}\u0026amp;#34; } CRUD Operations #\n Create (Create) #  func createUser() { // Create context  ctx := orm.NewContext() ctx.Refresh = orm.WaitForRefresh // Wait for index refresh  // Create new user - ID and timestamps handled automatically by ORMObjectBase  user := \u0026amp;User{ Name: \u0026#34;John Doe\u0026#34;, Email: \u0026#34;john@example.com\u0026#34;, Age: 25, } \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Insert into database   err := orm.Create(ctx, user) if err != nil { log.Error(\u0026quot;Failed to create user:\u0026quot;, err) return }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Printf\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;User created with ID: %s\\n\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;GetID\u0026lt;/span\u0026gt;())  } Read (Get) #\n func getUser() { ctx := orm.NewContext() \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;\u0026amp;amp;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;User\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ID\u0026lt;/span\u0026gt; = \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;user-id-123\u0026amp;#34;\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Get user by ID   exists, err := orm.GetV2(ctx, user) if err != nil { log.Error(\u0026quot;Failed to get user:\u0026quot;, err) return }\n\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; !\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;exists\u0026lt;/span\u0026gt; { \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Println\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;User not found\u0026amp;#34;\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; } \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Printf\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Found user: %s, Email: %s\\n\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Name\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Email\u0026lt;/span\u0026gt;)  }\nfunc getUserWithSystemFields() { ctx := orm.NewContext()\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;\u0026amp;amp;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;User\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ID\u0026lt;/span\u0026gt; = \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;user-id-123\u0026amp;#34;\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Get user including system fields   exists, err := orm.GetWithSystemFields(ctx, user) if err != nil { log.Error(\u0026quot;Failed to get user:\u0026quot;, err) return }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Access system fields   if exists \u0026amp;\u0026amp; user.System != nil { ownerID := user.GetOwnerID() fmt.Printf(\u0026quot;User owner ID: %s\\n\u0026quot;, ownerID) } } Update (Update/Upsert) #\n func updateUser() { ctx := orm.NewContext() ctx.Refresh = orm.WaitForRefresh \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Get existing user - timestamps handled automatically   user := \u0026amp;User{} user.SetID(\u0026quot;user-id-123\u0026quot;) // or use GetID() if you have the object  exists, err := orm.GetV2(ctx, user) if err != nil || !exists { log.Error(\u0026quot;User not found\u0026quot;) return }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Update fields - Updated timestamp handled automatically   user.Name = \u0026quot;John Smith\u0026quot;\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Update in database   err = orm.Update(ctx, user) if err != nil { log.Error(\u0026quot;Failed to update user:\u0026quot;, err) return }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Println\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;User updated successfully\u0026amp;#34;\u0026lt;/span\u0026gt;)  }\nfunc updatePartialFields() { ctx := orm.NewContext() ctx.Refresh = orm.WaitForRefresh\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Update only specific fields   updates := util.MapStr{ \u0026quot;name\u0026quot;: \u0026quot;Johnny Doe\u0026quot;, \u0026quot;email\u0026quot;: \u0026quot;johnny@example.com\u0026quot;, }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;\u0026amp;amp;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;User\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ID\u0026lt;/span\u0026gt; = \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;user-id-123\u0026amp;#34;\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;orm\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;UpdatePartialFields\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ctx\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;updates\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt; { \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Failed to update user:\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; } \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Println\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;User partially updated successfully\u0026amp;#34;\u0026lt;/span\u0026gt;)  }\nfunc upsertUser() { ctx := orm.NewContext() ctx.Refresh = orm.WaitForRefresh\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Create or update user - timestamps handled automatically   user := \u0026amp;User{ Name: \u0026quot;John Updated\u0026quot;, Email: \u0026quot;john.updated@example.com\u0026quot;, }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Use existing ID if updating, or SetID will generate one if needed   user.SetID(\u0026quot;user-id-123\u0026quot;)\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;orm\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Upsert\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ctx\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt; { \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Failed to upsert user:\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; } \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Println\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;User upserted successfully\u0026amp;#34;\u0026lt;/span\u0026gt;)  } Delete (Delete) #\n func deleteUser() { ctx := orm.NewContext() ctx.Refresh = orm.WaitForRefresh \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;\u0026amp;amp;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;User\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;SetID\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;user-id-123\u0026amp;#34;\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Delete user   err := orm.Delete(ctx, user) if err != nil { log.Error(\u0026quot;Failed to delete user:\u0026quot;, err) return }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Println\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;User deleted successfully\u0026amp;#34;\u0026lt;/span\u0026gt;)  } Advanced Operations #\n Search with Query Builder #  func searchUsers() { ctx := orm.NewContext() \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Create query builder   builder := orm.NewQueryBuilder()\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Add filters   builder.Filter(orm.TermQuery(\u0026quot;age\u0026quot;, 25)) builder.Filter(orm.RangeQuery(\u0026quot;created\u0026quot;, util.MapStr{ \u0026quot;gte\u0026quot;: \u0026quot;2023-01-01\u0026quot;, \u0026quot;lte\u0026quot;: \u0026quot;2023-12-31\u0026quot;, }))\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Add sorting   builder.SortBy(orm.Sort{Field: \u0026quot;created\u0026quot;, SortType: orm.DESC})\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Execute search   var users []User err, result := elastic.SearchV2WithResultItemMapper(ctx, \u0026amp;users, builder, nil) if err != nil { log.Error(\u0026quot;Search failed:\u0026quot;, err) return }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Printf\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Found %d users\\n\u0026amp;#34;\u0026lt;/span\u0026gt;, len(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;users\u0026lt;/span\u0026gt;)) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;_\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;users\u0026lt;/span\u0026gt; { \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Printf\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;User: %s (%s)\\n\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Name\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Email\u0026lt;/span\u0026gt;) }  } Complex Search with Text Queries #\n func searchDocuments() { ctx := orm.NewContext() \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;builder\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;orm\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;NewQueryBuilderFromRequest\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;req\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;title\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;content\u0026amp;#34;\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Enable body bytes for receiving additional Raw QueryDSL   builder.EnableBodyBytes()\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Add date range filter   builder.Filter(orm.RangeQuery(\u0026quot;created\u0026quot;, util.MapStr{ \u0026quot;gte\u0026quot;: \u0026quot;2024-01-01\u0026quot;, }))\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Add pagination   builder.Size(20).From(0)\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Add aggregations   ctx.Set(orm.AggsTerms, \u0026quot;tags\u0026quot;)\n\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;docs\u0026lt;/span\u0026gt; []\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Document\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;elastic\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;SearchV2WithResultItemMapper\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ctx\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;\u0026amp;amp;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;docs\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;builder\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt; { \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Search failed:\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; } \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Process results   fmt.Printf(\u0026quot;Found %d documents\\n\u0026quot;, len(docs)) } Delete by Query #\n func deleteOldUsers() { ctx := orm.NewContext() \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Create delete query   builder := orm.NewQueryBuilder() builder.Filter(orm.RangeQuery(\u0026quot;created\u0026quot;, util.MapStr{ \u0026quot;lt\u0026quot;: \u0026quot;2022-01-01\u0026quot;, // Delete users created before 2022  }))\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Execute delete by query   result, err := orm.DeleteByQuery(ctx, builder) if err != nil { log.Error(\u0026quot;Delete by query failed:\u0026quot;, err) return }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;fmt\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Printf\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Deleted %d old users\\n\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Deleted\u0026lt;/span\u0026gt;)  } Context Options #\n The ORM provides various context options for controlling behavior:\nctx := orm.NewContext() // Wait for index refresh ctx.Refresh = orm.WaitForRefresh\n// Enable sharing for multi-tenant systems ctx.Set(orm.SharingEnabled, true) ctx.Set(orm.SharingResourceType, \u0026quot;users\u0026quot;) ctx.Set(orm.SharingCategoryCheckingChildrenEnabled, true)\n// Keep system fields ctx.Set(orm.KeepSystemFields, true)\n// Model binding for type-safe operations orm.WithModel(ctx, \u0026amp;User{})\n// Set custom timeout ctx.SetTimeout(30 * time.Second) Real-World Example: DataSource Module #\n Here\u0026rsquo;s how the ORM is used in the actual codebase:\nfunc (h *APIHandler) createDatasource(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { var obj = \u0026amp;core.DataSource{} h.MustDecodeJSON(req, obj) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Check referenced connector   if obj.Connector.ConnectorID == \u0026quot;\u0026quot; { panic(\u0026quot;invalid connector\u0026quot;) }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ctx\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;orm\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;NewContextWithParent\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;req\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Context\u0026lt;/span\u0026gt;()) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Validate related object   connector := core.Connector{} connector.ID = obj.Connector.ConnectorID exists, err := orm.GetV2(ctx, \u0026amp;connector) if !exists || err != nil { panic(\u0026quot;invalid connector\u0026quot;) }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Set refresh option and create   ctx.Refresh = orm.WaitForRefresh err = orm.Create(ctx, obj) if err != nil { h.WriteError(w, err.Error(), http.StatusInternalServerError) return }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;h\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;WriteJSON\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;w\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;util\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;MapStr\u0026lt;/span\u0026gt;{ \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;_id\u0026amp;#34;\u0026lt;/span\u0026gt;: \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;obj\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ID\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;result\u0026amp;#34;\u0026lt;/span\u0026gt;: \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;created\u0026amp;#34;\u0026lt;/span\u0026gt;, }, \u0026lt;span style=\u0026quot;color:#ae81ff\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;)  } \n","subcategory":null,"summary":"","tags":null,"title":"ORM (Object-Relational Mapping)","url":"/framework/v1.4.0/docs/references/orm/"},{"category":null,"content":"API \u0026amp; Web Framework #  The INFINI Framework provides a comprehensive API and Web framework built on top of Go\u0026rsquo;s HTTP ecosystem, featuring high-performance routing, flexible middleware system, and built-in security features.\nOverview #  The framework offers two separate but complementary HTTP servers:\n API Server: Designed for programmatic access and RESTful APIs Web Server: Designed for web interfaces and UI applications  Both servers share common patterns and can be configured independently.\nArchitecture #  Core Components #   HTTP Router: High-performance trie-based routing with path parameters Handler System: Structured request processing with built-in utilities Middleware: Flexible filter chain for cross-cutting concerns Security: Integrated authentication, authorization, and CORS support Response Helpers: Standardized JSON responses and error handling  Configuration #  API Server Configuration #  api: enabled: true network: host: \u0026#34;0.0.0.0\u0026#34; port: 9200 binding: \u0026#34;0.0.0.0:9200\u0026#34; publish: \u0026#34;localhost:9200\u0026#34; skip_occupied_port: true security: enabled: true username: \u0026#34;admin\u0026#34; password: \u0026#34;password\u0026#34; cors: allowed_origins: - \u0026#34;https://domain.com\u0026#34; - \u0026#34;http://localhost:3000\u0026#34; websocket: enabled: true base_path: \u0026#34;/ws\u0026#34; permitted_hosts: [] skip_host_verify: false base_path: \u0026#34;/_api\u0026#34; # Base path for API endpoints verbose_error_root_cause: false api_directory_path: \u0026#34;/api\u0026#34; # API documentation directory disable_api_directory: false Web Server Configuration #  web: enabled: true network: host: \u0026#34;0.0.0.0\u0026#34; port: 8090 binding: \u0026#34;0.0.0.0:8090\u0026#34; publish: \u0026#34;localhost:8090\u0026#34; skip_occupied_port: true security: enabled: true authentication: native: enabled: true # Note: http_basic authentication is not supported yet for web # users should use API basic auth or OAuth2 instead http_basic: enabled: false # endpoint: \u0026#34;https://auth.example.com\u0026#34; # Not implemented # secret_id: \u0026#34;\u0026#34; # secret_key: \u0026#34;\u0026#34; cors: allowed_origins: - \u0026#34;https://domain.com\u0026#34; websocket: enabled: true base_path: \u0026#34;/ws\u0026#34; permitted_hosts: [] skip_host_verify: false base_path: \u0026#34;\u0026#34; # Base path for web application gzip: enabled: true level: 6 cookie: store: \u0026#34;cookie\u0026#34; secure: true httponly: true max_age: 2592000 path: \u0026#34;/\u0026#34; ui: local: enabled: true path: \u0026#34;./web/dist\u0026#34; vfs: enabled: false embedding_api: false Handler Definition #  Basic Handler Structure #  Create a handler by embedding the base api.Handler:\npackage mymodule import ( \u0026quot;infini.sh/framework/core/api\u0026quot; httprouter \u0026quot;infini.sh/framework/core/api/router\u0026quot; \u0026quot;net/http\u0026quot; )\ntype APIHandler struct { api.Handler // Embedding base handler for all functionality } Handler Registration #\n Register handlers using the built-in routing methods:\nfunc init() { // Create handler instance  handler := APIHandler{} \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Register with permissions and features   api.HandleUIMethod(api.POST, \u0026quot;/users/\u0026quot;, handler.createUser, api.RequirePermission(createPermission)) api.HandleUIMethod(api.GET, \u0026quot;/users/:id\u0026quot;, handler.getUser, api.RequirePermission(readPermission)) api.HandleUIMethod(api.PUT, \u0026quot;/users/:id\u0026quot;, handler.updateUser, api.RequirePermission(updatePermission)) api.HandleUIMethod(api.DELETE, \u0026quot;/users/:id\u0026quot;, handler.deleteUser, api.RequirePermission(deletePermission)) api.HandleUIMethod(api.GET, \u0026quot;/users/_search\u0026quot;, handler.searchUsers, api.RequirePermission(searchPermission)) } Route Patterns and Parameters #\n Basic Routes #  // Static paths api.HandleUIMethod(api.GET, \u0026#34;/settings\u0026#34;, handler.getSettings) api.HandleUIMethod(api.POST, \u0026#34;/settings\u0026#34;, handler.updateSettings) // Path parameters (required) api.HandleUIMethod(api.GET, \u0026quot;/users/:id\u0026quot;, handler.getUser) api.HandleUIMethod(api.GET, \u0026quot;/documents/:docId/comments/:commentId\u0026quot;, handler.getComment)\n// Catch-all parameters (optional) api.HandleUIMethod(api.GET, \u0026quot;/files/*filepath\u0026quot;, handler.serveFile) Parameter Extraction #\n func (h *APIHandler) getUser(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { // Extract path parameter  userID := ps.MustGetParameter(\u0026#34;id\u0026#34;) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Alternative extraction   userID = ps.ByName(\u0026quot;id\u0026quot;)\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Query parameters   page := h.GetIntOrDefault(req, \u0026quot;page\u0026quot;, 1) size := h.GetIntOrDefault(req, \u0026quot;size\u0026quot;, 20)\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Headers   authToken := h.GetHeader(req, \u0026quot;Authorization\u0026quot;, \u0026quot;\u0026quot;) } Request Handling #\n JSON Input Processing #  func (h *APIHandler) createUser(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { var user CreateUserRequest \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Validate and decode JSON input   err := h.DecodeJSON(req, \u0026amp;user) if err != nil { h.WriteError(w, \u0026quot;Invalid JSON input\u0026quot;, http.StatusBadRequest) return }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// OR use MustDecodeJSON for automatic error handling   h.MustDecodeJSON(req, \u0026amp;user) }\nfunc (h APIHandler) updateUser(w http.ResponseWriter, req http.Request, ps httprouter.Params) { var updates map[string]interface{}\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Use for partial updates   err := h.DecodeJSON(req, \u0026amp;updates) if err != nil { h.WriteJSON(w, util.MapStr{\u0026quot;error\u0026quot;: \u0026quot;Invalid input\u0026quot;}, http.StatusBadRequest) return } } Query Parameter Processing #\n func (h *APIHandler) searchUsers(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { // Required parameters  query := h.MustGetParameter(w, req, \u0026#34;q\u0026#34;) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Optional parameters with defaults   page := h.GetIntOrDefault(req, \u0026quot;page\u0026quot;, 1) size := h.GetIntOrDefault(req, \u0026quot;size\u0026quot;, 10) sort := h.GetParameterOrDefault(req, \u0026quot;sort\u0026quot;, \u0026quot;created:desc\u0026quot;)\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Boolean parameters   activeOnly := h.GetBoolOrDefault(req, \u0026quot;active\u0026quot;, true)\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Multiple values   status := req.URL.Query()[\u0026quot;status\u0026quot;] tags := req.URL.Query()[\u0026quot;tags\u0026quot;] } Response Helpers #\n Standard JSON Responses #  // Simple JSON response func (h *APIHandler) getStatus(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { status := map[string]interface{}{ \u0026#34;status\u0026#34;: \u0026#34;healthy\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, } h.WriteJSON(w, status, http.StatusOK) } // List with total count func (h APIHandler) listUsers(w http.ResponseWriter, req http.Request, ps httprouter.Params) { users := []User{{}, {}} h.WriteJSONListResult(w, 2, users, http.StatusOK) }\n// Acknowledgment response func (h APIHandler) deleteUser(w http.ResponseWriter, req http.Request, ps httprouter.Params) { h.WriteAckJSON(w, true, http.StatusOK, nil) }\n// Creation response func (h APIHandler) createUser(w http.ResponseWriter, req http.Request, ps httprouter.Params) { h.WriteCreatedOKJSON(w, \u0026quot;user-123\u0026quot;) }\n// Update response func (h APIHandler) updateUser(w http.ResponseWriter, req http.Request, ps httprouter.Params) { h.WriteUpdatedOKJSON(w, \u0026quot;user-123\u0026quot;) } Error Handling #\n // Standard error response func (h *APIHandler) handleError(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { h.WriteError(w, \u0026#34;Resource not found\u0026#34;, http.StatusNotFound) } // Detailed error object func (h APIHandler) handleComplexError(w http.ResponseWriter, req http.Request, ps httprouter.Params) { err := util.MapStr{ \u0026quot;error\u0026quot;: \u0026quot;Validation failed\u0026quot;, \u0026quot;field_errors\u0026quot;: map[string]string{ \u0026quot;email\u0026quot;: \u0026quot;invalid format\u0026quot;, \u0026quot;age\u0026quot;: \u0026quot;must be positive\u0026quot;, }, } h.WriteErrorObject(w, err, http.StatusBadRequest) }\n// HTTP status code errors func (h APIHandler) handleVariousErrors(w http.ResponseWriter, req http.Request, ps httprouter.Params) { h.Error404(w) // 404 Not Found  h.Error400(w, \u0026quot;Bad request\u0026quot;) // 400 Bad Request  h.Error500(w, \u0026quot;Internal server error\u0026quot;) // 500 Internal Server Error  h.ErrorInternalServer(w, \u0026quot;Something went wrong\u0026quot;) // 500, alternative } API Middleware and Options #\n Permission-based Access Control #  import \u0026#34;infini.sh/framework/core/security\u0026#34; // Define permissions var createPermission = security.GetSimplePermission(\u0026quot;user\u0026quot;, \u0026quot;user\u0026quot;, string(security.Create)) var readPermission = security.GetSimplePermission(\u0026quot;user\u0026quot;, \u0026quot;user\u0026quot;, string(security.Read)) var updatePermission = security.GetSimplePermission(\u0026quot;user\u0026quot;, \u0026quot;user\u0026quot;, string(security.Update)) var deletePermission = security.GetSimplePermission(\u0026quot;user\u0026quot;, \u0026quot;user\u0026quot;, string(security.Delete))\n// Register with permissions api.HandleUIMethod(api.POST, \u0026quot;/users/\u0026quot;, handler.createUser, api.RequirePermission(createPermission)) api.HandleUIMethod(api.GET, \u0026quot;/users/:id\u0026quot;, handler.getUser, api.RequirePermission(readPermission))\n// Multiple permissions - require all api.HandleUIMethod(api.DELETE, \u0026quot;/admin/users/:id\u0026quot;, handler.deleteUser, api.RequirePermission(deletePermission, adminPermission)) Feature Flags #\n // Enable CORS for specific endpoints api.HandleUIMethod(api.OPTIONS, \u0026#34;/users/_search\u0026#34;, handler.searchUsers, api.Feature(core.FeatureCORS)) // Note: Request logging is not yet available as a feature flag // Use manual logging in handlers if needed  // Disable sensitive field exposure api.HandleUIMethod(api.GET, \u0026quot;/users/:id\u0026quot;, handler.getUser, api.Feature(core.FeatureMaskSensitiveField))\n// Enable JSON schema validation api.HandleUIMethod(api.POST, \u0026quot;/users/\u0026quot;, handler.createUser, api.Feature(core.FeatureValidateRequestJSON)) Authentication Options #\n The framework supports multiple authentication backends.\n// Require login with standard auth api.HandleUIMethod(api.POST, \u0026#34;/users/\u0026#34;, handler.createUser, api.RequireLogin()) // Optional login - process if authenticated, allow anonymous otherwise api.HandleUIMethod(api.GET, \u0026quot;/public/users/\u0026quot;, handler.listPublicUsers, api.OptionLogin())\n// Public access - no authentication required api.HandleUIMethod(api.GET, \u0026quot;/health\u0026quot;, handler.healthCheck, api.AllowPublicAccess()) Label and Metadata #\n // Add metadata for logging or processing api.HandleUIMethod(api.POST, \u0026#34;/users/\u0026#34;, handler.createUser, api.Name(\u0026#34;Create User\u0026#34;), api.Resource(\u0026#34;user\u0026#34;), api.Action(\u0026#34;create\u0026#34;), api.Label(\u0026#34;operation\u0026#34;, \u0026#34;user_management\u0026#34;), api.Label(\u0026#34;tag\u0026#34;, \u0026#34;admin\u0026#34;), api.Tags([]string{\u0026#34;user\u0026#34;, \u0026#34;admin\u0026#34;, \u0026#34;create\u0026#34;})) Available Features Reference #     Feature Description Usage     core.FeatureCORS Enable CORS headers for cross-origin requests Standard CORS support   core.FeatureNotAllowCredentials Disable credentials in CORS responses CORS with no credentials   core.FeatureByPassCORSCheck Skip CORS checking entirely Internal endpoints   core.FeatureFingerprintThrottle Enable fingerprint-based rate throttling Rate limiting   core.FeatureMaskSensitiveField Mask sensitive field values in responses Hide data partially   core.FeatureRemoveSensitiveField Remove sensitive fields from responses Hide data completely    Web Framework Features #  The web framework is primarily designed for serving static UI assets and handling web interfaces. Key features include:\nStatic File Serving with VFS #  Static files are managed through the Virtual File System (VFS) which provides both embedded and local file serving capabilities with runtime customization support:\n// Registration in main.go vfs.RegisterFS(public.StaticFS{ StaticFolder: global.Env().SystemConfig.WebAppConfig.UI.LocalPath, TrimLeftPath: global.Env().SystemConfig.WebAppConfig.UI.LocalPath, CheckLocalFirst: global.Env().SystemConfig.WebAppConfig.UI.LocalEnabled, SkipVFS: !global.Env().SystemConfig.WebAppConfig.UI.VFSEnabled, }) // Then register the file server api1.HandleUI(\u0026quot;/\u0026quot;, vfs.FileServer(vfs.VFS())) VFS File Lookup Strategy #\n The VFS system uses a \u0026ldquo;local-first\u0026rdquo; lookup strategy:\n Check local files in the configured folder (default: .public relative to app binary) Fall back to embedded files if local file doesn\u0026rsquo;t exist This allows runtime customization by replacing files in the local folder  Configuration Example #  web: ui: local: enabled: true # Enable local file checking path: \u0026#34;./web/dist\u0026#34; # Path to local files (relative to binary) vfs: enabled: false # Use embedded files when local disabled Customization Workflow #   Place your static files in the local folder (default: .public/ relative to app binary location) Files in this folder will override embedded files with the same path Changes take effect immediately without restart Perfect for theme customization, branding, or emergency fixes  Configuration-Only Features #  Unlike the API server, web framework features are primarily configuration-driven:\nweb: gzip: enabled: true # Enable gzip compression level: 6 # Compression level 1-9 cookie: secure: true # HTTPS only cookies httponly: true # Prevent XSS attacks path: \u0026quot;/\u0026quot; # Cookie scope\ncors: allowed_origins: [\u0026quot;https://example.com\u0026quot;] # CORS domains WebSocket Support #\n api: websocket: enabled: true base_path: \u0026#34;/ws\u0026#34; permitted_hosts: [] skip_host_verify: false func (h *APIHandler) handleWebSocket(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { roomID := ps.ByName(\u0026#34;room_id\u0026#34;) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Upgrade HTTP to WebSocket   conn, err := websocket.Upgrade(w, req) if err != nil { h.WriteError(w, \u0026quot;WebSocket upgrade failed\u0026quot;, http.StatusBadRequest) return }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Join chat room   room := websocket.GetRoom(roomID) room.Join(conn) } Session Management #\n func (h *APIHandler) login(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { var login LoginRequest h.MustDecodeJSON(req, \u0026amp;login) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Validate credentials   user, err := authService.Login(login.Username, login.Password) if err != nil { h.WriteError(w, \u0026quot;Invalid credentials\u0026quot;, http.StatusUnauthorized) return }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Create session   session := h.CreateSession(w, user.ID) session.Set(\u0026quot;user\u0026quot;, user) session.Set(\u0026quot;last_login\u0026quot;, time.Now())\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;h\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;WriteJSON\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;w\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;[\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;]\u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;interface\u0026lt;/span\u0026gt;{}{ \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;message\u0026amp;#34;\u0026lt;/span\u0026gt;: \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Login successful\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;user\u0026amp;#34;\u0026lt;/span\u0026gt;: \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;user\u0026lt;/span\u0026gt;, }, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;http\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;StatusOK\u0026lt;/span\u0026gt;)  } API Handler Base Functions #\n The embedded api.Handler provides comprehensive helper methods:\nHTTP Method Handling #   WriteJSON(w, v, code) - Standard JSON response WriteJSONListResult(w, total, v, code) - List with total count WriteError(w, message, code) - Error response WriteAckJSON(w, ack, code, obj) - Acknowledgment response WriteCreatedOKJSON(w, id) - Creation confirmation WriteUpdatedOKJSON(w, id) - Update confirmation WriteDeletedOKJSON(w, id) - Deletion confirmation  Parameter Processing #   GetParameter(r, key) - Get query parameter GetParameterOrDefault(r, key, def) - Get parameter with default MustGetParameter(w, r, key) - Required parameter (404 if missing) GetIntOrDefault(r, key, def) - Integer parameter GetBoolOrDefault(r, key, def) - Boolean parameter GetHeader(r, header, def) - HTTP header access  JSON Processing #   MustDecodeJSON(r, obj) - Decode JSON with automatic error handling DecodeJSON(r, obj) - Decode JSON returning error GetJSON(r) - Get JSONQ wrapper for complex parsing GetRawBody(r) - Get raw request body as bytes  Error Responses #   Error500(w, msg) - Internal server error Error400(w, msg) - Bad request Error404(w) - Not found WriteErrorObject(w, err, code) - Complex error structure  Real-World Example: DataSource Module #  Complete API implementation from the framework:\npackage datasource import ( \u0026quot;infini.sh/framework/core/api\u0026quot; httprouter \u0026quot;infini.sh/framework/core/api/router\u0026quot; \u0026quot;infini.sh/framework/core/security\u0026quot; \u0026quot;infini.sh/framework/core/util\u0026quot; \u0026quot;net/http\u0026quot; )\ntype APIHandler struct { api.Handler }\nconst Category = \u0026quot;coco\u0026quot; const Datasource = \u0026quot;datasource\u0026quot;\nfunc init() { // Define permissions  createPermission := security.GetSimplePermission(Category, Datasource, string(security.Create)) updatePermission := security.GetSimplePermission(Category, Datasource, string(security.Update)) readPermission := security.GetSimplePermission(Category, Datasource, string(security.Read)) deletePermission := security.GetSimplePermission(Category, Datasource, string(security.Delete)) searchPermission := security.GetSimplePermission(Category, Datasource, string(security.Search))\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Register permissions   security.RegisterPermissionsToRole(core.WidgetRole, searchPermission)\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;handler\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;APIHandler\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Register routes with permissions and features   api.HandleUIMethod(api.POST, \u0026quot;/datasource/\u0026quot;, handler.createDatasource, api.RequirePermission(createPermission))\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;HandleUIMethod\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;GET\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;/datasource/:id\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;handler\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;getDatasource\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;RequirePermission\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;readPermission\u0026lt;/span\u0026gt;)) \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;HandleUIMethod\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;PUT\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;/datasource/:id\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;handler\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;updateDatasource\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;RequirePermission\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;updatePermission\u0026lt;/span\u0026gt;)) \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;HandleUIMethod\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;DELETE\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;/datasource/:id\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;handler\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;deleteDatasource\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;RequirePermission\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;deletePermission\u0026lt;/span\u0026gt;)) \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;HandleUIMethod\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;GET\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;/datasource/_search\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;handler\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;searchDatasource\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;RequirePermission\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;searchPermission\u0026lt;/span\u0026gt;), \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Feature\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;core\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;FeatureCORS\u0026lt;/span\u0026gt;), \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Feature\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;core\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;FeatureMaskSensitiveField\u0026lt;/span\u0026gt;), \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Label\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;core\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;SensitiveFields\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;secretKeys\u0026lt;/span\u0026gt;))  }\nfunc (h APIHandler) createDatasource(w http.ResponseWriter, req http.Request, ps httprouter.Params) { var obj = \u0026amp;core.DataSource{} h.MustDecodeJSON(req, obj)\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Input validation   if obj.Connector.ConnectorID == \u0026quot;\u0026quot; { panic(\u0026quot;invalid connector\u0026quot;) }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Create with ORM   err := orm.Create(ctx, obj) if err != nil { h.WriteError(w, err.Error(), http.StatusInternalServerError) return }\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;h\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;WriteCreatedOKJSON\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;w\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;obj\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ID\u0026lt;/span\u0026gt;)  }\nfunc (h APIHandler) getDatasource(w http.ResponseWriter, req http.Request, ps httprouter.Params) { id := ps.MustGetParameter(\u0026quot;id\u0026quot;)\n\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;obj\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;core\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;DataSource\u0026lt;/span\u0026gt;{} \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;obj\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ID\u0026lt;/span\u0026gt; = \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;id\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;exists\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;orm\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;GetV2\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;ctx\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;\u0026amp;amp;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;obj\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt; { \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;h\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;WriteError\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;w\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;(), \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;http\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;StatusInternalServerError\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; } \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; !\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;exists\u0026lt;/span\u0026gt; { \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;h\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;WriteGetMissingJSON\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;w\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;id\u0026lt;/span\u0026gt;) \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; } \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;h\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;WriteGetOKJSON\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;w\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;id\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;obj\u0026lt;/span\u0026gt;)  } Best Practices #\n 1. Consistent Response Patterns #  // Always use framework helpers for consistent responses func GoodExample(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { user := getUser(id) h.WriteGetOKJSON(w, id, user) } func BadExample(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { user := getUser(id) h.WriteJSON(w, map[string]interface{}{ \u0026quot;_id\u0026quot;: id, \u0026quot;found\u0026quot;: true, \u0026quot;_source\u0026quot;: user, }, http.StatusOK) } 2. Proper Error Handling #\n func GoodErrorHandling(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { if err != nil { // Use appropriate HTTP status codes  if err == ErrNotFound { h.WriteError(w, \u0026#34;User not found\u0026#34;, http.StatusNotFound) return } if err == ErrValidation { h.WriteError(w, \u0026#34;Invalid input\u0026#34;, http.StatusBadRequest) return } h.WriteError(w, \u0026#34;Internal error\u0026#34;, http.StatusInternalServerError) return } } 3. Parameter Validation #  func ProperValidation(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { // Extract parameters  id := ps.MustGetParameter(\u0026#34;id\u0026#34;) \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Validate required parameters   if id == \u0026quot;\u0026quot; { h.WriteError(w, \u0026quot;ID parameter is required\u0026quot;, http.StatusBadRequest) return }\n\u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Validate optional parameters   page := h.GetIntOrDefault(req, \u0026quot;page\u0026quot;, 1) if page \u0026lt; 1 { h.WriteError(w, \u0026quot;Page must be positive\u0026quot;, http.StatusBadRequest) return } } 4. Security Integration #\n func SecureEndpoint(w http.ResponseWriter, req *http.Request, ps httprouter.Params) { handler := APIHandler{} \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;HandleUIMethod\u0026lt;/span\u0026gt;(\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;POST\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;/admin/update\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;handler\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;updateAdmin\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;api\u0026lt;/span\u0026gt;.\u0026lt;span style=\u0026quot;color:#a6e22e\u0026quot;\u0026gt;RequireLogin\u0026lt;/span\u0026gt;(), \u0026lt;span style=\u0026quot;color:#75715e\u0026quot;\u0026gt;// Require authentication   api.RequirePermission(adminPermission), // Require specific permission  api.Feature(core.FeatureCORS)) // Enable CORS if needed } The INFINI API/Web framework provides a solid foundation for building scalable, secure, and well-structured HTTP services with minimal boilerplate while maintaining flexibility for complex applications.\n","subcategory":null,"summary":"","tags":null,"title":"API \u0026 Web Framework","url":"/framework/v1.4.0/docs/references/api_web/"},{"category":null,"content":"Makefile #  The framework simplifies managing your application by providing reusable commands and variables. Below is an example of how Loadgen utilizes this framework in its Makefile:\nUse Loadgen for example, here is the project\u0026rsquo;s Makefile looks like:\nâžœ loadgen git:(main) cat Makefile SHELL=/bin/bash # APP info APP_NAME := loadgen APP_VERSION := 1.0.0_SNAPSHOT APP_CONFIG := $(APP_NAME).yml $(APP_NAME).dsl APP_EOLDate ?= \u0026quot;2025-12-31T10:10:10Z\u0026quot; APP_STATIC_FOLDER := .public APP_STATIC_PACKAGE := public APP_UI_FOLDER := ui APP_PLUGIN_FOLDER := proxy\ninclude ../framework/Makefile Highlights #\n  Modular and Reusable: By including ../framework/Makefile, this project inherits a suite of predefined commands and variables, reducing redundancy. Customizable Variables: Project-specific details (e.g., name, version, config files, and folders) are declared at the top for easy configuration. Framework Integration: The framework/Makefile provides consistent functionality across projects, enabling streamlined workflows.  This approach ensures better maintainability and faster setup for new projects.\nExample #  To build the Loadgen application using the framework, you can run the following command:\nâžœ loadgen git:(main) DEV=false OFFLINE_BUILD=true make build Explanation of the Command:\n DEV=false: Sets the development mode to false, indicating a production build. OFFLINE_BUILD=true: Enables offline build mode, ensuring the build process avoids fetching resources from external sources. make build: Invokes the build target defined in the frameworkâ€™s Makefile, compiling the application according to the specified settings.  This example demonstrates how you can customize the build process using environment variables while leveraging the reusable commands provided by the framework.\nCommands #     Command Description Dependencies/Notes     default Default target, builds the application with race detection Depends on build-race   env Prints environment variables for debugging Outputs key paths and repository settings   build Builds the main application binary    build-dev Builds the application with debug symbols and development tags    build-cmd Builds all binaries in the cmd folder    cross-build-cmd Cross-compiles binaries for Windows and Linux    update-plugins Updates plugin files using plugin discovery tool Requires framework discovery binary   build-race Builds the application with race detection and debug information Depends on clean, config, update-vfs   tar Creates a tarball of the application binary and config file Depends on build   cross-build Cross-compiles the application for Windows, macOS, and Linux    build-win Builds the application binary for Windows    build-linux-* Builds the application binary for specific Linux architectures (e.g., amd64, arm64)    build-darwin Builds the application binary for macOS Supports amd64 and arm64   build-bsd Builds the application binary for BSD systems Supports FreeBSD, NetBSD, and OpenBSD   all Cleans, configures, and builds binaries for all supported platforms    all-platform Builds binaries for all platforms, including BSD, Linux, macOS, and Windows    format Formats all Go files excluding vendor directory Uses go fmt   clean_data Removes data and logs directories    clean Cleans all build artifacts and resets the output directory Depends on clean_data   init Initializes the build environment Checks/clones framework repositories     Variables #     Variable Description Default Value     APP_NAME Application name framework   APP_VERSION Application version 1.0.0_SNAPSHOT   APP_CONFIG Configuration file name $(APP_NAME).yml   APP_EOLDate End-of-life date for the application \u0026quot;2023-12-31T10:10:10Z\u0026quot;   APP_STATIC_FOLDER Path to static folder .public   APP_STATIC_PACKAGE Static package name public   APP_UI_FOLDER UI folder path ui   APP_PLUGIN_FOLDER Plugins folder path plugins   APP_PLUGIN_PKG Plugins package name $(APP_PLUGIN_FOLDER)   APP_NEED_CGO Determines if CGO is required (0 = disabled, 1 = enabled) 0   VERSION Release version from the environment    GOPATH Go workspace path ~/go   BUILD_NUMBER Build number 001   DEV Enables or disables development mode. Set to true for development builds, false for production builds. false   OFFLINE_BUILD Enables offline build mode, preventing the download of external resources during the build process. false   GO Go environment settings GO15VENDOREXPERIMENT=\u0026quot;1\u0026quot; GO111MODULE=off go   FRAMEWORK_FOLDER Path to INFINI Framework folder $(INFINI_BASE_FOLDER)/framework   FRAMEWORK_REPO Framework repository URL https://github.com/infinilabs/framework.git   FRAMEWORK_BRANCH Git branch for the framework main   FRAMEWORK_VENDOR_FOLDER Path to framework vendor folder $(FRAMEWORK_FOLDER)/../vendor/   FRAMEWORK_VENDOR_REPO Vendor repository URL https://github.com/infinilabs/framework-vendor.git   FRAMEWORK_VENDOR_BRANCH Vendor repository branch main   PREFER_MANAGED_VENDOR Determines whether to use a managed vendor directory or fetch dependencies dynamically. If set to 1, the build process will prioritize the pre-downloaded vendor folder (FRAMEWORK_VENDOR_FOLDER). If set to 0, dependencies will be fetched from the FRAMEWORK_VENDOR_REPO. 1     Notes #   Framework Dependencies: This Makefile integrates with INFINI Framework, requiring external repositories for the framework and vendor files. Ensure these are cloned and accessible. Cross-Platform Builds: Targets like build-linux and build-darwin compile binaries for multiple architectures, ensuring compatibility across platforms. Plugin Updates: Plugins are dynamically discovered and updated using a tool within the framework. Ensure plugin-discovery exists and is built. Environment Variables: Many configurations (e.g., GOPATH, VERSION, EOL) can be overridden via environment variables for flexibility.  ","subcategory":null,"summary":"","tags":null,"title":"Makefile","url":"/framework/v1.4.0/docs/references/makefile/"},{"category":null,"content":"Create New Application #  Let\u0026rsquo;s use the NewAPP as the new project for example.\nCreate the project folder #  Use the name new_app as the project id, and create the project folder as below:\ncd ~/go/src/infini.sh/ mkdir new_app  Note: Ensure that new_app is located in the same directory as the framework folder. This structure is required for the Makefile to function correctly.\n Create the main file #  Create a empty main.go file, and paste the code as below:\npackage main import ( \u0026quot;infini.sh/framework\u0026quot; \u0026quot;infini.sh/framework/core/module\u0026quot; \u0026quot;infini.sh/framework/core/util\u0026quot; \u0026quot;infini.sh/framework/modules/api\u0026quot; \u0026quot;infini.sh/new_app/config\u0026quot; )\nfunc main() {\n terminalHeader :\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34; __ _ ___ ___ \\n\u0026amp;#34;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; terminalHeader \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;+=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34; /\\\\ \\\\ \\\\_____ __/_\\\\ / _ \\\\/ _ \\\\\\n\u0026amp;#34;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; terminalHeader \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;+=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34; / \\\\/ / _ \\\\ \\\\ /\\\\ / //_\\\\\\\\ / /_)/ /_)/\\n\u0026amp;#34;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; terminalHeader \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;+=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;/ /\\\\ / __/\\\\ V V / _ \\\\/ ___/ ___/ \\n\u0026amp;#34;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; terminalHeader \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;+=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;\\\\_\\\\ \\\\/ \\\\___| \\\\_/\\\\_/\\\\_/ \\\\_/\\\\/ \\\\/ \\n\\n\u0026amp;#34;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; terminalFooter :\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Goodbye~\u0026amp;#34;\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; app :\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; framework.NewApp\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;new_app\u0026amp;#34;\u0026lt;/span\u0026gt;, \u0026lt;span style=\u0026quot;color:#e6db74\u0026quot;\u0026gt;\u0026amp;#34;Make a golang application is such easy~.\u0026amp;#34;\u0026lt;/span\u0026gt;, util.TrimSpaces\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;config.Version\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;, util.TrimSpaces\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;config.BuildNumber\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;, util.TrimSpaces\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;config.LastCommitLog\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;, util.TrimSpaces\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;config.BuildDate\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;, util.TrimSpaces\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;config.EOLDate\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;, terminalHeader, terminalFooter\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; app.IgnoreMainConfigMissing\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; app.Init\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;nil\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; defer app.Shutdown\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#66d9ef\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; app.Setup\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;func\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt; module.RegisterSystemModule\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026amp;amp;api.APIModule\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;{})\u0026lt;/span\u0026gt; module.Start\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;}\u0026lt;/span\u0026gt;, func\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;}\u0026lt;/span\u0026gt;, nil\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt; app.Run\u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026quot;color:#f92672\u0026quot;\u0026gt;}\u0026lt;/span\u0026gt;  } \nYou may use this online tool to generate your beauty ASCII based terminal header: http://patorjk.com/software/taag/#p=display\u0026amp;h=2\u0026amp;v=1\u0026amp;f=Ogre\u0026amp;t=NewAPP\n Create the config file #  touch new_app.yml Create the makefile #  create a empty Makefile, and paste the code as below:\nSHELL=/bin/bash # APP info APP_NAME := new_app APP_VERSION := 1.0.0_SNAPSHOT APP_CONFIG := $(APP_NAME).yml APP_EOLDate ?= \u0026quot;2025-12-31T10:10:10Z\u0026quot; APP_STATIC_FOLDER := .public APP_STATIC_PACKAGE := public APP_UI_FOLDER := ui APP_PLUGIN_FOLDER := plugins PREFER_MANAGED_VENDOR=fase\ninclude ../framework/Makefile Build the application #\n âžœ new_app OFFLINE_BUILD=true make build building new_app 1.0.0_SNAPSHOT main /Users/medcl/go/src/infini.sh/new_app framework path: /Users/medcl/go/src/infini.sh/framework fatal: not a git repository (or any of the parent directories): .git update generated info update configs (cd ../framework/ \u0026amp;\u0026amp; make update-plugins) || true # build plugins in framework GOPATH=~/go:~/go/src/infini.sh/framework/../vendor/ CGO_ENABLED=0 GRPC_GO_REQUIRE_HANDSHAKE=off GO15VENDOREXPERIMENT=\u0026#34;1\u0026#34; GO111MODULE=off go build -a -gcflags=all=\u0026#34;-l -B\u0026#34; -ldflags \u0026#39;-static\u0026#39; -ldflags=\u0026#39;-s -w\u0026#39; -gcflags \u0026#34;-m\u0026#34; --work -o /Users/medcl/go/src/infini.sh/new_app/bin/new_app WORK=/var/folders/j5/qd4qt3n55dz053d93q2mswfr0000gn/T/go-build435280758 # infini.sh/new_app ./main.go:17:9: can inline main.deferwrap1 ./main.go:21:12: can inline main.func2 ./main.go:18:22: func literal does not escape ./main.go:19:45: \u0026amp;api.APIModule{} escapes to heap ./main.go:21:12: func literal escapes to heap restore generated info Run the application #  âžœ new_app git:(main) âœ— ./bin/new_app __ _ ___ ___ /\\ \\ \\_____ __/_\\  / _ \\/ _ \\  / \\/ / _ \\ \\ /\\ / //_\\\\ / /_)/ /_)/ / /\\  / __/\\ V V / _ \\/ ___/ ___/ \\_\\ \\/ \\___| \\_/\\_/\\_/ \\_/\\/ \\/ [NEW_APP] Make a golang application is such easy~. [NEW_APP] 1.0.0_SNAPSHOT#001, 2024-12-16 06:15:10, 2025-12-31 10:10:10, HEAD [12-16 14:15:19] [INF] [env.go:203] configuration auto reload enabled [12-16 14:15:19] [INF] [env.go:209] watching config: /Users/medcl/go/src/infini.sh/new_app/config [12-16 14:15:19] [INF] [app.go:311] initializing new_app, pid: 64426 [12-16 14:15:19] [INF] [app.go:312] using config: /Users/medcl/go/src/infini.sh/new_app/new_app.yml [12-16 14:15:19] [INF] [api.go:214] local ips: 192.168.3.17 [12-16 14:15:19] [INF] [api.go:312] api server listen at: http://0.0.0.0:2900 [12-16 14:15:19] [INF] [module.go:159] started module: api [12-16 14:15:19] [INF] [module.go:184] all modules are started [12-16 14:15:19] [INF] [instance.go:101] workspace: /Users/medcl/go/src/infini.sh/new_app/data/new_app/nodes/ctfs8hbq50kevmkb3m6g [12-16 14:15:19] [INF] [app.go:537] new_app is up and running now. ^C [NEW_APP] got signal: interrupt, start shutting down [12-16 14:15:23] [INF] [module.go:213] all modules are stopped [12-16 14:15:23] [INF] [app.go:410] new_app now terminated. [NEW_APP] 1.0.0_SNAPSHOT, uptime: 4.13334s\nGoodbye~ Conclusion #\n By leveraging the INFINI Framework, creating a Go application becomes significantly simpler and more efficient. The framework provides built-in commands and modules, streamlining the development process and enabling you to focus on building your application\u0026rsquo;s core functionality.\n","subcategory":null,"summary":"","tags":null,"title":"Create New Application","url":"/framework/v1.4.0/docs/development/create_new_application/"},{"category":null,"content":"Setup IntelliJ IDEA #  This guide provides step-by-step instructions to configure IntelliJ IDEA for Go development, ensuring optimal compatibility with project requirements.\n Configure GOPATH #  Set the GOPATH for your project in IntelliJ IDEA:\nNavigate to: Preferences | Languages \u0026amp; Frameworks | Go | GOPATH\n Adjust Run/Debug Configurations #  For projects that rely on legacy dependency management (e.g., the vendor folder), configure the necessary environment variables:\nGO15VENDOREXPERIMENT=\u0026#34;1\u0026#34;; GO111MODULE=off Set these variables in: Preferences | Run/Debug Configurations | Templates\nAdd Copyright Header Templates #  Ensure all new files include the appropriate copyright notice.\nNavigate to: Preferences | Editor | File and Code Templates\nAdd the following header template:\n/* Copyright Â© INFINI LTD. All rights reserved. * Web: https://infinilabs.com * Email: hello#infini.ltd */ Disable Unused Modules (For Higher Versions) #  In newer versions of IntelliJ IDEA, disabling unused modules can improve performance and reduce conflicts.\nTo improve code quality, enable static analysis tools like GoLint or GoVet in IntelliJ IDEA.\nOptimize Performance #  For large projects, increase IntelliJ IDEAâ€™s memory allocation by editing the idea.vmoptions file.\nExample:\n-Xms1024m -Xmx2048m ","subcategory":null,"summary":"","tags":null,"title":"Setup IntelliJ IDEA","url":"/framework/v1.4.0/docs/development/setup_intellij_idea/"},{"category":null,"content":"Setting Up the Golang Environment #  Refer the official guide to install Golang: https://go.dev/doc/install\nGolang Version #  Verify your Go version:\nâžœ loadgen git:(master) âœ— go version go version go1.23.3 darwin/arm64 Directory Setup #  Create the necessary directory structure:\ncd ~/go/src/ mkdir -p infini.sh/  Note: The code must be located under your personal directory at ~/go/src/infini.sh.\nOther locations are not allowedâ€”this is a strict requirement.\n Cloning Dependencies #  Clone the required dependency repositories:\ncd ~/go/src/infini.sh git@github.com:infinilabs/framework.git Cloning Application Code #  For example, to work with the Loadgen project:\ncd ~/go/src/infini.sh git@github.com:infinilabs/loadgen.git Building the Project #  Build the project using the Makefile:\ncd loadgen make The make command will automatically download the required dependency repositories.\nCustomization Build with Built-in Environments #  For example, if you want to expose more debug-level information, such as detecting data races, you can compile a debug build. You may also specify the GOPATH as needed. Use the following command:\nDEV=true GOPATH=\u0026#34;/Users/\u0026lt;Replace_with_your_username\u0026gt;/go\u0026#34; make build To learn more about the Makefile and its commands, refer to this Reference.\n","subcategory":null,"summary":"","tags":null,"title":"Setting Up the Golang Environment","url":"/framework/v1.4.0/docs/development/setup_golang_environment/"}]