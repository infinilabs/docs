<!doctype html><html lang=zh><head><meta name=generator content="Hugo 0.79.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="其它配置 #  高级用法 #  配置模板 #  示例：
configs.template: - name: &#34;es_gw1&#34; path: ./sample-configs/config_template.tpl variable: name: &#34;es_gw1&#34; binding_host: &#34;0.0.0.0:8000&#34; tls_on_entry: true elasticsearch_endpoint: &#34;http://localhost:9200&#34;    名称 类型 说明     configs.template array 配置模板，可以指定多个模板和对应的参数   configs.template[].name string 配置的名称   configs.template[].path string 模板配置路径   configs.template[].variable map 模板的参数设置，变量在模板里面的用法：$[[变量名]]    使用环境变量 #  极限网关支持在配置里面使用环境变量来进行灵活的参数控制。
首先在配置里面定义环境变量的默认值，如下：
env: PROD_ES_ENDPOINT: http://localhost:9200 PROD_ES_USER: elastic PROD_ES_PASS: password 然后就可以在配置里面通过如下语法来使用环境变量了：
elasticsearch: - name: prod enabled: true endpoints: - $[[env."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="其它配置"><meta property="og:description" content="其它配置 #  高级用法 #  配置模板 #  示例：
configs.template: - name: &#34;es_gw1&#34; path: ./sample-configs/config_template.tpl variable: name: &#34;es_gw1&#34; binding_host: &#34;0.0.0.0:8000&#34; tls_on_entry: true elasticsearch_endpoint: &#34;http://localhost:9200&#34;    名称 类型 说明     configs.template array 配置模板，可以指定多个模板和对应的参数   configs.template[].name string 配置的名称   configs.template[].path string 模板配置路径   configs.template[].variable map 模板的参数设置，变量在模板里面的用法：$[[变量名]]    使用环境变量 #  极限网关支持在配置里面使用环境变量来进行灵活的参数控制。
首先在配置里面定义环境变量的默认值，如下：
env: PROD_ES_ENDPOINT: http://localhost:9200 PROD_ES_USER: elastic PROD_ES_PASS: password 然后就可以在配置里面通过如下语法来使用环境变量了：
elasticsearch: - name: prod enabled: true endpoints: - $[[env."><meta property="og:type" content="article"><meta property="og:url" content="/gateway/v1.26.1/zh/docs/references/config/"><title>其它配置 | INFINI Gateway</title><link rel=manifest href=/gateway/v1.26.1/manifest.json><link rel=icon href=/gateway/v1.26.1/favicon.png type=image/x-icon><link rel=alternate hreflang=en href=/gateway/v1.26.1/docs/references/config/ title="Other Configurations"><link rel=stylesheet href=/gateway/v1.26.1/book.min.d80e87b12a4b49d9913d0bdd98bd83b7a44988be784760ba15522b377313dcf9.css integrity="sha256-2A6HsSpLSdmRPQvdmL2Dt6RJiL54R2C6FVIrN3MT3Pk="><script defer src=/gateway/v1.26.1/js/jquery-2.x.min.js></script><script defer src=/gateway/v1.26.1/js/doc.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/gateway/v1.26.1/zh><img src=/gateway/v1.26.1/img/logo-zh.svg alt=Logo></a></h2><div class=heading><select class=version-selector>
<option value>main (latest)</option>
<option value=v1.28.0>v1.28.x</option>
<option value=v1.27.0>v1.27.x</option>
<option value=v1.26.1>v1.26.x</option></select></div><ul><li><a href=/gateway/v1.26.1/zh/docs/overview/>产品概述</a><ul></ul></li><li><input type=checkbox id=section-f1b7c1b2e5dd43526e77637c475d35b8 class=toggle>
<label for=section-f1b7c1b2e5dd43526e77637c475d35b8 class="flex justify-between"><a>入门指南</a>
<span>▾</span></label><ul><li><a href=/gateway/v1.26.1/zh/docs/getting-started/install/>安装网关</a></li><li><a href=/gateway/v1.26.1/zh/docs/getting-started/configuration/>配置网关</a></li><li><a href=/gateway/v1.26.1/zh/docs/getting-started/docker/>容器部署</a></li><li><a href=/gateway/v1.26.1/zh/docs/getting-started/helm/>Helm 部署</a></li><li><a href=/gateway/v1.26.1/zh/docs/getting-started/optimization/>系统调优</a></li><li><a href=/gateway/v1.26.1/zh/docs/getting-started/benchmark/>性能测试</a></li></ul></li><li><input type=checkbox id=section-fb088f8a9be33f7f260ad2b140bb7bdc class=toggle checked>
<label for=section-fb088f8a9be33f7f260ad2b140bb7bdc class="flex justify-between"><a>功能手册</a>
<span>▾</span></label><ul><li><a href=/gateway/v1.26.1/zh/docs/references/entry/>服务入口</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/router/>服务路由</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/flow/>处理流程</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/elasticsearch/>Elasticsearch</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/context/>请求上下文</a></li><li><input type=checkbox id=section-a53d1bd91095fa28aef70cee327a5121 class=toggle>
<label for=section-a53d1bd91095fa28aef70cee327a5121 class="flex justify-between"><a href=/gateway/v1.26.1/zh/docs/references/filters/>在线过滤器</a>
<span>▾</span></label><ul><li><a href=/gateway/v1.26.1/zh/docs/references/filters/echo/>echo</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/auto_generate_doc_id/>auto_generate_doc_id</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/basic_auth/>basic_auth</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/bulk_request_mutate/>bulk_request_mutate</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/bulk_request_throttle/>bulk_request_throttle</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/bulk_reshuffle/>bulk_reshuffle</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/bulk_response_process/>bulk_response_process</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/cache/>cache</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/clone/>clone</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/context_filter/>context_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/context_limiter/>context_limiter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/context_parse/>context_parse</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/context_regex_replace/>context_regex_replace</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/context_switch/>context_switch</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/date_range_precision_tuning/>date_range_precision_tuning</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/drop/>drop</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/dump/>dump</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/elasticsearch/>elasticsearch</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/elasticsearch_health_check/>elasticsearch_health_check</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/flow/>flow</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/hash_mod/>hash_mod</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/http/>http</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/javascript/>javascript</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/ldap_auth/>ldap_auth</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/logging/>logging</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/queue/>queue</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/ratio/>ratio</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/record/>record</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/redirect/>redirect</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/redis_pubsub/>redis_pubsub</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_api_key_filter/>request_api_key_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_api_key_limiter/>request_api_key_limiter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_body_json_del/>request_body_json_del</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_body_json_set/>request_body_json_set</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_body_regex_replace/>request_body_regex_replace</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_client_ip_filter/>request_client_ip_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_client_ip_limiter/>request_client_ip_limiter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_header_filter/>request_header_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_host_filter/>request_host_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_host_limiter/>request_host_limiter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_method_filter/>request_method_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_path_filter/>request_path_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_path_limiter/>request_path_limiter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_reshuffle/>request_reshuffle</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_user_filter/>request_user_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/request_user_limiter/>request_user_limiter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/response_body_regex_replace/>response_body_regex_replace</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/response_header_filter/>response_header_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/response_header_format/>response_header_format</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/response_status_filter/>response_status_filter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/retry_limiter/>retry_limiter</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/rewrite_to_bulk/>rewrite_to_bulk</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/sample/>sample</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/security/>security</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/set_basic_auth/>set_basic_auth</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/set_context/>set_context</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/set_hostname/>set_hostname</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/set_request_header/>set_request_header</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/set_request_query_args/>set_request_query_args</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/set_response/>set_response</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/set_response_header/>set_response_header</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/sleep/>sleep</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/switch/>switch</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/filters/translog/>translog</a></li></ul></li><li><input type=checkbox id=section-82db29a871579194764c352cfff582f2 class=toggle>
<label for=section-82db29a871579194764c352cfff582f2 class="flex justify-between"><a href=/gateway/v1.26.1/zh/docs/references/processors/>离线处理器</a>
<span>▾</span></label><ul><li><a href=/gateway/v1.26.1/zh/docs/references/processors/bulk_indexing/>bulk_indexing</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/consumer/>consumer</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/dag/>dag</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/dump_hash/>dump_hash</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/flow_replay/>flow_replay</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/flow_runner/>flow_runner</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/index_diff/>index_diff</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/indexing_merge/>indexing_merge</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/json_indexing/>json_indexing</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/merge_to_bulk/>merge_to_bulk</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/queue_consumer/>queue_consumer</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/replay/>replay</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/processors/smtp/>smtp</a></li></ul></li><li><input type=checkbox id=section-3de6688eceb9f20db2f0270adccf76e2 class=toggle>
<label for=section-3de6688eceb9f20db2f0270adccf76e2 class="flex justify-between"><a>功能组件</a>
<span>▾</span></label><ul><li><a href=/gateway/v1.26.1/zh/docs/references/modules/floating_ip/>浮动 IP</a></li><li><a href=/gateway/v1.26.1/zh/docs/references/modules/force_merge/>索引段合并</a></li></ul></li><li><a href=/gateway/v1.26.1/zh/docs/references/config/ class=active>其它配置</a></li></ul></li><li><input type=checkbox id=section-391bcaab6cc03bd87e3373752bfd390e class=toggle>
<label for=section-391bcaab6cc03bd87e3373752bfd390e class="flex justify-between"><a>动手教程</a>
<span>▾</span></label><ul><li><a href=/gateway/v1.26.1/zh/docs/tutorial/log4j2_filtering/>Apache Log4j 漏洞处置</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/online_query_rewrite/>在线查询修复的实现</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/request-logging/>查询请求流量日志分析</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/index_diff/>索引文档级别差异对比</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/es-hadoop_integration/>与 Elasticsearch-Hadoop 集成</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/prometheus_integration/>与 Prometheus 集成</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/proxy_elasticsearch/>为 Elasticsearch 无缝添加代理和基础安全</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/proxy_kibana/>为 Kibana 添加代理和基础安全</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/path_rewrite_by_javascript/>使用 JavaScript 脚本来进行复杂的查询改写</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/fix_count_in_search_response/>兼容不同版本的响应 Count 结构</a></li><li><a href=/gateway/v1.26.1/zh/docs/tutorial/routing_to_cluser_by_index/>在 Kibana 里统一访问来自不同集群的索引</a></li></ul></li><li><input type=checkbox id=section-7e4e95606453deb85437b78d9c3f2d72 class=toggle>
<label for=section-7e4e95606453deb85437b78d9c3f2d72 class="flex justify-between"><a href=/gateway/v1.26.1/zh/docs/user-cases/>用户案例</a>
<span>▾</span></label><ul><li><a href=/gateway/v1.26.1/zh/docs/user-cases/stories/a_cross_region_cluster_access_locality/>作业帮跨云集群的就近本地访问</a></li><li><a href=/gateway/v1.26.1/zh/docs/user-cases/stories/indexing_speedup_for_big_index_rebuild/>某保险业务索引速度百倍提升</a></li></ul></li><li><a href=/gateway/v1.26.1/zh/docs/troubleshooting/>常见问题</a><ul></ul></li><li><a href=/gateway/v1.26.1/zh/docs/release-notes/>版本历史</a><ul></ul></li><li><a href=/gateway/v1.26.1/zh/docs/resources/>其它资源</a><ul></ul></li></ul><ul><li><a href=https://github.com/infinilabs/gateway target=_blank rel=noopener>Github</a></li></ul><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/gateway/v1.26.1/svg/translate.svg class=book-icon alt=Languages>
简体中文</li></ul><ul class=book-languages-list><li><a href=/gateway/v1.26.1/docs/references/config/ class="flex align-center"><img src=/gateway/v1.26.1/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li class=active><a href=/gateway/v1.26.1/zh/ class="flex align-center"><img src=/gateway/v1.26.1/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/gateway/v1.26.1/svg/menu.svg class=book-icon alt=Menu></label>
<strong>其它配置</strong>
<label for=toc-control><img src=/gateway/v1.26.1/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#其它配置>其它配置</a><ul><li><a href=#高级用法>高级用法</a><ul><li><a href=#配置模板>配置模板</a></li><li><a href=#使用环境变量>使用环境变量</a></li></ul></li><li><a href=#path>Path</a></li><li><a href=#log>Log</a></li><li><a href=#configs>Configs</a></li><li><a href=#本地磁盘队列>本地磁盘队列</a></li><li><a href=#s3>S3</a></li><li><a href=#kafka>Kafka</a></li><li><a href=#badger>Badger</a></li><li><a href=#资源限制>资源限制</a></li><li><a href=#网络配置>网络配置</a></li><li><a href=#tls-配置>TLS 配置</a></li><li><a href=#api>API</a></li><li><a href=#metrics>Metrics</a></li><li><a href=#node>Node</a></li><li><a href=#其它配置-1>其它配置</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=其它配置>其它配置
<a class=anchor href=#%e5%85%b6%e5%ae%83%e9%85%8d%e7%bd%ae>#</a></h1><h2 id=高级用法>高级用法
<a class=anchor href=#%e9%ab%98%e7%ba%a7%e7%94%a8%e6%b3%95>#</a></h2><h3 id=配置模板>配置模板
<a class=anchor href=#%e9%85%8d%e7%bd%ae%e6%a8%a1%e6%9d%bf>#</a></h3><p>示例：</p><pre><code>configs.template:
  - name: &quot;es_gw1&quot;
    path: ./sample-configs/config_template.tpl
    variable:
      name: &quot;es_gw1&quot;
      binding_host: &quot;0.0.0.0:8000&quot;
      tls_on_entry: true
      elasticsearch_endpoint: &quot;http://localhost:9200&quot;
</code></pre><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>configs.template</td><td>array</td><td>配置模板，可以指定多个模板和对应的参数</td></tr><tr><td>configs.template[].name</td><td>string</td><td>配置的名称</td></tr><tr><td>configs.template[].path</td><td>string</td><td>模板配置路径</td></tr><tr><td>configs.template[].variable</td><td>map</td><td>模板的参数设置，变量在模板里面的用法：<code>$[[变量名]]</code></td></tr></tbody></table><h3 id=使用环境变量>使用环境变量
<a class=anchor href=#%e4%bd%bf%e7%94%a8%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f>#</a></h3><p>极限网关支持在配置里面使用环境变量来进行灵活的参数控制。</p><p>首先在配置里面定义环境变量的默认值，如下：</p><pre><code>env:
  PROD_ES_ENDPOINT: http://localhost:9200
  PROD_ES_USER: elastic
  PROD_ES_PASS: password
</code></pre><p>然后就可以在配置里面通过如下语法来使用环境变量了：</p><pre><code>elasticsearch:
  - name: prod
    enabled: true
    endpoints:
      - $[[env.PROD_ES_ENDPOINT]]
    discovery:
      enabled: false
    basic_auth:
      username: $[[env.PROD_ES_USER]]
      password: $[[env.PROD_ES_PASS]]
</code></pre><p>注意，外部环境变量的优先级会大于配置内部的环境变量设置，比如希望在启动程序的时候覆盖环境变量，操作如下：</p><pre><code>PROD_ES_ENDPOINT=http://1.1.1.1:9200 LOGGING_ES_ENDPOINT=http://2.2.2.2:9201  ./bin/gateway
</code></pre><h2 id=path>Path
<a class=anchor href=#path>#</a></h2><p>配置、数据、日志相关路径配置。</p><p>示例：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>path.data</span>: <span style=color:#ae81ff>data</span>
<span style=color:#f92672>path.logs</span>: <span style=color:#ae81ff>log</span>
<span style=color:#f92672>path.configs</span>: <span style=color:#e6db74>&#34;config&#34;</span>
</code></pre></div><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>path.data</td><td>string</td><td>数据目录，默认为 <code>data</code></td></tr><tr><td>path.logs</td><td>string</td><td>日志目录，默认为 <code>log</code></td></tr><tr><td>path.configs</td><td>string</td><td>配置目录，默认为 <code>config</code></td></tr></tbody></table><h2 id=log>Log
<a class=anchor href=#log>#</a></h2><p>日志相关配置。</p><p>示例：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>log</span>:
  <span style=color:#f92672>level</span>: <span style=color:#ae81ff>info</span>
  <span style=color:#f92672>debug</span>: <span style=color:#66d9ef>false</span>
</code></pre></div><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>log.level</td><td>string</td><td>日志级别，默认为 <code>info</code></td></tr><tr><td>log.debug</td><td>bool</td><td>是否开启调试模式，当开启的时候，一旦出现异常程序直接退出，打印完整堆栈，仅用于调试定位故障点，默认为 <code>false</code>，生产环境不要开启，可能丢数据</td></tr><tr><td>log.format</td><td>bool</td><td>日志格式，默认为 <code>[%Date(01-02) %Time] [%LEV] [%File:%Line] %Msg%n</code>，
<a href=https://github.com/cihub/seelog/wiki/Format-reference>Format References</a></td></tr><tr><td>log.disable_file_output</td><td>bool</td><td>是否关闭本地文件的日志输出，默认为 <code>false</code>，容器环境不希望本地日志输出的可以开启本参数</td></tr></tbody></table><h2 id=configs>Configs
<a class=anchor href=#configs>#</a></h2><p>配置管理相关配置。</p><p>示例：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>configs</span>:
  <span style=color:#f92672>auto_reload</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#f92672>managed</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#f92672>panic_on_config_error</span>: <span style=color:#66d9ef>false</span> 
  <span style=color:#f92672>interval</span>: <span style=color:#e6db74>&#34;1s&#34;</span>
  <span style=color:#f92672>servers</span>:
    - <span style=color:#e6db74>&#34;http://localhost:9000&#34;</span>
  <span style=color:#f92672>max_backup_files</span>: <span style=color:#ae81ff>5</span>
  <span style=color:#f92672>soft_delete</span>: <span style=color:#66d9ef>false</span>
  <span style=color:#f92672>tls</span>:
    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
    <span style=color:#f92672>cert_file</span>: <span style=color:#ae81ff>/etc/ssl.crt</span>
    <span style=color:#f92672>key_file</span>: <span style=color:#ae81ff>/etc/ssl.key</span>
    <span style=color:#f92672>skip_insecure_verify</span>: <span style=color:#66d9ef>false</span>
</code></pre></div><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>configs.auto_reload</td><td>bool</td><td>是否支持 <code>path.configs</code> 里面配置的动态加载</td></tr><tr><td>configs.managed</td><td>bool</td><td>是否支持由配置中心进行配置管理</td></tr><tr><td>configs.servers</td><td>[]string</td><td>配置中心地址</td></tr><tr><td>configs.interval</td><td>string</td><td>配置同步间隔</td></tr><tr><td>configs.soft_delete</td><td>bool</td><td>配置文件删除为软删除，默认 <code>true</code></td></tr><tr><td>configs.panic_on_config_error</td><td>bool</td><td>配置加载如果有错误就直接崩溃，默认 <code>true</code></td></tr><tr><td>configs.max_backup_files</td><td>int</td><td>配置文件最大备份数，默认 <code>10</code></td></tr><tr><td>configs.valid_config_extensions</td><td>[]string</td><td>有效的配置文件后缀，默认 <code>.tpl</code>, <code>.json</code>, <code>.yml</code>, <code>.yaml</code></td></tr><tr><td>configs.tls</td><td>object</td><td>TLS 配置（请参考通用
<a href=/gateway/v1.26.1/zh/#tls-%e9%85%8d%e7%bd%ae>TLS</a> 配置）</td></tr><tr><td>configs.always_register_after_restart</td><td>bool</td><td>实例重启后是否进行注册，实例运行在 K8S 环境下，需开启此参数。</td></tr><tr><td>configs.allow_generated_metrics_tasks</td><td>bool</td><td>允许自动生成采集指标任务</td></tr><tr><td>configs.ignored_path</td><td>[]string</td><td>需要忽略的配置文件路径</td></tr></tbody></table><h2 id=本地磁盘队列>本地磁盘队列
<a class=anchor href=#%e6%9c%ac%e5%9c%b0%e7%a3%81%e7%9b%98%e9%98%9f%e5%88%97>#</a></h2><p>示例：</p><pre><code>disk_queue:
  upload_to_s3: true
  s3:
    server: my_blob_store
    location: cn-beijing-001
    bucket: infini-store
  max_bytes_per_file: 102400
</code></pre><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>disk_queue.min_msg_size</td><td>int</td><td>发送到队列单条消息的最小字节限制，默认 <code>1</code></td></tr><tr><td>disk_queue.max_msg_size</td><td>int</td><td>发送到队列单条消息的最大字节限制，默认 <code>104857600</code>，即 100MB</td></tr><tr><td>disk_queue.sync_every_records</td><td>int</td><td>每隔多少条记录进行一次 sync 磁盘同步操作，默认 <code>1000</code></td></tr><tr><td>disk_queue.sync_timeout_in_ms</td><td>int</td><td>每隔多长时间进行一次 sync 磁盘同步操作，默认 <code>1000</code> 毫秒</td></tr><tr><td>disk_queue.max_bytes_per_file</td><td>int</td><td>本地磁盘队列单个文件的最大值，超过此大小自动滚动新文件，默认 <code>104857600</code>，即 100MB</td></tr><tr><td>disk_queue.max_used_bytes</td><td>int</td><td>本地磁盘队列可允许的最大存储使用空间大小</td></tr><tr><td>disk_queue.warning_free_bytes</td><td>int</td><td>磁盘达到告警阈值的空闲存储空间大小，默认 <code>10737418240</code> 即 10GB</td></tr><tr><td>disk_queue.reserved_free_bytes</td><td>int</td><td>磁盘空闲存储空间大小的保护值，达到会变成只读，不允许写，默认 <code>5368709120</code> 即 5GB</td></tr><tr><td>disk_queue.auto_skip_corrupted_file</td><td>bool</td><td>是否自动跳过损坏的磁盘文件，默认 <code>true</code></td></tr><tr><td>disk_queue.upload_to_s3</td><td>bool</td><td>是否将磁盘队列文件上传到 S3，默认 <code>false</code></td></tr><tr><td>disk_queue.s3.async</td><td>bool</td><td>是否异步上传到 S3 服务器</td></tr><tr><td>disk_queue.s3.server</td><td>string</td><td>S3 服务器 ID</td></tr><tr><td>disk_queue.s3.location</td><td>string</td><td>S3 服务器位置</td></tr><tr><td>disk_queue.s3.bucket</td><td>string</td><td>S3 服务器 Bucket</td></tr><tr><td>disk_queue.retention.max_num_of_local_files</td><td>int</td><td>上传 s3 完的文件，按照最新的文件排序，保留在本地磁盘上的最大文件数，默认 <code>3</code></td></tr><tr><td>disk_queue.compress.segment.enabled</td><td>bool</td><td>是否开启文件级别的压缩，默认 <code>false</code></td></tr></tbody></table><h2 id=s3>S3
<a class=anchor href=#s3>#</a></h2><p>示例：</p><pre><code>s3:
  my_blob_store:
    endpoint: &quot;192.168.3.188:9000&quot;
    access_key: &quot;admin&quot;
    access_secret: &quot;gogoaminio&quot;
</code></pre><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>s3.[id].endpoint</td><td>string</td><td>S3 服务器地址</td></tr><tr><td>s3.[id].access_key</td><td>string</td><td>S3 服务器 Key</td></tr><tr><td>s3.[id].access_secret</td><td>string</td><td>S3 服务器秘钥</td></tr><tr><td>s3.[id].token</td><td>string</td><td>S3 服务器 Token 信息</td></tr><tr><td>s3.[id].ssl</td><td>bool</td><td>S3 服务器是否开启了 TLS</td></tr><tr><td>s3.[id].skip_insecure_verify</td><td>bool</td><td>是否忽略 TLS 证书校验</td></tr></tbody></table><h2 id=kafka>Kafka
<a class=anchor href=#kafka>#</a></h2><p>极限网关支持在使用分布式 Kafka 作为后端队列，相关参数如下。</p><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>kafka.enabled</td><td>bool</td><td>Kafka 模块是否开启</td></tr><tr><td>kafka.default</td><td>bool</td><td>Kafka 模块是否作为默认 Queue 的实现</td></tr><tr><td>kafka.num_of_partition</td><td>int</td><td>默认的分区数量，默认 <code>1</code></td></tr><tr><td>kafka.num_of_replica</td><td>int</td><td>默认的分区副本数量，默认 <code>1</code></td></tr><tr><td>kafka.producer_batch_max_bytes</td><td>int</td><td>最大提交请求大小，默认 <code>50 * 1024 * 1024</code></td></tr><tr><td>kafka.max_buffered_records</td><td>int</td><td>最大缓存请求记录数，默认 <code>10000</code></td></tr><tr><td>kafka.manual_flushing</td><td>bool</td><td>是否手动 flushing，默认 <code>false</code></td></tr><tr><td>kafka.brokers</td><td>[]string</td><td>服务器地址信息</td></tr><tr><td>kafka.username</td><td>string</td><td>用户信息</td></tr><tr><td>kafka.password</td><td>string</td><td>密码信息</td></tr></tbody></table><h2 id=badger>Badger
<a class=anchor href=#badger>#</a></h2><p>Badger 是一个轻量级的基于磁盘的 KeyValue 存储引擎，极限网关使用 Badger 来实现 KV 模块的存储。</p><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>badger.enabled</td><td>bool</td><td>是否启用 Badger实现的 KV 模块，默认为 <code>true</code></td></tr><tr><td>badger.single_bucket_mode</td><td>bool</td><td>Badger 模块使用单桶模式，默认为 <code>true</code></td></tr><tr><td>badger.sync_writes</td><td>bool</td><td>Badger 模块使用同步写，默认为 <code>false</code></td></tr><tr><td>badger.mem_table_size</td><td>int64</td><td>Badger 模块的内存表大小，默认为 <code>10 * 1024 * 1024</code>，即 <code>10485760</code></td></tr><tr><td>badger.value_log_file_size</td><td>int64</td><td>Badger 模块的日志文件大小，默认为 <code>1&lt;&lt;30 - 1</code>，即 1g</td></tr><tr><td>badger.value_log_max_entries</td><td>int64</td><td>Badger 模块的日志消息个数，默认为 <code>1000000</code>，即 1million</td></tr><tr><td>badger.value_threshold</td><td>int64</td><td>Badger 模块的值大小阈值，默认为 <code>1048576</code>，即 1m</td></tr><tr><td>badger.num_mem_tables</td><td>int64</td><td>Badger 模块的内存表个数，默认为 <code>1</code></td></tr><tr><td>badger.num_level0_tables</td><td>int64</td><td>Badger 模块的 Level0 内存表个数，默认为 <code>1</code></td></tr></tbody></table><h2 id=资源限制>资源限制
<a class=anchor href=#%e8%b5%84%e6%ba%90%e9%99%90%e5%88%b6>#</a></h2><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>resource_limit.cpu.max_num_of_cpus</td><td>int</td><td>允许使用的最大 CPU 核数，仅用于 Linux 操作系统，且 <code>taskset</code> 命令可用</td></tr><tr><td>resource_limit.cpu.affinity_list</td><td>string</td><td>允许使用的 CPU 绑定设置，eg: <code>0,2,5</code> 或 <code>0-8</code>，仅用于 Linux 操作系统，且 <code>taskset</code> 命令可用</td></tr><tr><td>resource_limit.memory.max_in_bytes</td><td>string</td><td>允许使用的内存的最大大小，软性限制</td></tr></tbody></table><h2 id=网络配置>网络配置
<a class=anchor href=#%e7%bd%91%e7%bb%9c%e9%85%8d%e7%bd%ae>#</a></h2><p>公共的网络配置说明。</p><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>*.network.host</td><td>string</td><td>服务监听的网络地址，例如，<code>192.168.3.10</code></td></tr><tr><td>*.network.port</td><td>int</td><td>服务监听的端口地址，例如，<code>8000</code></td></tr><tr><td>*.network.binding</td><td>string</td><td>服务监听的网络绑定地址，例如，<code>0.0.0.0:8000</code></td></tr><tr><td>*.network.publish</td><td>string</td><td>服务监听的外部访问地址，例如，<code>192.168.3.10:8000</code></td></tr><tr><td>*.network.reuse_port</td><td>bool</td><td>是否在多进程端口共享中重用网络端口</td></tr><tr><td>*.network.skip_occupied_port</td><td>bool</td><td>是否自动跳过已占用的端口</td></tr></tbody></table><h2 id=tls-配置>TLS 配置
<a class=anchor href=#tls-%e9%85%8d%e7%bd%ae>#</a></h2><p>公共的 TLS 配置说明。</p><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>*.tls.enabled</td><td>bool</td><td>是否启用 TLS 安全传输，不指定证书可自动生成</td></tr><tr><td>*.tls.ca_file</td><td>string</td><td>TLS 安全证书的公共 CA 证书路径</td></tr><tr><td>*.tls.cert_file</td><td>string</td><td>TLS 安全证书的公共密钥路径</td></tr><tr><td>*.tls.key_file</td><td>string</td><td>TLS 安全证书的私钥路径</td></tr><tr><td>*.tls.skip_insecure_verify</td><td>bool</td><td>是否忽略 TLS 证书验证</td></tr><tr><td>*.tls.default_domain</td><td>string</td><td>用于自动生成证书的默认域名</td></tr><tr><td>*.tls.skip_domain_verify</td><td>bool</td><td>是否跳过域名验证</td></tr><tr><td>*.tls.client_session_cache_size</td><td>int</td><td>设置 TLS 会话恢复的最大客户端会话状态缓存大小</td></tr></tbody></table><h2 id=api>API
<a class=anchor href=#api>#</a></h2><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>api.enabled</td><td>bool</td><td>是否启用 API 模块， 默认为 <code>true</code></td></tr><tr><td>api.network</td><td>object</td><td>网络配置，请参考通用网络配置部分</td></tr><tr><td>api.tls</td><td>object</td><td>TLS 配置，请参考通用 TLS 配置部分</td></tr><tr><td>api.security</td><td>object</td><td>API 模块的安全配置</td></tr><tr><td>api.security.enabled</td><td>bool</td><td>是否启用安全性</td></tr><tr><td>api.security.username</td><td>string</td><td>安全性的用户名</td></tr><tr><td>api.security.password</td><td>string</td><td>安全性的密码</td></tr><tr><td>api.cors.allowed_origins</td><td>[]string</td><td>跨域请求可以执行的源列表</td></tr><tr><td>api.websocket</td><td>object</td><td>API 模块的 WebSocket 配置</td></tr><tr><td>api.websocket.enabled</td><td>object</td><td>是否启用 WebSocket</td></tr><tr><td>api.websocket.permitted_hosts</td><td>[]string</td><td>允许访问 WebSocket 服务的主机列表</td></tr><tr><td>api.websocket.skip_host_verify</td><td>bool</td><td>是否跳过验证 WebSocket 的主机</td></tr></tbody></table><h2 id=metrics>Metrics
<a class=anchor href=#metrics>#</a></h2><p>配置系统指标采集。</p><p>示例：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>metrics</span>:
  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#f92672>queue</span>: <span style=color:#ae81ff>metrics</span>
  <span style=color:#f92672>network</span>:
    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
    <span style=color:#f92672>summary</span>: <span style=color:#66d9ef>true</span>
    <span style=color:#f92672>details</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#f92672>memory</span>:
    <span style=color:#f92672>metrics</span>:
      - <span style=color:#ae81ff>swap</span>
      - <span style=color:#ae81ff>memory</span>
  <span style=color:#f92672>disk</span>:
    <span style=color:#f92672>metrics</span>:
      - <span style=color:#ae81ff>iops</span>
      - <span style=color:#ae81ff>usage</span>
  <span style=color:#f92672>cpu</span>:
    <span style=color:#f92672>metrics</span>:
      - <span style=color:#ae81ff>idle</span>
      - <span style=color:#ae81ff>system</span>
      - <span style=color:#ae81ff>user</span>
      - <span style=color:#ae81ff>iowait</span>
      - <span style=color:#ae81ff>load</span>
</code></pre></div><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>enabled</td><td>bool</td><td>是否开启系统指标采集，默认 <code>true</code></td></tr><tr><td>queue</td><td>string</td><td>指标采集队列</td></tr><tr><td>network</td><td>object</td><td>采集网络指标配置</td></tr><tr><td>network.enabled</td><td>bool</td><td>是否采集网络指标，默认 <code>true</code></td></tr><tr><td>network.summary</td><td>bool</td><td>是否采集 summary 指标</td></tr><tr><td>network.sockets</td><td>bool</td><td>是否采集相关 socket 指标</td></tr><tr><td>network.throughput</td><td>bool</td><td>是否采集 throughput 指标</td></tr><tr><td>network.details</td><td>bool</td><td>是否将网络 IO 指标进行累计</td></tr><tr><td>network.interfaces</td><td>[]string</td><td>指定需要采集的网络接口，默认采集所有接口</td></tr><tr><td>memory</td><td>object</td><td>采集内存指标配置</td></tr><tr><td>memory.enabled</td><td>bool</td><td>是否开启内存指标的采集，默认 <code>true</code></td></tr><tr><td>memory.metrics</td><td>[]string</td><td>指定采集相关指标，可选 <code>swap</code>，<code>memory</code></td></tr><tr><td>disk</td><td>object</td><td>采集磁盘指标配置</td></tr><tr><td>disk.metrics</td><td>[]string</td><td>指定采集相关指标，可选 <code>usage</code>，<code>iops</code></td></tr><tr><td>cpu</td><td>object</td><td>采集 CPU 指标配置</td></tr><tr><td>cpu.metrics</td><td>[]string</td><td>指定采集相关指标，可选 <code>idle</code>，<code>system</code>，<code>user</code>，<code>iowait</code>，<code>load</code></td></tr></tbody></table><h2 id=node>Node
<a class=anchor href=#node>#</a></h2><p>节点相关配置。</p><p>示例：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>node:
  major_ip_pattern: &#34;.*&#34;
  labels:
    env: dev
  tags:
    - linux
    - x86
    - es7
</code></pre></div><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>major_ip_pattern</td><td>string</td><td>如果主机上有多个 IP，用 pattern 来控制以哪个 IP 为主，当注册时用于上报。</td></tr><tr><td>labels</td><td>map</td><td>自定义标签</td></tr><tr><td>tags</td><td>[]string</td><td>自定义标签</td></tr></tbody></table><h2 id=其它配置-1>其它配置
<a class=anchor href=#%e5%85%b6%e5%ae%83%e9%85%8d%e7%bd%ae-1>#</a></h2><table><thead><tr><th>名称</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>preference.pipeline_enabled_by_default</td><td>map</td><td>Pipeline 是否默认启动，如果改成 <code>false</code>，则需要每个 Pipeline 配置显式设置 <code>enabled</code> 为 <code>true</code></td></tr><tr><td>allow_multi_instance</td><td>bool</td><td>是否允许同一程序启动多个实例，默认为 <code>false</code></td></tr><tr><td>skip_instance_detect</td><td>bool</td><td>是否跳过实例检测，默认为 <code>false</code></td></tr><tr><td>max_num_of_instances</td><td>int</td><td>同一程序可同时运行的实例的最大个数，默认为 <code>5</code></td></tr></tbody></table></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/gateway/v1.26.1/svg/translate.svg class=book-icon alt=Languages>
简体中文</li></ul><ul class=book-languages-list><li><a href=/gateway/v1.26.1/docs/references/config/ class="flex align-center"><img src=/gateway/v1.26.1/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li class=active><a href=/gateway/v1.26.1/zh/ class="flex align-center"><img src=/gateway/v1.26.1/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div><div><a class="flex align-center" href=https://github.com/infinilabs/gateway/edit/v1.26.1/docs/content.zh/docs/references/config.md target=_blank rel=noopener><img src=/gateway/v1.26.1/svg/edit.svg class=book-icon alt=Edit>
<span>编辑本页</span></a></div><div class="flex align-center footer">©INFINI.LTD, All Rights Reserved.</div><script>(function(h,o,t,j,a,r){h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};h._hjSettings={hjid:2567416,hjsv:6};a=o.getElementsByTagName('head')[0];r=o.createElement('script');r.async=1;r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;a.appendChild(r);})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RJPTVP614C"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-RJPTVP614C');</script><script type=text/javascript>var _smartsupp=_smartsupp||{};_smartsupp.key='691ff544d18a237005a011a7290b839d8fe811a4';window.smartsupp||(function(d){var s,c,o=smartsupp=function(){o._.push(arguments)};o._=[];s=d.getElementsByTagName('script')[0];c=d.createElement('script');c.type='text/javascript';c.charset='utf-8';c.async=true;c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);})(document);</script></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#其它配置>其它配置</a><ul><li><a href=#高级用法>高级用法</a><ul><li><a href=#配置模板>配置模板</a></li><li><a href=#使用环境变量>使用环境变量</a></li></ul></li><li><a href=#path>Path</a></li><li><a href=#log>Log</a></li><li><a href=#configs>Configs</a></li><li><a href=#本地磁盘队列>本地磁盘队列</a></li><li><a href=#s3>S3</a></li><li><a href=#kafka>Kafka</a></li><li><a href=#badger>Badger</a></li><li><a href=#资源限制>资源限制</a></li><li><a href=#网络配置>网络配置</a></li><li><a href=#tls-配置>TLS 配置</a></li><li><a href=#api>API</a></li><li><a href=#metrics>Metrics</a></li><li><a href=#node>Node</a></li><li><a href=#其它配置-1>其它配置</a></li></ul></li></ul></nav></aside></main></body></html>