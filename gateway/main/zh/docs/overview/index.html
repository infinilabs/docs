<!doctype html><html lang=zh><head><meta name=generator content="Hugo 0.79.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="概述 #  介绍 #  极限网关（INFINI Gateway）是一个面向 Elasticsearch 的高性能应用网关，它包含丰富的特性，使用起来也非常简单。极限网关工作的方式和普通的反向代理一样，我们一般是将网关部署在 Elasticsearch 集群前面， 将以往直接发送给 Elasticsearch 的请求都发送给网关，再由网关转发给请求到后端的 Elasticsearch 集群。因为网关位于在用户端和后端 Elasticsearch 之间，所以网关在中间可以做非常多的事情， 比如可以实现索引级别的限速限流、常见查询的缓存加速、查询请求的审计、查询结果的动态修改等等。
特性 #  极限网关 最懂 Elasticsearch，其在设计的时候就综合考虑了很多和 Elasticsearch 相关的业务场景及特点，基于此打造了很多完美契合 Elasticsearch 的众多非常实用的功能。
轻量级 极限网关使用 Golang 编写，安装包很小，只有 10MB 左右，没有任何外部环境依赖，部署安装都非常简单，只需要下载对应平台的二进制可执行文件，启动网关程序的二进制程序文件执行即可。  极致性能 极限网关在编写每一行代码的时候，都会考虑如何让其运行在最佳状态，经测试，极限网关比同类主流网关类产品速度快 25% 以上，且针对 Elasticsearch 做了非常细致的优化，能成倍提升写入和查询的速度。   跨版本支持 极限网关针对不同的 Elasticsearch 版本做了兼容和针对性处理，能够让业务代码无缝的进行适配，后端 Elasticsearch 集群版本升级能够做到无缝过渡，降低版本升级和数据迁移的复杂度。  可观测性 极限网关可以动态对 Elasticsearch 运行过程中产生的任何请求进行截获和分析，通过指标和日志来了解整个集群的运行情况，用于提升性能和优化业务。还可以用于审计和慢查询分析。   高可用 极限网关内置多种高可用解决方案，前端请求入口支持基于虚拟 IP 的双机热备，后端集群支持集群拓扑的自动感知，节点上下线能自动发现，自动处理后端故障，自动进行请求的重试和迁移。  灵活可扩展 极限网关的每个模块都可以独立扩展，可灵活对每个请求进行干预和路由，支持路由的智能学习，内置丰富的过滤器，通过配置动态修改每个请求的处理逻辑，也支持通过插件来进行扩展。   无缝集成 #  极限网关对外提供的接口完全兼容 Elasticsearch 原生的接口，集成起来非常简单，只需将原本指向 Elasticsearch 的配置修改成网关的地址即可。"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="产品概述"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="/gateway/main/zh/docs/overview/"><title>产品概述 | INFINI Gateway</title><link rel=manifest href=/gateway/main/manifest.json><link rel=icon href=/gateway/main/favicon.png type=image/x-icon><link rel=alternate hreflang=en href=/gateway/main/docs/overview/ title=Overview><link rel=stylesheet href=/gateway/main/book.min.d80e87b12a4b49d9913d0bdd98bd83b7a44988be784760ba15522b377313dcf9.css integrity="sha256-2A6HsSpLSdmRPQvdmL2Dt6RJiL54R2C6FVIrN3MT3Pk="><link rel=alternate type=application/rss+xml href=/gateway/main/zh/docs/overview/index.xml title="INFINI Gateway"><script defer src=/gateway/main/js/jquery-2.x.min.js></script><script defer src=/gateway/main/js/doc.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/gateway/main/zh><img src=/gateway/main/img/logo-zh.svg alt=Logo></a></h2><div id=searchbox style=margin-bottom:10px></div><div class=heading><select class=version-selector>
<option value>main (latest)</option>
<option value=v1.29.2>v1.29.2</option>
<option value=v1.29.1>v1.29.1</option>
<option value=v1.29.0>v1.29.0</option>
<option value=v1.28.2>v1.28.2</option>
<option value=v1.28.0>v1.28.0</option>
<option value=v1.27.0>v1.27.0</option>
<option value=v1.26.1>v1.26.1</option></select></div><ul><li><a href=/gateway/main/zh/docs/overview/ class=active>产品概述</a><ul></ul></li><li><input type=checkbox id=section-f1b7c1b2e5dd43526e77637c475d35b8 class=toggle>
<label for=section-f1b7c1b2e5dd43526e77637c475d35b8 class="flex justify-between"><a>入门指南</a>
<span>▾</span></label><ul><li><a href=/gateway/main/zh/docs/getting-started/install/>安装网关</a></li><li><a href=/gateway/main/zh/docs/getting-started/configuration/>配置网关</a></li><li><a href=/gateway/main/zh/docs/getting-started/docker/>容器部署</a></li><li><a href=/gateway/main/zh/docs/getting-started/helm/>Helm 部署</a></li><li><a href=/gateway/main/zh/docs/getting-started/optimization/>系统调优</a></li><li><a href=/gateway/main/zh/docs/getting-started/benchmark/>性能测试</a></li></ul></li><li><input type=checkbox id=section-fb088f8a9be33f7f260ad2b140bb7bdc class=toggle>
<label for=section-fb088f8a9be33f7f260ad2b140bb7bdc class="flex justify-between"><a>功能手册</a>
<span>▾</span></label><ul><li><a href=/gateway/main/zh/docs/references/entry/>服务入口</a></li><li><a href=/gateway/main/zh/docs/references/router/>服务路由</a></li><li><a href=/gateway/main/zh/docs/references/flow/>处理流程</a></li><li><a href=/gateway/main/zh/docs/references/elasticsearch/>Elasticsearch</a></li><li><a href=/gateway/main/zh/docs/references/context/>请求上下文</a></li><li><input type=checkbox id=section-a53d1bd91095fa28aef70cee327a5121 class=toggle>
<label for=section-a53d1bd91095fa28aef70cee327a5121 class="flex justify-between"><a href=/gateway/main/zh/docs/references/filters/>在线过滤器</a>
<span>▾</span></label><ul><li><a href=/gateway/main/zh/docs/references/filters/echo/>echo</a></li><li><a href=/gateway/main/zh/docs/references/filters/auto_generate_doc_id/>auto_generate_doc_id</a></li><li><a href=/gateway/main/zh/docs/references/filters/basic_auth/>basic_auth</a></li><li><a href=/gateway/main/zh/docs/references/filters/bulk_request_mutate/>bulk_request_mutate</a></li><li><a href=/gateway/main/zh/docs/references/filters/bulk_request_throttle/>bulk_request_throttle</a></li><li><a href=/gateway/main/zh/docs/references/filters/bulk_reshuffle/>bulk_reshuffle</a></li><li><a href=/gateway/main/zh/docs/references/filters/bulk_response_process/>bulk_response_process</a></li><li><a href=/gateway/main/zh/docs/references/filters/cache/>cache</a></li><li><a href=/gateway/main/zh/docs/references/filters/clone/>clone</a></li><li><a href=/gateway/main/zh/docs/references/filters/context_filter/>context_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/context_limiter/>context_limiter</a></li><li><a href=/gateway/main/zh/docs/references/filters/context_parse/>context_parse</a></li><li><a href=/gateway/main/zh/docs/references/filters/context_regex_replace/>context_regex_replace</a></li><li><a href=/gateway/main/zh/docs/references/filters/context_switch/>context_switch</a></li><li><a href=/gateway/main/zh/docs/references/filters/date_range_precision_tuning/>date_range_precision_tuning</a></li><li><a href=/gateway/main/zh/docs/references/filters/drop/>drop</a></li><li><a href=/gateway/main/zh/docs/references/filters/dump/>dump</a></li><li><a href=/gateway/main/zh/docs/references/filters/elasticsearch/>elasticsearch</a></li><li><a href=/gateway/main/zh/docs/references/filters/elasticsearch_health_check/>elasticsearch_health_check</a></li><li><a href=/gateway/main/zh/docs/references/filters/flow/>flow</a></li><li><a href=/gateway/main/zh/docs/references/filters/hash_mod/>hash_mod</a></li><li><a href=/gateway/main/zh/docs/references/filters/http/>http</a></li><li><a href=/gateway/main/zh/docs/references/filters/javascript/>javascript</a></li><li><a href=/gateway/main/zh/docs/references/filters/ldap_auth/>ldap_auth</a></li><li><a href=/gateway/main/zh/docs/references/filters/logging/>logging</a></li><li><a href=/gateway/main/zh/docs/references/filters/queue/>queue</a></li><li><a href=/gateway/main/zh/docs/references/filters/ratio/>ratio</a></li><li><a href=/gateway/main/zh/docs/references/filters/record/>record</a></li><li><a href=/gateway/main/zh/docs/references/filters/redirect/>redirect</a></li><li><a href=/gateway/main/zh/docs/references/filters/redis_pubsub/>redis_pubsub</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_api_key_filter/>request_api_key_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_api_key_limiter/>request_api_key_limiter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_body_json_del/>request_body_json_del</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_body_json_set/>request_body_json_set</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_body_regex_replace/>request_body_regex_replace</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_client_ip_filter/>request_client_ip_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_client_ip_limiter/>request_client_ip_limiter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_header_filter/>request_header_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_host_filter/>request_host_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_host_limiter/>request_host_limiter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_method_filter/>request_method_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_path_filter/>request_path_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_path_limiter/>request_path_limiter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_reshuffle/>request_reshuffle</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_user_filter/>request_user_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/request_user_limiter/>request_user_limiter</a></li><li><a href=/gateway/main/zh/docs/references/filters/response_body_regex_replace/>response_body_regex_replace</a></li><li><a href=/gateway/main/zh/docs/references/filters/response_header_filter/>response_header_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/response_header_format/>response_header_format</a></li><li><a href=/gateway/main/zh/docs/references/filters/response_status_filter/>response_status_filter</a></li><li><a href=/gateway/main/zh/docs/references/filters/retry_limiter/>retry_limiter</a></li><li><a href=/gateway/main/zh/docs/references/filters/rewrite_to_bulk/>rewrite_to_bulk</a></li><li><a href=/gateway/main/zh/docs/references/filters/sample/>sample</a></li><li><a href=/gateway/main/zh/docs/references/filters/security/>security</a></li><li><a href=/gateway/main/zh/docs/references/filters/set_basic_auth/>set_basic_auth</a></li><li><a href=/gateway/main/zh/docs/references/filters/set_context/>set_context</a></li><li><a href=/gateway/main/zh/docs/references/filters/set_hostname/>set_hostname</a></li><li><a href=/gateway/main/zh/docs/references/filters/set_request_header/>set_request_header</a></li><li><a href=/gateway/main/zh/docs/references/filters/set_request_query_args/>set_request_query_args</a></li><li><a href=/gateway/main/zh/docs/references/filters/set_response/>set_response</a></li><li><a href=/gateway/main/zh/docs/references/filters/set_response_header/>set_response_header</a></li><li><a href=/gateway/main/zh/docs/references/filters/sleep/>sleep</a></li><li><a href=/gateway/main/zh/docs/references/filters/switch/>switch</a></li><li><a href=/gateway/main/zh/docs/references/filters/translog/>translog</a></li></ul></li><li><input type=checkbox id=section-82db29a871579194764c352cfff582f2 class=toggle>
<label for=section-82db29a871579194764c352cfff582f2 class="flex justify-between"><a href=/gateway/main/zh/docs/references/processors/>离线处理器</a>
<span>▾</span></label><ul><li><a href=/gateway/main/zh/docs/references/processors/bulk_indexing/>bulk_indexing</a></li><li><a href=/gateway/main/zh/docs/references/processors/consumer/>consumer</a></li><li><a href=/gateway/main/zh/docs/references/processors/dag/>dag</a></li><li><a href=/gateway/main/zh/docs/references/processors/dump_hash/>dump_hash</a></li><li><a href=/gateway/main/zh/docs/references/processors/flow_replay/>flow_replay</a></li><li><a href=/gateway/main/zh/docs/references/processors/flow_runner/>flow_runner</a></li><li><a href=/gateway/main/zh/docs/references/processors/index_diff/>index_diff</a></li><li><a href=/gateway/main/zh/docs/references/processors/indexing_merge/>indexing_merge</a></li><li><a href=/gateway/main/zh/docs/references/processors/json_indexing/>json_indexing</a></li><li><a href=/gateway/main/zh/docs/references/processors/merge_to_bulk/>merge_to_bulk</a></li><li><a href=/gateway/main/zh/docs/references/processors/queue_consumer/>queue_consumer</a></li><li><a href=/gateway/main/zh/docs/references/processors/replay/>replay</a></li><li><a href=/gateway/main/zh/docs/references/processors/smtp/>smtp</a></li></ul></li><li><input type=checkbox id=section-3de6688eceb9f20db2f0270adccf76e2 class=toggle>
<label for=section-3de6688eceb9f20db2f0270adccf76e2 class="flex justify-between"><a>功能组件</a>
<span>▾</span></label><ul><li><a href=/gateway/main/zh/docs/references/modules/floating_ip/>浮动 IP</a></li><li><a href=/gateway/main/zh/docs/references/modules/force_merge/>索引段合并</a></li></ul></li><li><a href=/gateway/main/zh/docs/references/config/>其它配置</a></li></ul></li><li><input type=checkbox id=section-391bcaab6cc03bd87e3373752bfd390e class=toggle>
<label for=section-391bcaab6cc03bd87e3373752bfd390e class="flex justify-between"><a>动手教程</a>
<span>▾</span></label><ul><li><a href=/gateway/main/zh/docs/tutorial/log4j2_filtering/>Apache Log4j 漏洞处置</a></li><li><a href=/gateway/main/zh/docs/tutorial/online_query_rewrite/>在线查询修复的实现</a></li><li><a href=/gateway/main/zh/docs/tutorial/request-logging/>查询请求流量日志分析</a></li><li><a href=/gateway/main/zh/docs/tutorial/index_diff/>索引文档级别差异对比</a></li><li><a href=/gateway/main/zh/docs/tutorial/es-hadoop_integration/>与 Elasticsearch-Hadoop 集成</a></li><li><a href=/gateway/main/zh/docs/tutorial/prometheus_integration/>与 Prometheus 集成</a></li><li><a href=/gateway/main/zh/docs/tutorial/proxy_elasticsearch/>为 Elasticsearch 无缝添加代理和基础安全</a></li><li><a href=/gateway/main/zh/docs/tutorial/proxy_kibana/>为 Kibana 添加代理和基础安全</a></li><li><a href=/gateway/main/zh/docs/tutorial/path_rewrite_by_javascript/>使用 JavaScript 脚本来进行复杂的查询改写</a></li><li><a href=/gateway/main/zh/docs/tutorial/fix_count_in_search_response/>兼容不同版本的响应 Count 结构</a></li><li><a href=/gateway/main/zh/docs/tutorial/routing_to_cluser_by_index/>在 Kibana 里统一访问来自不同集群的索引</a></li></ul></li><li><input type=checkbox id=section-7e4e95606453deb85437b78d9c3f2d72 class=toggle>
<label for=section-7e4e95606453deb85437b78d9c3f2d72 class="flex justify-between"><a href=/gateway/main/zh/docs/user-cases/>用户案例</a>
<span>▾</span></label><ul><li><a href=/gateway/main/zh/docs/user-cases/stories/a_cross_region_cluster_access_locality/>作业帮跨云集群的就近本地访问</a></li><li><a href=/gateway/main/zh/docs/user-cases/stories/indexing_speedup_for_big_index_rebuild/>某保险业务索引速度百倍提升</a></li></ul></li><li><a href=/gateway/main/zh/docs/troubleshooting/>常见问题</a><ul></ul></li><li><a href=/gateway/main/zh/docs/release-notes/>版本历史</a><ul></ul></li><li><a href=/gateway/main/zh/docs/resources/>其它资源</a><ul></ul></li></ul><ul><li><a href=https://github.com/infinilabs/gateway target=_blank rel=noopener>Github</a></li></ul><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
简体中文</li></ul><ul class=book-languages-list><li><a href=/gateway/main/docs/overview/ class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li class=active><a href=/gateway/main/zh/ class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/gateway/main/svg/menu.svg class=book-icon alt=Menu></label>
<strong>产品概述</strong>
<label for=toc-control><img src=/gateway/main/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#概述>概述</a><ul><li><a href=#介绍>介绍</a></li><li><a href=#特性>特性</a></li><li><a href=#无缝集成>无缝集成</a></li><li><a href=#为什么需要极限网关>为什么需要极限网关？</a><ul><li><a href=#waf-与安全>WAF 与安全</a></li><li><a href=#集群升级>集群升级</a></li><li><a href=#索引重建>索引重建</a></li><li><a href=#限流限速>限流限速</a></li><li><a href=#查询太慢>查询太慢</a></li><li><a href=#索引太慢>索引太慢</a></li><li><a href=#请求干预>请求干预</a></li><li><a href=#请求分析>请求分析</a></li></ul></li><li><a href=#架构>架构</a><ul><li><a href=#entry>Entry</a></li><li><a href=#router>Router</a></li><li><a href=#flow>Flow</a></li><li><a href=#filter>Filter</a></li><li><a href=#pipeline>Pipeline</a></li><li><a href=#queue>Queue</a></li></ul></li><li><a href=#接下来>接下来</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=概述>概述
<a class=anchor href=#%e6%a6%82%e8%bf%b0>#</a></h1><h2 id=介绍>介绍
<a class=anchor href=#%e4%bb%8b%e7%bb%8d>#</a></h2><p><strong>极限网关</strong>（<em>INFINI Gateway</em>）是一个面向 Elasticsearch 的高性能应用网关，它包含丰富的特性，使用起来也非常简单。极限网关工作的方式和普通的反向代理一样，我们一般是将网关部署在 Elasticsearch 集群前面，
将以往直接发送给 Elasticsearch 的请求都发送给网关，再由网关转发给请求到后端的 Elasticsearch 集群。因为网关位于在用户端和后端 Elasticsearch 之间，所以网关在中间可以做非常多的事情，
比如可以实现索引级别的限速限流、常见查询的缓存加速、查询请求的审计、查询结果的动态修改等等。</p><h2 id=特性>特性
<a class=anchor href=#%e7%89%b9%e6%80%a7>#</a></h2><p><strong>极限网关</strong> 最懂 Elasticsearch，其在设计的时候就综合考虑了很多和 Elasticsearch 相关的业务场景及特点，基于此打造了很多完美契合 Elasticsearch 的众多非常实用的功能。</p><div class="book-columns flex flex-wrap"><div class="flex-even markdown-inner"><h3 id=轻量级>轻量级</h3><p>极限网关使用 Golang 编写，安装包很小，只有 10MB 左右，没有任何外部环境依赖，部署安装都非常简单，只需要下载对应平台的二进制可执行文件，启动网关程序的二进制程序文件执行即可。</div><div class="flex-even markdown-inner"><h3 id=极致性能>极致性能</h3><p>极限网关在编写每一行代码的时候，都会考虑如何让其运行在最佳状态，经测试，极限网关比同类主流网关类产品速度快 25% 以上，且针对 Elasticsearch 做了非常细致的优化，能成倍提升写入和查询的速度。</div></div><div class="book-columns flex flex-wrap"><div class="flex-even markdown-inner"><h3 id=跨版本支持>跨版本支持</h3><p>极限网关针对不同的 Elasticsearch 版本做了兼容和针对性处理，能够让业务代码无缝的进行适配，后端 Elasticsearch 集群版本升级能够做到无缝过渡，降低版本升级和数据迁移的复杂度。</div><div class="flex-even markdown-inner"><h3 id=可观测性>可观测性</h3><p>极限网关可以动态对 Elasticsearch 运行过程中产生的任何请求进行截获和分析，通过指标和日志来了解整个集群的运行情况，用于提升性能和优化业务。还可以用于审计和慢查询分析。</div></div><div class="book-columns flex flex-wrap"><div class="flex-even markdown-inner"><h3 id=高可用>高可用</h3><p>极限网关内置多种高可用解决方案，前端请求入口支持基于虚拟 IP 的双机热备，后端集群支持集群拓扑的自动感知，节点上下线能自动发现，自动处理后端故障，自动进行请求的重试和迁移。</div><div class="flex-even markdown-inner"><h3 id=灵活可扩展>灵活可扩展</h3><p>极限网关的每个模块都可以独立扩展，可灵活对每个请求进行干预和路由，支持路由的智能学习，内置丰富的过滤器，通过配置动态修改每个请求的处理逻辑，也支持通过插件来进行扩展。</div></div><h2 id=无缝集成>无缝集成
<a class=anchor href=#%e6%97%a0%e7%bc%9d%e9%9b%86%e6%88%90>#</a></h2><p>极限网关对外提供的接口完全兼容 Elasticsearch 原生的接口，集成起来非常简单，只需将原本指向 Elasticsearch 的配置修改成网关的地址即可。</p><p><img src=/gateway/main/img/oveview-diagram.jpg alt></p><h2 id=为什么需要极限网关>为什么需要极限网关？
<a class=anchor href=#%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%e6%9e%81%e9%99%90%e7%bd%91%e5%85%b3>#</a></h2><p>嗯，上面的集成交互图基本上看明白了，可我现在 Elasticsearch 用的好好的，我为什么需要在前面加上一个网关呢？</p><p>好吧，如果您有一个稍微上了规模的 Elasticsearch 集群，不如试着想想下面的几个场景：</p><h3 id=waf-与安全>WAF 与安全
<a class=anchor href=#waf-%e4%b8%8e%e5%ae%89%e5%85%a8>#</a></h3><p>相信您存储在 Elasticsearch 中的每一份数据都是很宝贵的，随着 Elasticsearch 的流行，它也正日益成为黑客们攻击的主要目标，WAF（Web Application Firewall）的需求应运而生。
不管是跨站脚本攻击还是跨站脚本注入，又或是弱密码、暴力破解，还是程序员不合理的查询参数滥用，极限网关都能对这些来自不同 Web 应用程序客户端的各类请求进行内容检测和验证，
通过执行一系列针对 Elasticsearch 的安全策略来确保其安全性与合法性，对非法的请求予以实时阻断，从而对后端 Elasticsearch 进行有效防护。</p><h3 id=集群升级>集群升级
<a class=anchor href=#%e9%9b%86%e7%be%a4%e5%8d%87%e7%ba%a7>#</a></h3><p>没错，相信您也知道 Elasticsearch 版本迭代的速度是非常快的，可能经常需要处理集群版本升级的事宜，而集群升级势必要考虑到以下几点：</p><ul><li>保证最小的停机时间，业务的数据写入和查询不能因为集群的升级而中止，数据要能持续的进行写入，还不能因为后端重启节点而丢失数据</li><li>集群流量的切换，新旧集群在什么时候以及如何进行切换，是修改业务代码或者配置文件呢，以及如何回滚恢复呢，是不是需要重新发布一个新的部署包</li></ul><p>借助极限网关，您的业务代码完全不用关心后端 Elasticsearch 集群是什么状况，只需要访问网关固定的地址即可，剩下的交给网关就都搞定了。</p><h3 id=索引重建>索引重建
<a class=anchor href=#%e7%b4%a2%e5%bc%95%e9%87%8d%e5%bb%ba>#</a></h3><p>修改了 Mapping 需要重建索引，修改了分词词典需要重建索引，重建过程中还不能停止数据的写入，重建完成之后还要确保数据是一致的，有新增的数据和修改的数据也必须一一处理，自己处理起来貌似还挺麻烦。
而极限网关，可以做到一键索引重建，重建过程中的任何文档修改操作都会被自动记录，新旧索引在重建完成之后会自动无缝地进行切换，对于前端应用来说完全无感知。</p><h3 id=限流限速>限流限速
<a class=anchor href=#%e9%99%90%e6%b5%81%e9%99%90%e9%80%9f>#</a></h3><p>有没有遇到过突发流量把集群打爆的情况，有没有遇到过个别大索引特别热闹把整个集群都连累的窘迫，其实您需要对异常的流量进行管理，这样才能保护整个 Elasticsearch 集群不会被异常的流量影响甚至是被恶意的攻击。
极限网关可以做到灵活的流量控制，可以做到索引级别的限速规则设置，一千个索引就有一千个哈姆雷特，完全没问题。</p><h3 id=查询太慢>查询太慢
<a class=anchor href=#%e6%9f%a5%e8%af%a2%e5%a4%aa%e6%85%a2>#</a></h3><p>极限网关内置缓存功能，能够将最常见的查询进行缓存，还可指定周期性的查询计划来预热特定的查询，保证前端的业务每次都能命中查询，从而提升查询速度，改进业务查询用户体验；</p><h3 id=索引太慢>索引太慢
<a class=anchor href=#%e7%b4%a2%e5%bc%95%e5%a4%aa%e6%85%a2>#</a></h3><p>极限网关可以将来自不同客户端的众多小批量的 Elasticsearch 索引请求合并成一个大的批次请求，通过精准的分片级别的路由，将索引请求合并封装直接投递到指定分片的指定节点上，
避免后端 Elasticsearch 再次进行请求转发，节省 Elasticsearch 资源和带宽，从而提升整体集群的吞吐和性能。</p><h3 id=请求干预>请求干预
<a class=anchor href=#%e8%af%b7%e6%b1%82%e5%b9%b2%e9%a2%84>#</a></h3><p>代码上线之后才发现查询语句写错了？有了极限网关，完全不用担心，可以在线对指定业务的指定查询进行改写，将查询语句动态修复，无需重新发布应用，方便灵活。或者您对 Elasticsearch 查询返回的 JSON 结果不满意，
也没关系，借助极限网关，您能够动态的替换查询结果为新的内容，甚至可以聚合来自其他数据源的数据，如 Hbase、MySQL 等等，融合成您需要的 JSON 数据再返回给客户端。</p><h3 id=请求分析>请求分析
<a class=anchor href=#%e8%af%b7%e6%b1%82%e5%88%86%e6%9e%90>#</a></h3><p>只知道有人抱怨 Elasticsearch 很慢，可您知道是 Elasticsearch 里面的哪些索引慢么？又是哪些查询造成的呢？
又是哪些用户造成的呢？极限网关帮您全程跟踪，从集群到索引，从索引到查询，从应用到用户，让您对于 Elasticsearch 集群内的那点事情一清二楚。</p><p>所以，用上极限网关之后您再用 Elasticsearch 将会是一件很爽的事情。</p><h2 id=架构>架构
<a class=anchor href=#%e6%9e%b6%e6%9e%84>#</a></h2><p>极限网关的核心模块见下面的架构图：</p><p><img src=/gateway/main/img/architecture.jpg alt></p><p>负载外部请求代理的模块由四个主要部分组成，即：Entry、Router、Flow 和 Filter。一个 Entry 需要配置一个 Router，一个 Router 可以路由到多个 Flow，一个 Flow 由多个 Filter 组成。</p><h3 id=entry>Entry
<a class=anchor href=#entry>#</a></h3><p>Entry 模块主要定义网关的请求入口，极限网关支持 HTTP 和 HTTPS 两种模式，HTTPS 可以自动生成证书。</p><h3 id=router>Router
<a class=anchor href=#router>#</a></h3><p>Router 模块主要定义请求的路由规则，根据 Method 和请求地址来进行路由到指定的 Flow 处理流程里面去。</p><h3 id=flow>Flow
<a class=anchor href=#flow>#</a></h3><p>Flow 模块主要定义数据的处理逻辑，每个请求会经过一系列的 Filter 操作，Flow 用来将这些 Filter 组织起来。</p><h3 id=filter>Filter
<a class=anchor href=#filter>#</a></h3><p>Filter 模块由若干个不同的 Filter 组件构成，每个 Filter 在设计的时候只处理一件事情，通过多个 Filter 组成变成一个 Flow。</p><h3 id=pipeline>Pipeline
<a class=anchor href=#pipeline>#</a></h3><p>Pipeline 模块由若干个不同的 Processor 组件构成，通过多个 Processor 组成一个 Pipeline。Pipeline 和 Flow 相比，更侧重离线任务的处理。</p><h3 id=queue>Queue
<a class=anchor href=#queue>#</a></h3><p>Queue 模块是一个抽象的消息队列，如基于本地磁盘的可靠性消息持久化以及 Redis 和 Kafka 等适配器，根据不同的场景可以设置队列的不同后端适配器。</p><p>此外，INFINI Gateway 使用的框架底层还有一些公共的模块，如：API 用来提供对外的编程入口，Elastic 模块用于处理不同版本的 Elasticsearch API 封装等等。</p><h2 id=接下来>接下来
<a class=anchor href=#%e6%8e%a5%e4%b8%8b%e6%9d%a5>#</a></h2><ul><li>查看
<a href=/gateway/main/zh/docs/getting-started/install/>下载安装</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
简体中文</li></ul><ul class=book-languages-list><li><a href=/gateway/main/docs/overview/ class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li class=active><a href=/gateway/main/zh/ class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div><div><a class="flex align-center" href=https://github.com/infinilabs/gateway/edit/main/docs/content.zh/docs/overview/_index.md target=_blank rel=noopener><img src=/gateway/main/svg/edit.svg class=book-icon alt=Edit>
<span>编辑本页</span></a></div><div class="flex align-center footer">©INFINI.LTD, All Rights Reserved.</div><script>(function(h,o,t,j,a,r){h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};h._hjSettings={hjid:2567416,hjsv:6};a=o.getElementsByTagName('head')[0];r=o.createElement('script');r.async=1;r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;a.appendChild(r);})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RJPTVP614C"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-RJPTVP614C');</script><script type=text/javascript>var _smartsupp=_smartsupp||{};_smartsupp.key='691ff544d18a237005a011a7290b839d8fe811a4';window.smartsupp||(function(d){var s,c,o=smartsupp=function(){o._.push(arguments)};o._=[];s=d.getElementsByTagName('script')[0];c=d.createElement('script');c.type='text/javascript';c.charset='utf-8';c.async=true;c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);})(document);</script></div><script type=module>
    import { searchbox } from "https://coco.infini.cloud/integration/cvn0g9ehpcehvsthrakg/widget";
    searchbox({container: "#searchbox"});
</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#概述>概述</a><ul><li><a href=#介绍>介绍</a></li><li><a href=#特性>特性</a></li><li><a href=#无缝集成>无缝集成</a></li><li><a href=#为什么需要极限网关>为什么需要极限网关？</a><ul><li><a href=#waf-与安全>WAF 与安全</a></li><li><a href=#集群升级>集群升级</a></li><li><a href=#索引重建>索引重建</a></li><li><a href=#限流限速>限流限速</a></li><li><a href=#查询太慢>查询太慢</a></li><li><a href=#索引太慢>索引太慢</a></li><li><a href=#请求干预>请求干预</a></li><li><a href=#请求分析>请求分析</a></li></ul></li><li><a href=#架构>架构</a><ul><li><a href=#entry>Entry</a></li><li><a href=#router>Router</a></li><li><a href=#flow>Flow</a></li><li><a href=#filter>Filter</a></li><li><a href=#pipeline>Pipeline</a></li><li><a href=#queue>Queue</a></li></ul></li><li><a href=#接下来>接下来</a></li></ul></li></ul></nav></aside></main></body></html>