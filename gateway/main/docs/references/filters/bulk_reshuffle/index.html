<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.79.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="bulk_reshuffle #  Description #  The bulk_reshuffle filter is used to parse batch requests of Elasticsearch based on document, sort out documents as needed, and archive and store them in queues. After documents are stored, the filter can rapidly return service requests, thereby decoupling front-end writing from back-end Elasticsearch clusters. The bulk_reshuffle filter needs to be used in combination with offline pipeline consumption tasks.
When passing through queues generated by the bulk_reshuffle filter, metadata carries &#34;type&#34;: &#34;bulk_reshuffle&#34; and Elasticsearch cluster information such as &#34;elasticsearch&#34;: &#34;dev&#34;, by default."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="bulk_reshuffle"><meta property="og:description" content="bulk_reshuffle #  Description #  The bulk_reshuffle filter is used to parse batch requests of Elasticsearch based on document, sort out documents as needed, and archive and store them in queues. After documents are stored, the filter can rapidly return service requests, thereby decoupling front-end writing from back-end Elasticsearch clusters. The bulk_reshuffle filter needs to be used in combination with offline pipeline consumption tasks.
When passing through queues generated by the bulk_reshuffle filter, metadata carries &#34;type&#34;: &#34;bulk_reshuffle&#34; and Elasticsearch cluster information such as &#34;elasticsearch&#34;: &#34;dev&#34;, by default."><meta property="og:type" content="article"><meta property="og:url" content="/gateway/main/docs/references/filters/bulk_reshuffle/"><title>bulk_reshuffle | INFINI Gateway</title><link rel=manifest href=/gateway/main/manifest.json><link rel=icon href=/gateway/main/favicon.png type=image/x-icon><link rel=alternate hreflang=zh href=/gateway/main/zh/docs/references/filters/bulk_reshuffle/ title=bulk_reshuffle><link rel=stylesheet href=/gateway/main/book.min.d80e87b12a4b49d9913d0bdd98bd83b7a44988be784760ba15522b377313dcf9.css integrity="sha256-2A6HsSpLSdmRPQvdmL2Dt6RJiL54R2C6FVIrN3MT3Pk="><script defer src=/gateway/main/js/jquery-2.x.min.js></script><script defer src=/gateway/main/js/doc.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/gateway/main><img src=/gateway/main/img/logo-en.svg alt=Logo></a></h2><div class=heading><select class=version-selector>
<option value>main (latest)</option>
<option value=v1.28.2>v1.28.x</option>
<option value=v1.28.0>v1.28.x</option>
<option value=v1.27.0>v1.27.x</option>
<option value=v1.26.1>v1.26.x</option></select></div><ul><li><a href=/gateway/main/docs/overview/>Overview</a><ul></ul></li><li><input type=checkbox id=section-f1b7c1b2e5dd43526e77637c475d35b8 class=toggle>
<label for=section-f1b7c1b2e5dd43526e77637c475d35b8 class="flex justify-between"><a>Getting Started</a>
<span>▾</span></label><ul><li><a href=/gateway/main/docs/getting-started/install/>Installing the Gateway</a></li><li><a href=/gateway/main/docs/getting-started/configuration/>Configuring the Gateway</a></li><li><a href=/gateway/main/docs/getting-started/docker/>Container Deployment</a></li><li><a href=/gateway/main/docs/getting-started/helm/>Kubernetes Deployment</a></li><li><a href=/gateway/main/docs/getting-started/optimization/>System Optimization</a></li><li><a href=/gateway/main/docs/getting-started/benchmark/>Benchmark Testing</a></li></ul></li><li><input type=checkbox id=section-fb088f8a9be33f7f260ad2b140bb7bdc class=toggle checked>
<label for=section-fb088f8a9be33f7f260ad2b140bb7bdc class="flex justify-between"><a>References</a>
<span>▾</span></label><ul><li><a href=/gateway/main/docs/references/entry/>Service Entry</a></li><li><a href=/gateway/main/docs/references/router/>Service Router</a></li><li><a href=/gateway/main/docs/references/flow/>Handling Flow</a></li><li><a href=/gateway/main/docs/references/elasticsearch/>Elasticsearch</a></li><li><a href=/gateway/main/docs/references/context/>Request Context</a></li><li><input type=checkbox id=section-a53d1bd91095fa28aef70cee327a5121 class=toggle checked>
<label for=section-a53d1bd91095fa28aef70cee327a5121 class="flex justify-between"><a href=/gateway/main/docs/references/filters/>Online Filter</a>
<span>▾</span></label><ul><li><a href=/gateway/main/docs/references/filters/echo/>echo</a></li><li><a href=/gateway/main/docs/references/filters/auto_generate_doc_id/>auto_generate_doc_id</a></li><li><a href=/gateway/main/docs/references/filters/basic_auth/>basic_auth</a></li><li><a href=/gateway/main/docs/references/filters/bulk_request_mutate/>bulk_request_mutate</a></li><li><a href=/gateway/main/docs/references/filters/bulk_request_throttle/>bulk_request_throttle</a></li><li><a href=/gateway/main/docs/references/filters/bulk_reshuffle/ class=active>bulk_reshuffle</a></li><li><a href=/gateway/main/docs/references/filters/bulk_response_process/>bulk_response_process</a></li><li><a href=/gateway/main/docs/references/filters/cache/>cache</a></li><li><a href=/gateway/main/docs/references/filters/clone/>clone</a></li><li><a href=/gateway/main/docs/references/filters/context_filter/>context_filter</a></li><li><a href=/gateway/main/docs/references/filters/context_limiter/>context_limiter</a></li><li><a href=/gateway/main/docs/references/filters/context_parse/>context_parse</a></li><li><a href=/gateway/main/docs/references/filters/context_regex_replace/>context_regex_replace</a></li><li><a href=/gateway/main/docs/references/filters/context_switch/>context_switch</a></li><li><a href=/gateway/main/docs/references/filters/date_range_precision_tuning/>date_range_precision_tuning</a></li><li><a href=/gateway/main/docs/references/filters/drop/>drop</a></li><li><a href=/gateway/main/docs/references/filters/dump/>dump</a></li><li><a href=/gateway/main/docs/references/filters/elasticsearch/>elasticsearch</a></li><li><a href=/gateway/main/docs/references/filters/elasticsearch_health_check/>elasticsearch_health_check</a></li><li><a href=/gateway/main/docs/references/filters/flow/>flow</a></li><li><a href=/gateway/main/docs/references/filters/hash_mod/>hash_mod</a></li><li><a href=/gateway/main/docs/references/filters/http/>http</a></li><li><a href=/gateway/main/docs/references/filters/javascript/>javascript</a></li><li><a href=/gateway/main/docs/references/filters/ldap_auth/>ldap_auth</a></li><li><a href=/gateway/main/docs/references/filters/logging/>logging</a></li><li><a href=/gateway/main/docs/references/filters/queue/>queue</a></li><li><a href=/gateway/main/docs/references/filters/ratio/>ratio</a></li><li><a href=/gateway/main/docs/references/filters/record/>record</a></li><li><a href=/gateway/main/docs/references/filters/redirect/>redirect</a></li><li><a href=/gateway/main/docs/references/filters/redis_pubsub/>redis_pubsub</a></li><li><a href=/gateway/main/docs/references/filters/request_api_key_filter/>request_api_key_filter</a></li><li><a href=/gateway/main/docs/references/filters/request_api_key_limiter/>request_api_key_limiter</a></li><li><a href=/gateway/main/docs/references/filters/request_body_json_del/>request_body_json_del</a></li><li><a href=/gateway/main/docs/references/filters/request_body_json_set/>request_body_json_set</a></li><li><a href=/gateway/main/docs/references/filters/request_body_regex_replace/>request_body_regex_replace</a></li><li><a href=/gateway/main/docs/references/filters/request_client_ip_filter/>request_client_ip_filter</a></li><li><a href=/gateway/main/docs/references/filters/request_client_ip_limiter/>request_client_ip_limiter</a></li><li><a href=/gateway/main/docs/references/filters/request_header_filter/>request_header_filter</a></li><li><a href=/gateway/main/docs/references/filters/request_host_filter/>request_host_filter</a></li><li><a href=/gateway/main/docs/references/filters/request_host_limiter/>request_host_limiter</a></li><li><a href=/gateway/main/docs/references/filters/request_method_filter/>request_method_filter</a></li><li><a href=/gateway/main/docs/references/filters/request_path_filter/>request_path_filter</a></li><li><a href=/gateway/main/docs/references/filters/request_path_limiter/>request_path_limiter</a></li><li><a href=/gateway/main/docs/references/filters/request_reshuffle/>request_reshuffle</a></li><li><a href=/gateway/main/docs/references/filters/request_user_filter/>request_user_filter</a></li><li><a href=/gateway/main/docs/references/filters/request_user_limiter/>request_user_limiter</a></li><li><a href=/gateway/main/docs/references/filters/response_body_regex_replace/>response_body_regex_replace</a></li><li><a href=/gateway/main/docs/references/filters/response_header_filter/>response_header_filter</a></li><li><a href=/gateway/main/docs/references/filters/response_header_format/>response_header_format</a></li><li><a href=/gateway/main/docs/references/filters/response_status_filter/>response_status_filter</a></li><li><a href=/gateway/main/docs/references/filters/retry_limiter/>retry_limiter</a></li><li><a href=/gateway/main/docs/references/filters/rewrite_to_bulk/>rewrite_to_bulk</a></li><li><a href=/gateway/main/docs/references/filters/sample/>sample</a></li><li><a href=/gateway/main/docs/references/filters/set_basic_auth/>set_basic_auth</a></li><li><a href=/gateway/main/docs/references/filters/set_context/>set_context</a></li><li><a href=/gateway/main/docs/references/filters/set_hostname/>set_hostname</a></li><li><a href=/gateway/main/docs/references/filters/set_request_header/>set_request_header</a></li><li><a href=/gateway/main/docs/references/filters/set_request_query_args/>set_request_query_args</a></li><li><a href=/gateway/main/docs/references/filters/set_response/>set_response</a></li><li><a href=/gateway/main/docs/references/filters/set_response_header/>set_response_header</a></li><li><a href=/gateway/main/docs/references/filters/sleep/>sleep</a></li><li><a href=/gateway/main/docs/references/filters/switch/>switch</a></li><li><a href=/gateway/main/docs/references/filters/translog/>translog</a></li></ul></li><li><input type=checkbox id=section-82db29a871579194764c352cfff582f2 class=toggle>
<label for=section-82db29a871579194764c352cfff582f2 class="flex justify-between"><a href=/gateway/main/docs/references/processors/>Offline Processor</a>
<span>▾</span></label><ul><li><a href=/gateway/main/docs/references/processors/bulk_indexing/>bulk_indexing</a></li><li><a href=/gateway/main/docs/references/processors/consumer/>consumer</a></li><li><a href=/gateway/main/docs/references/processors/dag/>dag</a></li><li><a href=/gateway/main/docs/references/processors/dump_hash/>dump_hash</a></li><li><a href=/gateway/main/docs/references/processors/flow_replay/>flow_replay</a></li><li><a href=/gateway/main/docs/references/processors/flow_runner/>flow_runner</a></li><li><a href=/gateway/main/docs/references/processors/index_diff/>index_diff</a></li><li><a href=/gateway/main/docs/references/processors/indexing_merge/>indexing_merge</a></li><li><a href=/gateway/main/docs/references/processors/json_indexing/>json_indexing</a></li><li><a href=/gateway/main/docs/references/processors/merge_to_bulk/>merge_to_bulk</a></li><li><a href=/gateway/main/docs/references/processors/queue_consumer/>queue_consumer</a></li><li><a href=/gateway/main/docs/references/processors/replay/>replay</a></li><li><a href=/gateway/main/docs/references/processors/smtp/>smtp</a></li></ul></li><li><input type=checkbox id=section-3de6688eceb9f20db2f0270adccf76e2 class=toggle>
<label for=section-3de6688eceb9f20db2f0270adccf76e2 class="flex justify-between"><a>Functional Component</a>
<span>▾</span></label><ul><li><a href=/gateway/main/docs/references/modules/floating_ip/>Floating IP</a></li><li><a href=/gateway/main/docs/references/modules/force_merge/>Index Segment Merging</a></li></ul></li><li><a href=/gateway/main/docs/references/config/>Other Configurations</a></li></ul></li><li><input type=checkbox id=section-391bcaab6cc03bd87e3373752bfd390e class=toggle>
<label for=section-391bcaab6cc03bd87e3373752bfd390e class="flex justify-between"><a>Tutorials</a>
<span>▾</span></label><ul><li><a href=/gateway/main/docs/tutorial/log4j2_filtering/>Protect Elasticsearch from Apache Log4j Vulnerability</a></li><li><a href=/gateway/main/docs/tutorial/online_query_rewrite/>Rewrite Your Elasticsearch Requests OnTheFly</a></li><li><a href=/gateway/main/docs/tutorial/request-logging/>Elasticsearch Search Requests Analysis/Audit</a></li><li><a href=/gateway/main/docs/tutorial/index_diff/>Document-Level Index Diff Between Two Elasticsearch Clusters</a></li><li><a href=/gateway/main/docs/tutorial/proxy_kibana/>Adding a TLS and Basic Security for Kibana</a></li><li><a href=/gateway/main/docs/tutorial/proxy_elasticsearch/>Enable HTTPS/TLS + Basic Auth for Elasticsearch easily</a></li><li><a href=/gateway/main/docs/tutorial/fix_count_in_search_response/>Handle Count Structure of Different Elasticsearch Versions</a></li><li><a href=/gateway/main/docs/tutorial/es-hadoop_integration/>Integrate with Elasticsearch-Hadoop</a></li><li><a href=/gateway/main/docs/tutorial/prometheus_integration/>Integration with Prometheus</a></li><li><a href=/gateway/main/docs/tutorial/routing_to_cluser_by_index/>Unified access indexes from different clusters in Kibana</a></li><li><a href=/gateway/main/docs/tutorial/path_rewrite_by_javascript/>Use JavaScript for complex query rewriting</a></li></ul></li><li><input type=checkbox id=section-7e4e95606453deb85437b78d9c3f2d72 class=toggle>
<label for=section-7e4e95606453deb85437b78d9c3f2d72 class="flex justify-between"><a href=/gateway/main/docs/user-cases/>User Cases</a>
<span>▾</span></label><ul><li><a href=/gateway/main/docs/user-cases/stories/indexing_speedup_for_big_index_rebuild/>How an Insurance Group Improved the Indexing Speed by 200x Times</a></li><li><a href=/gateway/main/docs/user-cases/stories/a_cross_region_cluster_access_locality/>Nearest Cluster Access Across Two Cloud Providers</a></li></ul></li><li><a href=/gateway/main/docs/troubleshooting/>FAQs</a><ul></ul></li><li><a href=/gateway/main/docs/release-notes/>Release Notes</a><ul></ul></li></ul><ul><li><a href=https://github.com/infinilabs/gateway target=_blank rel=noopener>Github</a></li></ul><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
English</li></ul><ul class=book-languages-list><li class=active><a href=/gateway/main/ class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li><a href=/gateway/main/zh/docs/references/filters/bulk_reshuffle/ class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/gateway/main/svg/menu.svg class=book-icon alt=Menu></label>
<strong>bulk_reshuffle</strong>
<label for=toc-control><img src=/gateway/main/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#bulk_reshuffle>bulk_reshuffle</a><ul><li><a href=#description>Description</a></li><li><a href=#node-level-asynchronous-submission>Node-Level Asynchronous Submission</a><ul><li><a href=#defining-a-flow>Defining a Flow</a></li><li><a href=#configuring-a-consumption-pipeline>Configuring a Consumption Pipeline</a></li></ul></li><li><a href=#shard-level-asynchronous-submission>Shard-Level Asynchronous Submission</a><ul><li><a href=#defining-a-flow-1>Defining a Flow</a></li><li><a href=#defining-a-pipeline>Defining a Pipeline</a></li></ul></li><li><a href=#parameter-description>Parameter Description</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=bulk_reshuffle>bulk_reshuffle
<a class=anchor href=#bulk_reshuffle>#</a></h1><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><p>The <code>bulk_reshuffle</code> filter is used to parse batch requests of Elasticsearch based on document, sort out documents as needed, and archive and store them in queues. After documents are stored, the filter can rapidly return service requests, thereby decoupling front-end writing from back-end Elasticsearch clusters. The <code>bulk_reshuffle</code> filter needs to be used in combination with offline pipeline consumption tasks.</p><p>When passing through queues generated by the <code>bulk_reshuffle</code> filter, metadata carries <code>"type": "bulk_reshuffle"</code> and Elasticsearch cluster information such as <code>"elasticsearch": "dev"</code>, by default. You can call APIs on the gateway to check metadata defined in queues. See the following example.</p><pre><code>curl http://localhost:2900/queue/stats
{
  &quot;queue&quot;: {
    &quot;disk&quot;: {
      &quot;async_bulk-cluster##dev&quot;: {
        &quot;depth&quot;: 0,
        &quot;metadata&quot;: {
          &quot;source&quot;: &quot;dynamic&quot;,
          &quot;id&quot;: &quot;c71f7pqi4h92kki4qrvg&quot;,
          &quot;name&quot;: &quot;async_bulk-cluster##dev&quot;,
          &quot;label&quot;: {
            &quot;elasticsearch&quot;: &quot;dev&quot;,
            &quot;level&quot;: &quot;cluster&quot;,
            &quot;type&quot;: &quot;bulk_reshuffle&quot;
          }
        }
      }
    }
  }
}
</code></pre><h2 id=node-level-asynchronous-submission>Node-Level Asynchronous Submission
<a class=anchor href=#node-level-asynchronous-submission>#</a></h2><p>INFINI Gateway is capable of locally calculating the target storage location of a back-end Elasticsearch cluster corresponding to each index document so as to precisely locate requests. A batch of bulk requests may contain the data of multiple back-end nodes. The bulk_reshuffle filter is used to shuffle normal bulk requests and reassemble them based on target nodes or shards.
The purpose is to prevent Elasticsearch nodes from distributing received requests, so as to reduce the traffic and load between Elasticsearch clusters. The filter also prevents a single node from becoming a bottleneck and ensures balanced processing of all data nodes, thereby improving the overall index throughput of clusters.</p><p><img src=/gateway/main/img/bulk_reshuffle.jpg alt></p><h3 id=defining-a-flow>Defining a Flow
<a class=anchor href=#defining-a-flow>#</a></h3><p>A simple example is as follows:</p><pre><code>flow:
  - name: online_indexing_merge
    filter:
      - bulk_reshuffle:
          elasticsearch: prod
          level: node #cluster,node,shard,partition
      - elasticsearch:
          elasticsearch: prod
          refresh:
            enabled: true
            interval: 30s
elastic:
  enabled: true
  remote_configs: false
  health_check:
    enabled: true
    interval: 30s
  availability_check:
    enabled: true
    interval: 60s
  metadata_refresh:
    enabled: true
    interval: 30s
  cluster_settings_check:
    enabled: false
    interval: 20s
</code></pre><p>The above configuration indicates that bulk requests will be split and reassembled based on the target nodes corresponding to index documents. Data is sent to local disk queues first and then consumed and submitted through separate tasks to the target Elasticsearch nodes.</p><p><img src=/gateway/main/img/bulk_reshuffle_async.jpg alt></p><blockquote class="book-hint info">The benefit of this filter is that a failure occurring on the back-end Elasticsearch cluster will not affect indexing operations because requests are stored in disk queues of the gateway and the front-end indexing is decoupled from back-end clusters. Therefore, when the back-end Elasticsearch cluster encounters a failure, restarts, or initiates version upgrade, normal index operations will not be affected.</blockquote><h3 id=configuring-a-consumption-pipeline>Configuring a Consumption Pipeline
<a class=anchor href=#configuring-a-consumption-pipeline>#</a></h3><p>After the gateway sends requests to the disk, a consumption queue pipeline needs to be configured as follows to submit data:</p><pre><code>pipeline:
- name: bulk_request_ingest
  auto_start: true
  processor:
    - bulk_indexing:
        queues:
          type: bulk_reshuffle
          level: node
</code></pre><p>One pipeline task named <code>bulk_request_ingest</code> is used and the filter conditions for queues of to-be-subscribed targets are <code>type: bulk_reshuffle</code> and <code>level: node</code>. You can also set the batch size for bulk submission.
In this way, node-level requests received by INFINI Gateway will be automatically sent to the corresponding Elasticsearch node.</p><h2 id=shard-level-asynchronous-submission>Shard-Level Asynchronous Submission
<a class=anchor href=#shard-level-asynchronous-submission>#</a></h2><p>Shard-level asynchronous submission is suitable for scenarios in which the data amount of a single index is large and needs to be processed independently. An index is split into shards and then bulk requests are submitted in the form of shards, which further improves the processing efficiency of back-end Elasticsearch nodes.</p><p>The configuration is as follows:</p><h3 id=defining-a-flow-1>Defining a Flow
<a class=anchor href=#defining-a-flow-1>#</a></h3><pre><code>flow:
  - name: online_indexing_merge
    filter:
      - bulk_reshuffle:
          elasticsearch: prod
          level: shard
      - elasticsearch:
          elasticsearch: prod
          refresh:
            enabled: true
            interval: 30s
</code></pre><p>Set the assembly and disassembly level to the shard type.</p><h3 id=defining-a-pipeline>Defining a Pipeline
<a class=anchor href=#defining-a-pipeline>#</a></h3><pre><code>pipeline:
- name: bulk_request_ingest
  auto_start: true
  processor:
    - bulk_indexing:
        queues:
          type: bulk_reshuffle
          level: shard
</code></pre><p>Compared with the preceding node-level configuration, the <code>level</code> parameter is modified to listen to shard-type disk queues. If there are many indexes, excess local disk queues will cause extra overhead. You are advised to enable this mode only for specific indexes whose throughput needs to be optimized.</p><h2 id=parameter-description>Parameter Description
<a class=anchor href=#parameter-description>#</a></h2><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>elasticsearch</td><td>string</td><td>Name of an Elasticsearch cluster instance.</td></tr><tr><td>level</td><td>string</td><td>Shuffle level of a request, that is, cluster level. The default value is <code>cluster</code>. It can be set to <code>cluster</code>, <code>node</code>, <code>index</code>, or <code>shard</code>.</td></tr><tr><td>queue_name_prefix</td><td>string</td><td>The prefix of default queue，The default value is <code>async_bulk</code></td></tr><tr><td>partition_size</td><td>int</td><td>Maximum partition size. Partitioning is performed by document <code>_id</code> on the basis of <code>level</code>.</td></tr><tr><td>fix_null_id</td><td>bool</td><td>Whether to automatically generate a random UUID if no document ID is specified in the bulk index request document. It is applicable to data of the log type. The default value is <code>true</code>.</td></tr><tr><td>continue_metadata_missing</td><td>bool</td><td>If the node or shard information required by the context does not exist, whether to continue or skip process，default <code>false</code></td></tr><tr><td>continue_after_reshuffle</td><td>bool</td><td>Whether to continue with the process after finished the reshuffle process，default <code>false</code></td></tr><tr><td>index_stats_analysis</td><td>bool</td><td>Whether to record index name statistics to request logs. The default value is <code>true</code>.</td></tr><tr><td>action_stats_analysis</td><td>bool</td><td>Whether to record bulk request statistics to request logs. The default value is <code>true</code>.</td></tr><tr><td>shards</td><td>array</td><td>Index shards that can be processed. The value is a character array, for example, <code>"0"</code>. All shards are processed by default, and you can set specific shards to be processed.</td></tr><tr><td>tag_on_success</td><td>array</td><td>Specified tag to be attached to request context after all bulk requests are processed.</td></tr></tbody></table></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
English</li></ul><ul class=book-languages-list><li class=active><a href=/gateway/main/ class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li><a href=/gateway/main/zh/docs/references/filters/bulk_reshuffle/ class="flex align-center"><img src=/gateway/main/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div><div><a class="flex align-center" href=https://github.com/infinilabs/gateway/edit/main/docs/content.en/docs/references/filters/bulk_reshuffle.md target=_blank rel=noopener><img src=/gateway/main/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div><div class="flex align-center footer">©INFINI.LTD, All Rights Reserved.</div><script>(function(h,o,t,j,a,r){h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};h._hjSettings={hjid:2567416,hjsv:6};a=o.getElementsByTagName('head')[0];r=o.createElement('script');r.async=1;r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;a.appendChild(r);})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RJPTVP614C"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-RJPTVP614C');</script><script type=text/javascript>var _smartsupp=_smartsupp||{};_smartsupp.key='691ff544d18a237005a011a7290b839d8fe811a4';window.smartsupp||(function(d){var s,c,o=smartsupp=function(){o._.push(arguments)};o._=[];s=d.getElementsByTagName('script')[0];c=d.createElement('script');c.type='text/javascript';c.charset='utf-8';c.async=true;c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);})(document);</script></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#bulk_reshuffle>bulk_reshuffle</a><ul><li><a href=#description>Description</a></li><li><a href=#node-level-asynchronous-submission>Node-Level Asynchronous Submission</a><ul><li><a href=#defining-a-flow>Defining a Flow</a></li><li><a href=#configuring-a-consumption-pipeline>Configuring a Consumption Pipeline</a></li></ul></li><li><a href=#shard-level-asynchronous-submission>Shard-Level Asynchronous Submission</a><ul><li><a href=#defining-a-flow-1>Defining a Flow</a></li><li><a href=#defining-a-pipeline>Defining a Pipeline</a></li></ul></li><li><a href=#parameter-description>Parameter Description</a></li></ul></li></ul></nav></aside></main></body></html>