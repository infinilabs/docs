<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>节点配置 on INFINI Easysearch</title><link>/easysearch/main/docs/deployment/config/node-settings/</link><description>Recent content in 节点配置 on INFINI Easysearch</description><generator>Hugo -- gohugo.io</generator><atom:link href="/easysearch/main/docs/deployment/config/node-settings/index.xml" rel="self" type="application/rss+xml"/><item><title>集群与节点</title><link>/easysearch/main/docs/deployment/config/node-settings/cluster-node/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/cluster-node/</guid><description>集群与节点配置 # 本页介绍 easysearch.yml 中与集群身份和节点角色相关的配置项。这些都是静态设置，修改后需要重启节点生效。
集群名称 # cluster.name: easysearch 项目 说明 参数 cluster.name 默认值 easysearch 属性 静态 说明 集群的唯一名称。所有节点必须配置相同的集群名称才能组成一个集群。不同环境（开发、测试、生产）应使用不同的集群名称以防止节点误加入 注意事项：
集群名称不能包含冒号（:），建议仅使用小写字母、数字和连字符。 集群名称一旦投入使用后不建议更改，因为它会影响数据目录结构。 同一网络中如果有多个集群，务必确保集群名称各不相同。 示例：
# 开发环境 cluster.name: dev-cluster # 生产环境 cluster.name: prod-search 节点名称 # node.name: node-1 项目 说明 参数 node.name 默认值 主机名（hostname） 属性 静态 说明 节点在集群中的唯一标识符。如果未显式设置，默认使用机器主机名。用于日志输出、集群状态显示、API 返回信息中。建议使用有意义的名称便于运维定位 命名建议：</description></item><item><title>路径配置</title><link>/easysearch/main/docs/deployment/config/node-settings/path/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/path/</guid><description>路径配置 # 本页介绍 easysearch.yml 中与文件存储路径相关的配置项。这些都是静态设置，修改后需要重启节点生效。
path.data # path.data: /data/easysearch/data 项目 说明 参数 path.data 默认值 $ES_HOME/data 属性 静态 说明 索引数据的存储目录。Easysearch 的所有分片数据（Lucene 段文件、translog）都存储在此目录下。这是磁盘 I/O 最密集的路径 注意事项 # 不要使用默认路径：默认路径在安装目录内（$ES_HOME/data），升级时可能被覆盖。生产环境必须设置独立路径。 目录权限：运行 Easysearch 的用户必须对该目录拥有读写权限。 磁盘选择：建议使用 SSD 存储，可显著提升索引和查询性能。 不要在多个节点之间共享：每个节点的 path.data 必须是独立的目录。 多路径（JBOD） # 支持配置多个数据路径，实现 JBOD（Just a Bunch of Disks）条带化，将分片分散到多块磁盘上：
# YAML 列表形式 path.data: - /data1/easysearch - /data2/easysearch - /data3/easysearch 多路径行为说明：</description></item><item><title>网络配置</title><link>/easysearch/main/docs/deployment/config/node-settings/network/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/network/</guid><description>网络配置 # 本页介绍 easysearch.yml 中与网络绑定、端口和 HTTP 行为相关的配置项。这些都是静态设置，修改后需要重启节点生效。
核心网络参数 # network.host # network.host: 0.0.0.0 项目 说明 参数 network.host 默认值 _local_（仅本机 127.0.0.1） 属性 静态 说明 节点绑定的主机名或 IP 地址。同时设置 network.bind_host 和 network.publish_host。这是最常修改的网络配置 特殊值：
值 含义 _local_ 回环地址（127.0.0.1），仅本机可访问 _site_ 内网地址（如 192.168.x.x / 10.x.x.x） _global_ 公网地址 0.</description></item><item><title>集群发现</title><link>/easysearch/main/docs/deployment/config/node-settings/discovery/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/discovery/</guid><description>集群发现配置 # 本页介绍 easysearch.yml 中与节点发现、主节点选举和故障检测相关的配置项。这些都是静态设置，修改后需要重启节点生效。
discovery.seed_hosts # discovery.seed_hosts: - 192.168.1.10:9300 - 192.168.1.11:9300 - 192.168.1.12:9300 项目 说明 参数 discovery.seed_hosts 默认值 未设置（自动使用 [&amp;quot;127.0.0.1&amp;quot;, &amp;quot;[::1]&amp;quot;]） 属性 静态 说明 提供集群中候选主节点的地址列表，用于新节点加入时的发现。这是组建多节点集群最关键的配置。未配置时默认连接本地 IPv4 和 IPv6 环回地址 格式说明 # 每个地址格式为 host:port 或 host（省略端口时使用 transport.port 的值，默认 9300） 支持 IP 地址、主机名或域名 只需列出具有 master 角色的节点地址 多种写法：
# YAML 列表 discovery.</description></item><item><title>网关与恢复</title><link>/easysearch/main/docs/deployment/config/node-settings/gateway/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/gateway/</guid><description>网关与恢复配置 # 本页介绍 easysearch.yml 中与集群完全重启后分片恢复行为相关的配置项。这些都是静态设置，修改后需要重启节点生效。
分片恢复的限流参数（如 indices.recovery.max_bytes_per_sec）属于动态配置，通过 集群配置 API 修改。
为什么需要网关恢复设置？ # 当整个集群重启时，各节点可能以不同的速度启动。如果集群在只有部分节点加入时就立即开始分片恢复，会导致：
不必要的数据搬运：节点 A 先启动，集群把本该在节点 B 上的分片副本重新分配给 A；等 B 启动后又要搬回去。 大量网络 I/O：分片数据在节点间来回传输。 恢复时间变长：所有数据都要重新复制一遍。 网关设置让集群等到足够数量的节点加入后再开始恢复，避免上述问题。
gateway.recover_after_nodes # gateway.recover_after_nodes: 2 项目 说明 参数 gateway.recover_after_nodes 默认值 -1 (禁用) 属性 静态 说明 集群中至少有多少个节点加入后才开始恢复分片。已弃用：建议改用 recover_after_data_nodes 和 recover_after_master_nodes 以获得更精确的控制 推荐值 # 三节点集群：设为 2 一般规则：设为集群总节点数的大多数（$\lceil N/2 \rceil + 1$ 或更大） gateway.</description></item><item><title>内存与缓存</title><link>/easysearch/main/docs/deployment/config/node-settings/memory/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/memory/</guid><description>内存与缓存配置 # 本页介绍 easysearch.yml 中与内存锁定和缓存相关的配置项。
bootstrap.memory_lock # bootstrap.memory_lock: true 项目 说明 参数 bootstrap.memory_lock 默认值 false 属性 静态 说明 启动时锁定 JVM 堆内存，防止操作系统将堆内存交换（swap）到磁盘。生产环境强烈建议启用 为什么需要锁定内存？ # 当操作系统将 JVM 堆内存换出到磁盘时，会导致：
GC 暂停时间显著增加：GC 需要将被换出的页面重新换入内存。 搜索和索引延迟飙升：毫秒级操作可能变成秒级。 节点被判定为不可用：主节点可能因为超时将该节点踢出集群。 配合设置 # 启用 memory_lock 需要操作系统级的配合：
1. 设置 ulimit（systemd）
# /etc/systemd/system/easysearch.service.d/override.conf [Service] LimitMEMLOCK=infinity 2. 设置 limits.conf
# /etc/security/limits.</description></item><item><title>安全配置</title><link>/easysearch/main/docs/deployment/config/node-settings/security-settings/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/security-settings/</guid><description>安全配置 # 本页介绍 easysearch.yml 中与安全模块相关的配置项，包括 TLS 加密、审计日志、节点证书、REST API 权限等。这些都是静态设置，修改后需要重启节点生效。
用户、角色、权限等安全管理操作请参见 安全 API。 详细的 TLS 证书管理请参见 TLS 安全配置。 国密算法配置请参见 国密配置。
安全模块开关 # security.enabled # security.enabled: true 项目 说明 参数 security.enabled 默认值 true 属性 静态 说明 是否启用安全模块。启用后所有 API 请求需要认证，节点间通信需要 TLS 加密 生产环境必须启用安全模块。关闭安全意味着任何人都可以读写集群数据。
审计日志 # security.audit.type # security.</description></item><item><title>JVM 配置</title><link>/easysearch/main/docs/deployment/config/node-settings/jvm/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/jvm/</guid><description>JVM 配置 # 本页介绍 config/jvm.options 文件中的 JVM 启动参数。这些参数在 Easysearch 启动时由 JVM 读取，修改后需要重启节点生效。
堆内存设置 # 堆内存是 JVM 配置中最重要的参数。
# 堆大小设为物理内存的 50%，但不超过 31 GB # -Xms 和 -Xmx 必须相同，避免运行时堆调整 -Xms16g -Xmx16g 参数 说明 -Xms JVM 初始堆大小 -Xmx JVM 最大堆大小 设置原则 # -Xms 和 -Xmx 设为相同值：避免运行时堆大小调整带来的性能波动。 不超过物理内存的 50%：剩余内存留给操作系统文件缓存（Lucene 严重依赖 OS 页面缓存）。 不超过 31 GB（建议设为 31g 或 30g）：超过约 32 GB 后 JVM 无法使用压缩对象指针（Compressed OOPs），实际可用内存反而减少。 不低于 1 GB：过小的堆会导致频繁 GC。 验证压缩指针 # GET _nodes/stats/jvm?</description></item><item><title>日志配置</title><link>/easysearch/main/docs/deployment/config/node-settings/logging/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/logging/</guid><description>日志配置 # 本页介绍 config/log4j2.properties 日志配置文件以及慢日志设置。
日志文件说明 # Easysearch 使用 Log4j 2 作为日志框架。日志文件默认存储在 ${ES_HOME}/logs/ 目录下（可通过 path.logs 自定义）。
文件 说明 ${cluster.name}.log 主日志文件，记录集群运行的核心事件 ${cluster.name}_server.json JSON 格式日志，便于日志采集工具（如 Filebeat）解析 ${cluster.name}_deprecation.log API 弃用警告日志，记录使用了即将移除的 API ${cluster.name}_slowlog.log 慢查询和慢索引日志 gc.log JVM 垃圾回收日志（由 JVM 参数控制） log4j2.properties # config/log4j2.properties 控制日志行为。Easysearch 的默认配置已经比较完善，通常无需修改。
默认日志级别 # 默认日志级别为 INFO，在 log4j2.properties 中可以修改：</description></item><item><title>Log4j2 日志配置</title><link>/easysearch/main/docs/deployment/config/node-settings/log4j2/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/log4j2/</guid><description>Log4j2 日志配置 # config/log4j2.properties 是 Easysearch 的日志配置文件，控制日志输出格式、级别、文件轮转等。
文件位置与格式 # # 默认位置 $ES_HOME/config/log4j2.properties 该文件使用 Log4j2 的 properties 格式，配置 appenders（日志目标）、loggers（日志器）和日志级别。
修改后无需重启，Easysearch 会自动重新加载配置。
核心概念 # Appenders（日志输出目标） # 定义日志输出到哪里，有以下类型：
Appender 说明 Console 控制台输出（测试环境使用） RollingFile 滚动文件输出（轮转、自动删除旧文件） Loggers（日志器） # 根据组件或模块设置不同的日志级别。根 logger (rootLogger) 作用于全局。
日志级别 # 级别 说明 TRACE 最详细 DEBUG 调试信息 INFO 一般信息（默认） WARN 警告 ERROR 错误 FATAL 致命错误 默认日志文件 # Easysearch 默认配置会生成以下日志文件（存储在 ${ES_HOME}/logs/）：</description></item><item><title>线程池与断路器</title><link>/easysearch/main/docs/deployment/config/node-settings/thread-pool/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/deployment/config/node-settings/thread-pool/</guid><description>线程池与断路器配置 # 本页介绍 easysearch.yml 中与线程池、断路器和 API 兼容相关的配置项。
⚠️ 警告：Easysearch 默认的线程池配置已经过充分调优。除非有明确的性能瓶颈证据，不建议修改线程池参数。盲目增大线程数反而可能导致性能下降。
线程池 # Easysearch 为不同类型的操作使用不同的线程池。
线程池类型 # 线程池 用途 默认大小 默认队列 search 搜索请求 CPU × 3 / 2 + 1（向下取整） 1000 write 索引/删除/更新/bulk 写入 CPU 核数 10000 index 单文档索引 CPU 核数 200 get GET 请求 CPU 核数 1000 analyze 分析请求 1 16 management 集群管理 5 — flush Flush 操作 CPU / 2（向下取整，至少 1） — refresh 刷新操作 CPU / 2（向下取整，至少 1） — snapshot 快照/恢复 CPU / 2（向下取整，至少 1） — warmer 预热操作 CPU / 2（向下取整，至少 1） — force_merge 强制合并 1 — 配置语法 # # 线程池大小 thread_pool.</description></item></channel></rss>