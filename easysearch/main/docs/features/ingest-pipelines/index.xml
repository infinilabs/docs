<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>摄取管道 on INFINI Easysearch (main)</title><link>/easysearch/main/docs/features/ingest-pipelines/</link><description>Recent content in 摄取管道 on INFINI Easysearch (main)</description><generator>Hugo -- gohugo.io</generator><atom:link href="/easysearch/main/docs/features/ingest-pipelines/index.xml" rel="self" type="application/rss+xml"/><item><title>创建管道</title><link>/easysearch/main/docs/features/ingest-pipelines/create-ingest/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/ingest-pipelines/create-ingest/</guid><description>创建管道 # 使用 PUT _ingest/pipeline API 创建或更新摄取管道。如果指定的 pipeline-id 已存在，则覆盖更新。
请求格式 # PUT _ingest/pipeline/&amp;lt;pipeline-id&amp;gt; 示例 # 创建一个包含 set 和 uppercase 处理器的管道：
PUT _ingest/pipeline/my-pipeline { &amp;#34;description&amp;#34;: &amp;#34;处理学生数据：设置毕业年份并转大写&amp;#34;, &amp;#34;processors&amp;#34;: [ { &amp;#34;set&amp;#34;: { &amp;#34;description&amp;#34;: &amp;#34;设置毕业年份&amp;#34;, &amp;#34;field&amp;#34;: &amp;#34;grad_year&amp;#34;, &amp;#34;value&amp;#34;: 2023 } }, { &amp;#34;set&amp;#34;: { &amp;#34;description&amp;#34;: &amp;#34;标记已毕业&amp;#34;, &amp;#34;field&amp;#34;: &amp;#34;graduated&amp;#34;, &amp;#34;value&amp;#34;: true } }, { &amp;#34;uppercase&amp;#34;: { &amp;#34;field&amp;#34;: &amp;#34;name&amp;#34; } } ] } 成功响应：
{ &amp;#34;acknowledged&amp;#34;: true } 请求体参数 # 参数 必需 类型 说明 processors 是 array 有序处理器列表，按定义顺序依次执行 description 否 string 管道描述，出现在 GET _ingest/pipeline 的返回中 路径参数 # 参数 必需 类型 说明 pipeline-id 是 string 管道的唯一标识符 查询参数 # 参数 必需 类型 默认值 说明 cluster_manager_timeout 否 时长 30s 等待集群管理器节点响应的超时时间 timeout 否 时长 30s 等待整体响应的超时时间 Mustache 模板 # 处理器参数中可以使用 Mustache 模板引用文档字段。用三个花括号包裹字段名 {{{field_name}}} 可获取未转义的原始值：</description></item><item><title>模拟管道</title><link>/easysearch/main/docs/features/ingest-pipelines/simulate-ingest/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/ingest-pipelines/simulate-ingest/</guid><description>模拟管道 # 使用 _simulate API 测试管道效果，不会实际索引文档。这是调试管道逻辑的最佳工具。
请求格式 # 模拟已创建的管道：
POST _ingest/pipeline/&amp;lt;pipeline-id&amp;gt;/_simulate 在请求体中内联定义管道进行模拟（无需先创建）：
POST _ingest/pipeline/_simulate 请求内容字段 # 下表列出了用于模拟管道的请求正文字段。
参数名 是否必需 类型 描述 docs 必需的 数组 用于测试管道的文档内容。 pipeline 可选 对象 要模拟的管道。如果未包含管道标识符，则模拟使用的是最新创建的管道。 docs 字段可以包含下表中列出的子字段。
参数名 是否必需 类型 描述 source 必需的 对象 文档的 JSON 正文。 id 可选 字符串 一个独特的文档标识符。该标识符不能在索引的其它地方使用。 index 可选 字符串 文档的转换数据出现的索引。 查询参数 # 下表列出了模拟管道的查询参数。</description></item><item><title>获取管道</title><link>/easysearch/main/docs/features/ingest-pipelines/get-ingest/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/ingest-pipelines/get-ingest/</guid><description>获取管道 # 使用 GET _ingest/pipeline API 检索管道的定义信息。
请求格式 # GET _ingest/pipeline/&amp;lt;pipeline-id&amp;gt; 获取所有管道 # GET _ingest/pipeline 获取指定管道 # GET _ingest/pipeline/my-pipeline 响应示例：
{ &amp;#34;my-pipeline&amp;#34;: { &amp;#34;description&amp;#34;: &amp;#34;处理学生数据：设置毕业年份并转大写&amp;#34;, &amp;#34;processors&amp;#34;: [ { &amp;#34;set&amp;#34;: { &amp;#34;description&amp;#34;: &amp;#34;设置毕业年份&amp;#34;, &amp;#34;field&amp;#34;: &amp;#34;grad_year&amp;#34;, &amp;#34;value&amp;#34;: 2023 } }, { &amp;#34;set&amp;#34;: { &amp;#34;description&amp;#34;: &amp;#34;标记已毕业&amp;#34;, &amp;#34;field&amp;#34;: &amp;#34;graduated&amp;#34;, &amp;#34;value&amp;#34;: true } }, { &amp;#34;uppercase&amp;#34;: { &amp;#34;field&amp;#34;: &amp;#34;name&amp;#34; } } ] } } 通配符匹配 # 支持通配符查询多个管道：
GET _ingest/pipeline/log-* 查询参数 # 参数 必需 类型 默认值 说明 cluster_manager_timeout 否 时长 30s 等待集群管理器节点响应的超时时间</description></item><item><title>删除管道</title><link>/easysearch/main/docs/features/ingest-pipelines/delete-ingest/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/ingest-pipelines/delete-ingest/</guid><description>删除管道 # 使用 DELETE _ingest/pipeline API 删除摄取管道。
请求格式 # 删除指定管道：
DELETE _ingest/pipeline/&amp;lt;pipeline-id&amp;gt; 使用通配符删除匹配的管道：
DELETE _ingest/pipeline/log-* 删除所有管道（慎用）：
DELETE _ingest/pipeline/* 参数 # 参数 必需 类型 默认值 说明 pipeline-id 是 string — 要删除的管道 ID，支持通配符 * cluster_manager_timeout 否 时长 30s 等待集群管理器节点响应的超时时间 timeout 否 时长 30s 等待整体响应的超时时间 响应示例 # { &amp;#34;acknowledged&amp;#34;: true } 注意事项 # 删除一个正在被 index.</description></item><item><title>在管道中访问数据</title><link>/easysearch/main/docs/features/ingest-pipelines/accessing-data/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/ingest-pipelines/accessing-data/</guid><description>在管道中访问数据 # 在摄取管道中，您可以使用 ctx 对象访问文档数据。此对象表示已处理的文档，并允许您读取、修改或丰富文档字段。管道处理器对文档的 _source 字段及其元数据字段都具有读写访问权限。
访问文档字段 # ctx 对象公开了所有文档字段。您可以直接使用点符号访问它们。
示例：访问顶级字段 # 给定以下示例文档：
{ &amp;#34;user&amp;#34;: &amp;#34;alice&amp;#34; } 您可以通过以下方式访问 user ：
&amp;#34;field&amp;#34;: &amp;#34;ctx.user&amp;#34; 示例：访问嵌套字段 # 给定以下示例文档：
{ &amp;#34;user&amp;#34;: { &amp;#34;name&amp;#34;: &amp;#34;alice&amp;#34; } } 您可以通过以下方式访问 user.name ：
&amp;#34;field&amp;#34;: &amp;#34;ctx.user.name&amp;#34; 访问源中的字段 # 要访问文档中的字段 _source ，请通过字段名称进行引用：
{ &amp;#34;set&amp;#34;: { &amp;#34;field&amp;#34;: &amp;#34;environment&amp;#34;, &amp;#34;value&amp;#34;: &amp;#34;production&amp;#34; } } 或者，您可以显式使用 _source ：
{ &amp;#34;set&amp;#34;: { &amp;#34;field&amp;#34;: &amp;#34;_source.environment&amp;#34;, &amp;#34;value&amp;#34;: &amp;#34;production&amp;#34; } } 访问元数据字段 # 您可以读取或写入以下元数据字段：</description></item><item><title>处理管道故障</title><link>/easysearch/main/docs/features/ingest-pipelines/pipeline-failures/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/ingest-pipelines/pipeline-failures/</guid><description>处理管道故障 # 摄取管道由一系列按顺序执行的处理器组成。如果某个处理器失败，默认行为是整条管道中止，文档不会被索引。
你有两种方式应对处理器失败：
中止管道（默认）：处理器失败后整条管道停止，文档不被索引 跳过失败继续执行：通过 ignore_failure 或 on_failure 让管道在失败后继续运行 默认情况下，如果管道中的某个处理器失败，则摄取管道会停止。如果您希望在处理器失败时继续运行管道，您可以在创建管道时将该处理器的 ignore_failure 参数设置为 true ：
PUT _ingest/pipeline/my-pipeline/ { &amp;#34;description&amp;#34;: &amp;#34;Rename &amp;#39;provider&amp;#39; field to &amp;#39;cloud.provider&amp;#39;&amp;#34;, &amp;#34;processors&amp;#34;: [ { &amp;#34;rename&amp;#34;: { &amp;#34;field&amp;#34;: &amp;#34;provider&amp;#34;, &amp;#34;target_field&amp;#34;: &amp;#34;cloud.provider&amp;#34;, &amp;#34;ignore_failure&amp;#34;: true } } ] } 您可以将 on_failure 参数指定为在处理器失败后立即运行。如果您已指定 on_failure ，即使 on_failure 配置为空，Easysearch 也会运行管道中的其他处理器：
PUT _ingest/pipeline/my-pipeline/ { &amp;#34;description&amp;#34;: &amp;#34;Add timestamp to the document&amp;#34;, &amp;#34;processors&amp;#34;: [ { &amp;#34;date&amp;#34;: { &amp;#34;field&amp;#34;: &amp;#34;timestamp_field&amp;#34;, &amp;#34;formats&amp;#34;: [&amp;#34;yyyy-MM-dd HH:mm:ss&amp;#34;], &amp;#34;target_field&amp;#34;: &amp;#34;@timestamp&amp;#34;, &amp;#34;on_failure&amp;#34;: [ { &amp;#34;set&amp;#34;: { &amp;#34;field&amp;#34;: &amp;#34;ingest_error&amp;#34;, &amp;#34;value&amp;#34;: &amp;#34;failed&amp;#34; } } ] } } ] } 如果处理器失败，Easysearch 会记录失败并继续运行搜索管道中剩余的所有处理器。要检查是否有任何失败，您可以使用摄取管道指标。</description></item></channel></rss>