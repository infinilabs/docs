<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>SQL 查询 on INFINI Easysearch</title><link>/easysearch/main/docs/features/sql/</link><description>Recent content in SQL 查询 on INFINI Easysearch</description><generator>Hugo -- gohugo.io</generator><atom:link href="/easysearch/main/docs/features/sql/index.xml" rel="self" type="application/rss+xml"/><item><title>基础查询</title><link>/easysearch/main/docs/features/sql/basics/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/sql/basics/</guid><description>基础查询 # 概述 # SELECT 语句是从 Easysearch 索引中检索数据的核心语法。完整语法如下：
SELECT [ALL | DISTINCT] (* | expression) [[AS] alias] [, ...] FROM index_name [WHERE predicates] [GROUP BY expression [, ...] [HAVING predicates]] [ORDER BY expression [ASC | DESC] [NULLS {FIRST | LAST}] [, ...]] [LIMIT [offset, ] size] 语句末尾允许加分号 ;，这对 BI 工具和 Excel 生成的查询很有用。
执行顺序 # SQL 各子句的实际执行顺序与书写顺序不同：
FROM index -- ① 确定数据源 → WHERE -- ② 行级过滤 → GROUP BY -- ③ 分组 → HAVING -- ④ 组级过滤 → SELECT -- ⑤ 字段投影 → ORDER BY -- ⑥ 排序 → LIMIT -- ⑦ 分页 SELECT # SELECT 子句指定要检索的字段。</description></item><item><title>全文搜索</title><link>/easysearch/main/docs/features/sql/fulltext/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/sql/fulltext/</guid><description>全文搜索 # Easysearch SQL 提供了一组相关性函数，可以在 WHERE 子句中使用，将 SQL 查询与 Easysearch 强大的全文搜索能力相结合。这些函数在底层会翻译为对应的 Easysearch DSL 查询。
函数一览 # 函数 等价函数 底层 DSL 用途 MATCH_QUERY MATCHQUERY match 单字段全文匹配 MULTI_MATCH MULTIMATCH、MULTIMATCHQUERY multi_match 多字段全文匹配 MATCH_PHRASE MATCHPHRASE、MATCHPHRASEQUERY match_phrase 短语匹配 QUERY — query_string Lucene 查询字符串 SCORE SCOREQUERY、SCORE_QUERY constant_score 相关性评分包装 MATCH_QUERY # 在单个文本字段上执行全文匹配查询。
语法 # MATCH_QUERY(field, text) -- 或 field = MATCH_QUERY(text) 参数 说明 field 要搜索的字段名（必须是 text 类型） text 搜索文本 示例 # POST /_sql { &amp;#34;query&amp;#34;: &amp;#34;SELECT account_number, address FROM accounts WHERE MATCH_QUERY(address, &amp;#39;Holmes&amp;#39;)&amp;#34; } 等价 DSL：</description></item><item><title>复杂查询</title><link>/easysearch/main/docs/features/sql/complex/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/sql/complex/</guid><description>复杂查询 # 本章介绍子查询、JOIN 连接和条件表达式等进阶 SQL 功能。
子查询（Subquery） # 子查询是嵌套在另一个 SQL 语句中的完整 SELECT 语句，用括号括起来。Easysearch SQL 支持两种形式的子查询。
WHERE IN 子查询 # 在 WHERE 子句中使用 IN 加子查询来过滤符合条件的文档。底层会被转换为等效的 JOIN 查询执行。
POST /_sql { &amp;#34;query&amp;#34;: &amp;#34;&amp;#34;&amp;#34; SELECT a1.firstname, a1.lastname, a1.balance FROM accounts a1 WHERE a1.account_number IN ( SELECT a2.account_number FROM accounts a2 WHERE a2.balance &amp;gt; 10000 ) &amp;#34;&amp;#34;&amp;#34; } 结果：
a1.firstname a1.lastname a1.balance Amber Duke 39225 Nanette Bates 32838 FROM 子查询 # 在 FROM 子句中使用子查询作为派生表，子查询必须指定别名。</description></item><item><title>聚合查询</title><link>/easysearch/main/docs/features/sql/aggregations/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/sql/aggregations/</guid><description>聚合查询 # 聚合函数对一组文档进行计算并返回单个值。通常与 GROUP BY 子句组合使用，对数据进行分组后计算汇总统计量。
聚合函数 # 基本聚合函数 # 函数 说明 示例 COUNT(*) 计算所有行数 SELECT COUNT(*) FROM accounts COUNT(field) 计算非 NULL 值行数 SELECT COUNT(age) FROM accounts COUNT(DISTINCT field) 计算字段不同值数量 SELECT COUNT(DISTINCT gender) FROM accounts SUM(expr) 求和 SELECT SUM(balance) FROM accounts AVG(expr) 算术平均值 SELECT AVG(age) FROM accounts MAX(expr) 最大值 SELECT MAX(balance) FROM accounts MIN(expr) 最小值 SELECT MIN(balance) FROM accounts 统计聚合函数 # 函数 同义函数 说明 VAR_POP(expr) VARIANCE(expr) 总体方差 VAR_SAMP(expr) — 样本方差 STDDEV_POP(expr) STD(expr)、STDDEV(expr) 总体标准差 STDDEV_SAMP(expr) — 样本标准差 使用示例 # -- 基本聚合 SELECT COUNT(*), SUM(balance), AVG(age), MAX(balance), MIN(balance) FROM accounts -- 分组聚合 SELECT gender, COUNT(*) AS cnt, AVG(age) AS avg_age FROM accounts GROUP BY gender -- 聚合表达式 SELECT gender, SUM(age) * 2 AS double_sum FROM accounts GROUP BY gender -- 表达式作为聚合参数 SELECT gender, SUM(age * 2) AS sum_double FROM accounts GROUP BY gender COUNT 的特殊形式 # 形式 行为 COUNT(field) 仅计数字段值非 NULL 的行 COUNT(*) 计数所有输入行（包含 NULL） COUNT(1) 等同于 COUNT(*)，任何非 NULL 字面量均可 COUNT(DISTINCT field) 计数字段的不重复值 SELECT COUNT(DISTINCT gender), COUNT(gender) FROM accounts COUNT(DISTINCT gender) COUNT(gender) 2 4 GROUP BY # GROUP BY 按表达式对结果分组。支持三种写法：</description></item><item><title>内置函数</title><link>/easysearch/main/docs/features/sql/functions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/sql/functions/</guid><description>内置函数 # Easysearch SQL 提供 80 多个内置函数，涵盖数学运算、字符串处理、日期时间、条件判断和类型转换等类别。
数学函数 # 函数 说明 示例 ABS(expr) 绝对值 ABS(-5) → 5 CEIL(expr) / CEILING(expr) 向上取整 CEIL(2.3) → 3 FLOOR(expr) 向下取整 FLOOR(2.7) → 2 ROUND(expr [, d]) 四舍五入到 d 位小数 ROUND(3.1415, 2) → 3.14 TRUNCATE(expr, d) 截断到 d 位小数 TRUNCATE(3.1415, 2) → 3.14 SQRT(expr) 平方根 SQRT(16) → 4.</description></item><item><title>SQL-JDBC</title><link>/easysearch/main/docs/features/sql/sql-jdbc/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/features/sql/sql-jdbc/</guid><description>SQL-JDBC 驱动 # Easysearch SQL JDBC 驱动程序是一个独立的纯 Java 驱动，可将 JDBC 调用转换为 Easysearch SQL REST API 请求，适用于 BI 工具集成、报表生成和应用程序数据访问等场景。
驱动信息 # 属性 值 Driver 类名 com.easysearch.jdbc.EasysearchDriver JDBC URL 前缀 jdbc:easysearch:// JAR 包 sql-jdbc-1.7.1.jar 最低 Java 版本 Java 8 安装 # 下载 # 从官网下载 JDBC 驱动 JAR：
https://release.infinilabs.com/easysearch/archive/plugins/sql-jdbc-1.7.1.jar Maven 项目 # 将 JAR 安装到本地仓库后引用：</description></item></channel></rss>