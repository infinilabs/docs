<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>运维手册 on INFINI Easysearch</title><link>/easysearch/main/docs/operations/</link><description>Recent content in 运维手册 on INFINI Easysearch</description><generator>Hugo -- gohugo.io</generator><atom:link href="/easysearch/main/docs/operations/index.xml" rel="self" type="application/rss+xml"/><item><title>集群配置</title><link>/easysearch/main/docs/operations/configuration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/operations/configuration/</guid><description>配置 # Easysearch 默认配置已针对多数场景优化。本文聚焦生产环境必须关注的配置项。
原则：如果不确定是否需要改，就不要改。过度调优往往适得其反。
配置速查表 # 类别 关键配置 修改方式 风险等级 标识 cluster.name、node.name 静态（重启生效） 低 路径 path.data、path.logs 静态（重启生效） 高 网络 network.host、http.port、transport.port 静态（重启生效） 中 发现 discovery.seed_hosts、cluster.initial_master_nodes 静态（重启生效） 高 内存 ES_HEAP_SIZE、jvm.options 静态（重启生效） 高 恢复 gateway.recover_after_* 静态（重启生效） 中 集群级 大部分 cluster.*、indices.* 动态 API 视具体配置 必须配置 # 集群和节点名称 # # easysearch.</description></item><item><title>集群监控</title><link>/easysearch/main/docs/operations/monitoring/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/operations/monitoring/</guid><description>监控 # 本文从&amp;quot;如何判断集群是否健康&amp;quot;出发，给出最小可行的监控指标与告警建议，并提供具体的 API 示例。
监控三层模型 # Easysearch 集群的监控可以分为三个层次：
┌─────────────────────────────────────────────────────────────┐ │ Layer 1: 服务可用性 │ │ • 集群是否整体可用？节点是否存活？ │ ├─────────────────────────────────────────────────────────────┤ │ Layer 2: 资源与性能 │ │ • CPU/内存/磁盘/网络是否有瓶颈？延迟是否异常？ │ ├─────────────────────────────────────────────────────────────┤ │ Layer 3: 业务行为 │ │ • 慢查询、错误率、索引状态是否正常？ │ └─────────────────────────────────────────────────────────────┘ 监控目标：
出问题前能看到&amp;quot;趋势变坏&amp;quot;（而不是只在宕机后才收到告警） 告警有明确的处理指引，而不是一堆噪音 集群健康检查 # 快速健康检查 # GET _cluster/health 响应示例：
{ &amp;#34;cluster_name&amp;#34;: &amp;#34;production&amp;#34;, &amp;#34;status&amp;#34;: &amp;#34;green&amp;#34;, &amp;#34;timed_out&amp;#34;: false, &amp;#34;number_of_nodes&amp;#34;: 5, &amp;#34;number_of_data_nodes&amp;#34;: 3, &amp;#34;active_primary_shards&amp;#34;: 50, &amp;#34;active_shards&amp;#34;: 100, &amp;#34;relocating_shards&amp;#34;: 0, &amp;#34;initializing_shards&amp;#34;: 0, &amp;#34;unassigned_shards&amp;#34;: 0, &amp;#34;delayed_unassigned_shards&amp;#34;: 0, &amp;#34;number_of_pending_tasks&amp;#34;: 0, &amp;#34;number_of_in_flight_fetch&amp;#34;: 0, &amp;#34;task_max_waiting_in_queue_millis&amp;#34;: 0, &amp;#34;active_shards_percent_as_number&amp;#34;: 100.</description></item><item><title>告警配置</title><link>/easysearch/main/docs/operations/alerting/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/operations/alerting/</guid><description>监控告警 # 为 Easysearch 集群构建完整的告警体系，及时发现和处理问题，确保集群的稳定运行。
告警体系概览 # Easysearch 的告警体系由以下核心组件组成：
┌──────────────────────────────────────────────────────────────┐ │ 告警生命周期 │ ├──────────────────────────────────────────────────────────────┤ │ │ │ 数据采集 → 指标评估 → 告警触发 → 告警发送 → 告警处理 │ │ │ │ │ │ │ │ │ └───┬───────┴───────────┴─────────┴────────┘ │ │ │ │ │ └─→ INFINI Console 告警管理平台 │ │ │ └──────────────────────────────────────────────────────────────┘ 告警规则体系 # 1. 可用性告警 # 集群的基础可用性监控。
告警规则 触发条件 建议阈值 处理建议 集群不健康 _cluster/health 返回 yellow 或 red 立即告警 检查节点是否掉线，运行 GET _cluster/allocation/explain 诊断未分配分片 节点离线 节点掉线或无响应 立即告警（超 1 分钟） 检查节点进程、网络连通性、磁盘空间 分片未分配 存在未分配的主分片或副本分片 立即告警 检查集群容量、节点约束、路由配置 集群脑裂 多个 master 节点并存 立即告警 紧急处理，可能需要恢复集群 2.</description></item><item><title>故障排查</title><link>/easysearch/main/docs/operations/troubleshooting/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/operations/troubleshooting/</guid><description>故障排查 # 本文提供一条&amp;quot;遇到问题时可以照着走&amp;quot;的诊断路线，包含具体的诊断命令和解决方案。
排查总体思路 # 遇到问题时，先快速判断三个问题：
┌─────────────────────────────────────────────────────────────────────────┐ │ 1. 影响范围：单个索引/租户？还是整个集群？ │ ├─────────────────────────────────────────────────────────────────────────┤ │ 2. 症状类型：性能下降？错误增多？节点异常？数据不符合预期？ │ ├─────────────────────────────────────────────────────────────────────────┤ │ 3. 时间维度：长期慢性问题？还是某个时间点突然恶化？ │ └─────────────────────────────────────────────────────────────────────────┘ 问题 1：集群状态变红/黄 # 快速诊断 # # 1. 检查集群状态 GET _cluster/health # 2. 查看未分配分片 GET _cat/shards?v&amp;amp;h=index,shard,prirep,state,unassigned.reason&amp;amp;s=state # 3. 分析未分配原因 GET _cluster/allocation/explain 常见原因与解决方案 # 原因 1：节点离线 # 诊断：
GET _cat/nodes?v 检查节点数是否符合预期，缺失的节点需要检查：
进程是否存活：ps aux | grep easysearch 系统日志：journalctl -u easysearch Easysearch 日志：logs/{cluster_name}.log 解决方案：</description></item><item><title>日志管理</title><link>/easysearch/main/docs/operations/logs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/easysearch/main/docs/operations/logs/</guid><description>系统日志 # Easysearch 日志包含监控群集操作和故障排除问题的重要信息。日志的位置因安装类型而异：
在 Docker 上，Easysearch 将大多数日志写入控制台，并将其余日志存储在 easysearch/logs/ 中。tarball 安装也使用 easysearch/logs/。 在 RPM 和 Debian 安装上，Easysearch 将日志写入 /var/log/easysearch/。 日志可作为 .log （纯文本）和 .json 文件使用。
应用程序日志 # 对于其应用程序日志，Easysearch 使用 Apache Log4j 2 其内置日志级别（从最低到最高）为 TRACE 、 DEBUG 、 INFO 、 WARN 、 ERROR 和 FATAL 。默认 Easysearch 日志级别为 INFO 。
您可以更改各个 Easysearch 模块的日志级别，而不是更改默认日志级别（ logger.level ）：
PUT /_cluster/settings { &amp;#34;persistent&amp;#34; : { &amp;#34;logger.org.easysearch.index.reindex&amp;#34; : &amp;#34;DEBUG&amp;#34; } } 此示例更改后，Easysearch 在重新索引操作期间会发出更详细的日志：</description></item></channel></rss>